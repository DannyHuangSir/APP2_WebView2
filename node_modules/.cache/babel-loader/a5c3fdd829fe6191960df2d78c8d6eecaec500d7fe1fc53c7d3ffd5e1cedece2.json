{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useHistory,useLocation}from'react-router';import parse from'html-react-parser';import Main from'components/Layout';import Loading from'components/Loading';import Accordion from'components/Accordion';import Layout from'components/Layout/Layout';import{FEIBSwitch}from'components/elements';import BottomAction from'components/BottomAction';import{PhoneIcon,TransactionIcon}from'assets/images/icons';import SuccessFailureAnimations from'components/SuccessFailureAnimations';import{FuncID}from'utilities/FuncID';import{closeFunc,startFunc}from'utilities/AppScriptProxy';import{getAutoDebits,getCreditCardTerms}from'./api';import PageWrapper from'./TransferResult.style';/**\r\n * R00400 信用卡 付款結果頁\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Page=function Page(){var history=useHistory();var location=useLocation();var _useState=useState(),_useState2=_slicedToArray(_useState,2),autoDebitInfo=_useState2[0],setAutoDebitInfo=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),terms=_useState4[0],setTerms=_useState4[1];var renderBottomAction=function renderBottomAction(isSuccess){return/*#__PURE__*/_jsx(BottomAction,{position:0,children:isSuccess?/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return startFunc(FuncID.C00700);},children:\"\\u56DE\\u4FE1\\u7528\\u5361\\u9996\\u9801\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:function onClick(){return window.open('tel:+886280731166');},children:[/*#__PURE__*/_jsx(PhoneIcon,{}),\"\\u806F\\u7D61\\u5BA2\\u670D\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"divider\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:function onClick(){return history.goBack();},children:[/*#__PURE__*/_jsx(TransactionIcon,{}),\"\\u91CD\\u65B0\\u8F49\\u5E33\"]})]})});};var renderAutoDebitInfo=function renderAutoDebitInfo(isSuccess){if(!isSuccess)return null;// TODO 改成 switch模式\nif(!autoDebitInfo||autoDebitInfo.status!=='2'){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-2 text-gray\",children:\"\\u60A8\\u5C1A\\u672A\\u7533\\u8ACB\\u81EA\\u52D5\\u6263\\u7E73\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"deduct\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u81EA\\u52D5\\u6263\\u7E73\"}),/*#__PURE__*/_jsx(FEIBSwitch,{onChange:function onChange(){return history.push('/R00500');}})]})]}),/*#__PURE__*/_jsx(Accordion,{title:\"\\u6CE8\\u610F\\u4E8B\\u9805\",children:terms?parse(terms):/*#__PURE__*/_jsx(Loading,{space:\"both\",isCentered:true})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"auto text-gray\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u60A8\\u5DF2\\u7533\\u8ACB\\u81EA\\u52D5\\u6263\\u7E73\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:function onClick(){return history.push('/R00500');},children:[/*#__PURE__*/_jsx(\"i\",{className:\"circle\"}),\"\\u8A2D\\u5B9A\\u81EA\\u52D5\\u6263\\u7E73\"]})]});};// 拿取「信用卡自動扣繳資訊」 以及 「信用卡注意事項」\nuseEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var autoDebitsRes,foundAutoDebit,cardTermsRes;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getAutoDebits();case 2:autoDebitsRes=_context.sent;if(autoDebitsRes&&autoDebitsRes.length){foundAutoDebit=autoDebitsRes.find(function(debit){return debit.account===location.state.account;});setAutoDebitInfo(foundAutoDebit);}_context.next=6;return getCreditCardTerms();case 6:cardTermsRes=_context.sent;setTerms(cardTermsRes);case 8:case\"end\":return _context.stop();}}},_callee);})),[]);// ===== Guard，若沒有 location.state 屬於不正常操作，直接結束本服務 =====\nif(!location.state||!('payResult'in location.state))return closeFunc();var _location$state$payRe=location.state.payResult,code=_location$state$payRe.code,message=_location$state$payRe.message;var isSuccess=code==='0000';return/*#__PURE__*/_jsx(Layout,{title:\"\\u8F49\\u5E33\\u7D50\\u679C\",goBackFunc:function goBackFunc(){return history.goBack();},children:/*#__PURE__*/_jsx(Main,{children:/*#__PURE__*/_jsxs(PageWrapper,{children:[/*#__PURE__*/_jsx(SuccessFailureAnimations,{isSuccess:isSuccess,successTitle:\"\\u7E73\\u6B3E\\u6210\\u529F\",errorTitle:\"\\u7E73\\u6B3E\\u5931\\u6557\",errorCode:code,errorDesc:message,errorSpace:true}),renderAutoDebitInfo(isSuccess),renderBottomAction(isSuccess)]})})});};export default Page;","map":{"version":3,"names":["useState","useEffect","useHistory","useLocation","parse","Main","Loading","Accordion","Layout","FEIBSwitch","BottomAction","PhoneIcon","TransactionIcon","SuccessFailureAnimations","FuncID","closeFunc","startFunc","getAutoDebits","getCreditCardTerms","PageWrapper","Page","history","location","autoDebitInfo","setAutoDebitInfo","terms","setTerms","renderBottomAction","isSuccess","C00700","window","open","goBack","renderAutoDebitInfo","status","push","autoDebitsRes","length","foundAutoDebit","find","debit","account","state","cardTermsRes","payResult","code","message"],"sources":["C:/Users/allen/git/app2-webview/src/pages/R00400_CCPayment/R00400_1.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useHistory, useLocation } from 'react-router';\r\nimport parse from 'html-react-parser';\r\n\r\nimport Main from 'components/Layout';\r\nimport Loading from 'components/Loading';\r\nimport Accordion from 'components/Accordion';\r\nimport Layout from 'components/Layout/Layout';\r\nimport { FEIBSwitch } from 'components/elements';\r\nimport BottomAction from 'components/BottomAction';\r\nimport { PhoneIcon, TransactionIcon } from 'assets/images/icons';\r\nimport SuccessFailureAnimations from 'components/SuccessFailureAnimations';\r\nimport { FuncID } from 'utilities/FuncID';\r\nimport { closeFunc, startFunc } from 'utilities/AppScriptProxy';\r\n\r\nimport { getAutoDebits, getCreditCardTerms } from './api';\r\nimport PageWrapper from './TransferResult.style';\r\n\r\n/**\r\n * R00400 信用卡 付款結果頁\r\n */\r\nconst Page = () => {\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  const [autoDebitInfo, setAutoDebitInfo] = useState();\r\n  const [terms, setTerms] = useState();\r\n\r\n  const renderBottomAction = (isSuccess) => (\r\n    <BottomAction position={0}>\r\n      { isSuccess ? (\r\n        <button type=\"button\" onClick={() => startFunc(FuncID.C00700)}>\r\n          回信用卡首頁\r\n        </button>\r\n      ) : (\r\n        <>\r\n          <button type=\"button\" onClick={() => window.open('tel:+886280731166')}>\r\n            <PhoneIcon />\r\n            聯絡客服\r\n          </button>\r\n          <div className=\"divider\" />\r\n          <button type=\"button\" onClick={() => history.goBack()}>\r\n            <TransactionIcon />\r\n            重新轉帳\r\n          </button>\r\n        </>\r\n      ) }\r\n    </BottomAction>\r\n  );\r\n\r\n  const renderAutoDebitInfo = (isSuccess) => {\r\n    if (!isSuccess) return null;\r\n\r\n    // TODO 改成 switch模式\r\n    if (!autoDebitInfo || autoDebitInfo.status !== '2') {\r\n      return (\r\n        <>\r\n          <div>\r\n            <div className=\"mb-2 text-gray\">您尚未申請自動扣繳</div>\r\n            <div className=\"deduct\">\r\n              <div>自動扣繳</div>\r\n              <FEIBSwitch onChange={() => history.push('/R00500')} />\r\n            </div>\r\n          </div>\r\n          <Accordion title=\"注意事項\">\r\n            { terms ? parse(terms) : <Loading space=\"both\" isCentered /> }\r\n          </Accordion>\r\n        </>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"auto text-gray\">\r\n        <div>您已申請自動扣繳</div>\r\n        <button type=\"button\" onClick={() => history.push('/R00500')}>\r\n          <i className=\"circle\" />\r\n          設定自動扣繳\r\n        </button>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // 拿取「信用卡自動扣繳資訊」 以及 「信用卡注意事項」\r\n  useEffect(async () => {\r\n    const autoDebitsRes = await getAutoDebits();\r\n    if (autoDebitsRes && autoDebitsRes.length) {\r\n      const foundAutoDebit = autoDebitsRes.find((debit) => debit.account === location.state.account);\r\n      setAutoDebitInfo(foundAutoDebit);\r\n    }\r\n\r\n    const cardTermsRes = await getCreditCardTerms();\r\n    setTerms(cardTermsRes);\r\n  }, []);\r\n\r\n  // ===== Guard，若沒有 location.state 屬於不正常操作，直接結束本服務 =====\r\n  if (!location.state || !('payResult' in location.state)) return closeFunc();\r\n  const { payResult: {code, message} } = location.state;\r\n  const isSuccess = code === '0000';\r\n  return (\r\n    <Layout title=\"轉帳結果\" goBackFunc={() => history.goBack()}>\r\n      <Main>\r\n        <PageWrapper>\r\n          <SuccessFailureAnimations\r\n            isSuccess={isSuccess}\r\n            successTitle=\"繳款成功\"\r\n            errorTitle=\"繳款失敗\"\r\n            errorCode={code}\r\n            errorDesc={message}\r\n            errorSpace\r\n          />\r\n          {renderAutoDebitInfo(isSuccess)}\r\n          { renderBottomAction(isSuccess) }\r\n        </PageWrapper>\r\n      </Main>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Page;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}