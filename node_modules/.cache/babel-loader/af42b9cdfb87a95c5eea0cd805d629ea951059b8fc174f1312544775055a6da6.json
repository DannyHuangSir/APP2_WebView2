{"ast":null,"code":"import{ArrowBack,ArrowForward}from'@material-ui/icons';import InformationList from'components/InformationList';import{customPopup}from'utilities/MessageModal';import{currencySymbolGenerator,dateToString,toHalfWidth,timeToString}from'utilities/Generator';import{DetailsDefaultAvatarIcon}from'assets/images/icons';import DetailCardWrapper,{DetailDialogContentWrapper}from'./detailCard.style';/*\r\n* ==================== DetailCard 組件說明 ====================\r\n* 交易明細卡片組件\r\n* ==================== DetailCard 可傳參數 ====================\r\n* 1. id -> Html DOM 元素 id\r\n* 2. index -> HTML data-index 參數，放置後端撈回的卡片索引值\r\n* 3. inView -> HTML data-inview 參數，顯示卡片是否在畫面可視範圍\r\n* 5. cdType -> 交易類型，後端會傳回 \"c\" 或 \"d\" 兩種字串值，\"c\" 表轉出，\"d\" 表轉入\r\n* 6. description -> 明細標題\r\n* 7. txnDate -> 交易日期, 格式：yyyyMMdd\r\n* 8. txnTime -> 交易時間, 格式：HHmmss\r\n* 9. bizDate -> 帳務日期\r\n* 10. currency -> 貨幣單位\r\n* 11. targetBank -> 目標帳號銀行代碼\r\n* 12. targetAcct -> 目標帳號\r\n* 13. targetMbrId -> 目標帳號的會員 ID; 用來顯示頭像圖片，沒傳值會有預設樣式\r\n*     targetNickName -> 目標帳號的䁥稱\r\n* 14. amount -> 交易金額\r\n* 15. balance -> 交易後所剩餘額\r\n* 16. noShadow -> 卡片不帶陰影樣式\r\n* */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var DetailCard=function DetailCard(_ref){var id=_ref.id,index=_ref.index,inView=_ref.inView,noShadow=_ref.noShadow,cdType=_ref.cdType,description=_ref.description,memo=_ref.memo,txnDate=_ref.txnDate,txnTime=_ref.txnTime,bizDate=_ref.bizDate,currency=_ref.currency,targetBank=_ref.targetBank,targetAcct=_ref.targetAcct,targetMbrId=_ref.targetMbrId,targetNickName=_ref.targetNickName,amount=_ref.amount,balance=_ref.balance,invert=_ref.invert;/**\r\n   * 取得大頭貼。\r\n   * @returns 會員大頭貼；非會員則傳回 null。\r\n   */var getAvator=function getAvator(){if(!targetMbrId)return null;// 先從 sessionStorage 取出第一次下載的影像。\nvar cacheId=\"s\".concat(targetMbrId);var cacheImg=sessionStorage.getItem(cacheId);if(cacheImg===null){// 第一次下載影像，會存入 sessionStorage 以減少 Server端的傳輸流量。\nvar url=\"\".concat(process.env.REACT_APP_AVATAR_URL,\"/\").concat(targetMbrId,\"_s.jpg\");cacheImg=url;// DEBUG\n// TODO 從 url 取得影像內容(應為 Base64 格式字串)。\nsessionStorage.setItem(cacheId,cacheImg);}return cacheImg;};var renderAvatar=function renderAvatar(){return targetMbrId?/*#__PURE__*/_jsx(\"img\",{src:getAvator(),alt:\"avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"defaultAvatar\",children:/*#__PURE__*/_jsx(DetailsDefaultAvatarIcon,{})});};var renderTypeIcon=function renderTypeIcon(){return/*#__PURE__*/_jsx(\"div\",{className:\"type \".concat(cdType==='c'?'spend':'income'),children:cdType==='c'?/*#__PURE__*/_jsx(ArrowBack,{}):/*#__PURE__*/_jsx(ArrowForward,{})});};/**\r\n   * 交易明細說明。\r\n   * @returns 包含交易日期、交易對象䁥稱或帳號的字串。\r\n   */var txnDescription=function txnDescription(){var date=dateToString(txnDate,'/',true);if(targetNickName)return\"\".concat(date,\" | \").concat(targetNickName);if(targetAcct)return\"\".concat(date,\" - \").concat(targetAcct);// NOTE 交易對象帳號很難格式化！\nreturn date;};var renderDetailDialog=function renderDetailDialog(){var title=cdType==='c'?'轉出':'轉入';// TODO 不是只有轉入、轉出\nvar body=/*#__PURE__*/_jsxs(DetailDialogContentWrapper,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mainBlock\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mainBlockTitle\",children:\"\".concat(toHalfWidth(description),\" \").concat(memo!==null&&memo!==void 0?memo:'')}),/*#__PURE__*/_jsx(\"p\",{className:\"mainBlockAmount\",children:\"\".concat(cdType==='c'?'- ':'').concat(currencySymbolGenerator(currency,amount))}),invert&&/*#__PURE__*/_jsx(\"p\",{className:\"mainBlockTitle\",children:\"[\\u66F4\\u6B63\\u4EA4\\u6613]\"})]}),/*#__PURE__*/_jsx(InformationList,{title:\"\\u4EA4\\u6613\\u6642\\u9593\",content:\"\".concat(dateToString(txnDate,'/'),\" \").concat(timeToString(txnTime))}),/*#__PURE__*/_jsx(InformationList,{title:\"\\u5E33\\u52D9\\u65E5\\u671F\",content:dateToString(bizDate,'/')}),targetAcct&&/*#__PURE__*/_jsx(InformationList,{title:\"\\u5E33\\u865F\",content:(targetBank?\"(\".concat(targetBank,\") \"):'')+targetAcct})]});// TODO 若有轉入帳號，就可以立即加入常用帳號。\ncustomPopup(title,body);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(DetailCardWrapper,{\"data-index\":index,\"data-inview\":inView,$noShadow:noShadow,id:id,onClick:renderDetailDialog,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"avatar\",children:[renderAvatar(),renderTypeIcon()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"description\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\".concat(toHalfWidth(description),\" \").concat(memo!==null&&memo!==void 0?memo:'')}),/*#__PURE__*/_jsx(\"p\",{children:txnDescription()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"amount\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[invert&&'[更正交易] ',cdType==='c'&&'- ',currencySymbolGenerator(currency,amount)]}),/*#__PURE__*/_jsx(\"p\",{children:currencySymbolGenerator(currency,balance)})]})]})});};export default DetailCard;","map":{"version":3,"names":["ArrowBack","ArrowForward","InformationList","customPopup","currencySymbolGenerator","dateToString","toHalfWidth","timeToString","DetailsDefaultAvatarIcon","DetailCardWrapper","DetailDialogContentWrapper","DetailCard","id","index","inView","noShadow","cdType","description","memo","txnDate","txnTime","bizDate","currency","targetBank","targetAcct","targetMbrId","targetNickName","amount","balance","invert","getAvator","cacheId","cacheImg","sessionStorage","getItem","url","process","env","REACT_APP_AVATAR_URL","setItem","renderAvatar","renderTypeIcon","txnDescription","date","renderDetailDialog","title","body"],"sources":["C:/Users/allen/git/app2-webview/src/components/DetailCard/index.js"],"sourcesContent":["import { ArrowBack, ArrowForward } from '@material-ui/icons';\r\nimport InformationList from 'components/InformationList';\r\nimport { customPopup } from 'utilities/MessageModal';\r\nimport {\r\n  currencySymbolGenerator, dateToString, toHalfWidth, timeToString,\r\n} from 'utilities/Generator';\r\nimport { DetailsDefaultAvatarIcon } from 'assets/images/icons';\r\nimport DetailCardWrapper, { DetailDialogContentWrapper } from './detailCard.style';\r\n\r\n/*\r\n* ==================== DetailCard 組件說明 ====================\r\n* 交易明細卡片組件\r\n* ==================== DetailCard 可傳參數 ====================\r\n* 1. id -> Html DOM 元素 id\r\n* 2. index -> HTML data-index 參數，放置後端撈回的卡片索引值\r\n* 3. inView -> HTML data-inview 參數，顯示卡片是否在畫面可視範圍\r\n* 5. cdType -> 交易類型，後端會傳回 \"c\" 或 \"d\" 兩種字串值，\"c\" 表轉出，\"d\" 表轉入\r\n* 6. description -> 明細標題\r\n* 7. txnDate -> 交易日期, 格式：yyyyMMdd\r\n* 8. txnTime -> 交易時間, 格式：HHmmss\r\n* 9. bizDate -> 帳務日期\r\n* 10. currency -> 貨幣單位\r\n* 11. targetBank -> 目標帳號銀行代碼\r\n* 12. targetAcct -> 目標帳號\r\n* 13. targetMbrId -> 目標帳號的會員 ID; 用來顯示頭像圖片，沒傳值會有預設樣式\r\n*     targetNickName -> 目標帳號的䁥稱\r\n* 14. amount -> 交易金額\r\n* 15. balance -> 交易後所剩餘額\r\n* 16. noShadow -> 卡片不帶陰影樣式\r\n* */\r\n\r\nconst DetailCard = ({\r\n  id,\r\n  index,\r\n  inView,\r\n  noShadow,\r\n\r\n  cdType,\r\n  description,\r\n  memo,\r\n  txnDate,\r\n  txnTime,\r\n  bizDate,\r\n  currency,\r\n  targetBank,\r\n  targetAcct,\r\n  targetMbrId,\r\n  targetNickName,\r\n  amount,\r\n  balance,\r\n  invert,\r\n}) => {\r\n  /**\r\n   * 取得大頭貼。\r\n   * @returns 會員大頭貼；非會員則傳回 null。\r\n   */\r\n  const getAvator = () => {\r\n    if (!targetMbrId) return null;\r\n\r\n    // 先從 sessionStorage 取出第一次下載的影像。\r\n    const cacheId = `s${targetMbrId}`;\r\n    let cacheImg = sessionStorage.getItem(cacheId);\r\n    if (cacheImg === null) {\r\n      // 第一次下載影像，會存入 sessionStorage 以減少 Server端的傳輸流量。\r\n      const url = `${process.env.REACT_APP_AVATAR_URL}/${targetMbrId}_s.jpg`;\r\n      cacheImg = url; // DEBUG\r\n\r\n      // TODO 從 url 取得影像內容(應為 Base64 格式字串)。\r\n\r\n      sessionStorage.setItem(cacheId, cacheImg);\r\n    }\r\n    return cacheImg;\r\n  };\r\n\r\n  const renderAvatar = () => (\r\n    targetMbrId\r\n      ? <img src={getAvator()} alt=\"avatar\" />\r\n      : (\r\n        <div className=\"defaultAvatar\">\r\n          <DetailsDefaultAvatarIcon />\r\n        </div>\r\n      )\r\n  );\r\n\r\n  const renderTypeIcon = () => (\r\n    <div className={`type ${cdType === 'c' ? 'spend' : 'income'}`}>\r\n      { cdType === 'c' ? <ArrowBack /> : <ArrowForward /> }\r\n    </div>\r\n  );\r\n\r\n  /**\r\n   * 交易明細說明。\r\n   * @returns 包含交易日期、交易對象䁥稱或帳號的字串。\r\n   */\r\n  const txnDescription = () => {\r\n    const date = dateToString(txnDate, '/', true);\r\n    if (targetNickName) return `${date} | ${targetNickName}`;\r\n    if (targetAcct) return `${date} - ${targetAcct}`; // NOTE 交易對象帳號很難格式化！\r\n    return date;\r\n  };\r\n\r\n  const renderDetailDialog = () => {\r\n    const title = (cdType === 'c' ? '轉出' : '轉入'); // TODO 不是只有轉入、轉出\r\n    const body = (\r\n      <DetailDialogContentWrapper>\r\n        <div className=\"mainBlock\">\r\n          <p className=\"mainBlockTitle\">{`${toHalfWidth(description)} ${memo ?? ''}`}</p>\r\n          <p className=\"mainBlockAmount\">\r\n            {`${cdType === 'c' ? '- ' : ''}${currencySymbolGenerator(currency, amount)}`}\r\n          </p>\r\n          {invert && (<p className=\"mainBlockTitle\">[更正交易]</p>)}\r\n        </div>\r\n        <InformationList title=\"交易時間\" content={`${dateToString(txnDate, '/')} ${timeToString(txnTime)}`} />\r\n        <InformationList title=\"帳務日期\" content={dateToString(bizDate, '/')} />\r\n        {targetAcct && (\r\n          <InformationList\r\n            title=\"帳號\"\r\n            content={(targetBank ? `(${targetBank}) ` : '') + targetAcct}\r\n          />\r\n        )}\r\n      </DetailDialogContentWrapper>\r\n    );\r\n\r\n    // TODO 若有轉入帳號，就可以立即加入常用帳號。\r\n\r\n    customPopup(title, body);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <DetailCardWrapper\r\n        data-index={index}\r\n        data-inview={inView}\r\n        $noShadow={noShadow}\r\n        id={id}\r\n        onClick={renderDetailDialog}\r\n      >\r\n        <div className=\"avatar\">\r\n          { renderAvatar() }\r\n          { renderTypeIcon() }\r\n        </div>\r\n        <div className=\"description\">\r\n          <h4>{`${toHalfWidth(description)} ${memo ?? ''}`}</h4>\r\n          <p>{txnDescription()}</p>\r\n        </div>\r\n        <div className=\"amount\">\r\n          <h4>\r\n            {invert && '[更正交易] '}\r\n            {cdType === 'c' && '- '}\r\n            {currencySymbolGenerator(currency, amount)}\r\n          </h4>\r\n          <p>{currencySymbolGenerator(currency, balance)}</p>\r\n        </div>\r\n      </DetailCardWrapper>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DetailCard;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}