{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useForm}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup';import{closeDrawer}from'utilities/MessageModal';import{FEIBButton,FEIBHintMessage}from'components/elements';import{DropdownField,TextInputField}from'components/Fields';import{RadioGroupField}from'components/Fields/radioGroupField';import{addNotice,updateNotice}from'./api';import ForeignCurrencyPriceSettingWrapper from'./foreignCurrencyPriceSetting.style';import{validationSchema}from'./validationSchema';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ForeignCurrencyPriceSettingForm=function ForeignCurrencyPriceSettingForm(_ref){var currencyOptions=_ref.currencyOptions,priceTypeOptions=_ref.priceTypeOptions,getAllPriceNotifications=_ref.getAllPriceNotifications,defaultValues=_ref.defaultValues,isAddAction=_ref.isAddAction,currentTime=_ref.currentTime,findSelectedRate=_ref.findSelectedRate;var _useForm=useForm({defaultValues:defaultValues,resolver:yupResolver(validationSchema)}),handleSubmit=_useForm.handleSubmit,control=_useForm.control,watch=_useForm.watch;var watchedCurrency=watch('currency');var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){var param;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:param={currency:data.currency,price:data.price.toFixed(4),exchange_type:Number(data.exchange_type)};if(!isAddAction){_context.next=6;break;}_context.next=4;return addNotice(param);case 4:_context.next=8;break;case 6:_context.next=8;return updateNotice(defaultValues,param);case 8:getAllPriceNotifications();closeDrawer();case 10:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(ForeignCurrencyPriceSettingWrapper,{className:\"drawerContainer\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(DropdownField,{name:\"currency\",labelName:\"\\u5E63\\u5225\",options:currencyOptions,control:control}),/*#__PURE__*/_jsx(RadioGroupField,{name:\"exchange_type\",control:control,labelName:\"\\u63DB\\u532F\\u7A2E\\u985E\",options:priceTypeOptions}),/*#__PURE__*/_jsx(TextInputField,{name:\"price\",control:control,labelName:\"\\u901A\\u77E5\\u532F\\u7387\",placeholder:\"\\u8ACB\\u8F38\\u5165\\u532F\\u7387\",type:\"number\"}),/*#__PURE__*/_jsxs(FEIBHintMessage,{children:[\"\\u76EE\\u524D\\u532F\\u7387\\uFF1A\",findSelectedRate(watchedCurrency),\"\\uFF08\\u66F4\\u65B0\\u6642\\u9593\\uFF1A\",currentTime,\"\\uFF09\"]}),/*#__PURE__*/_jsx(FEIBButton,{type:\"submit\",children:\"\\u78BA\\u8A8D\"})]})});};export default ForeignCurrencyPriceSettingForm;","map":{"version":3,"names":["useForm","yupResolver","closeDrawer","FEIBButton","FEIBHintMessage","DropdownField","TextInputField","RadioGroupField","addNotice","updateNotice","ForeignCurrencyPriceSettingWrapper","validationSchema","ForeignCurrencyPriceSettingForm","currencyOptions","priceTypeOptions","getAllPriceNotifications","defaultValues","isAddAction","currentTime","findSelectedRate","resolver","handleSubmit","control","watch","watchedCurrency","onSubmit","data","param","currency","price","toFixed","exchange_type","Number"],"sources":["C:/Users/allen/git/app2-webview/src/pages/ForeignCurrencyPriceSetting/ForeignCurrencyPriceSettingForm.js"],"sourcesContent":["import { useForm } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport { closeDrawer } from 'utilities/MessageModal';\r\n\r\nimport { FEIBButton, FEIBHintMessage } from 'components/elements';\r\nimport { DropdownField, TextInputField } from 'components/Fields';\r\nimport { RadioGroupField } from 'components/Fields/radioGroupField';\r\n\r\nimport { addNotice, updateNotice } from './api';\r\nimport ForeignCurrencyPriceSettingWrapper from './foreignCurrencyPriceSetting.style';\r\nimport { validationSchema } from './validationSchema';\r\n\r\nconst ForeignCurrencyPriceSettingForm = ({\r\n  currencyOptions,\r\n  priceTypeOptions,\r\n  getAllPriceNotifications,\r\n  defaultValues,\r\n  isAddAction,\r\n  currentTime,\r\n  findSelectedRate,\r\n}) => {\r\n  const { handleSubmit, control, watch } = useForm({\r\n    defaultValues,\r\n    resolver: yupResolver(validationSchema),\r\n  });\r\n\r\n  const watchedCurrency = watch('currency');\r\n\r\n  const onSubmit = async (data) => {\r\n    const param = {\r\n      currency: data.currency,\r\n      price: data.price.toFixed(4),\r\n      exchange_type: Number(data.exchange_type),\r\n    };\r\n\r\n    if (isAddAction) await addNotice(param);\r\n    else await updateNotice(defaultValues, param);\r\n\r\n    getAllPriceNotifications();\r\n    closeDrawer();\r\n  };\r\n\r\n  return (\r\n    <ForeignCurrencyPriceSettingWrapper className=\"drawerContainer\">\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n        <DropdownField\r\n          name=\"currency\"\r\n          labelName=\"幣別\"\r\n          options={currencyOptions}\r\n          control={control}\r\n        />\r\n\r\n        <RadioGroupField\r\n          name=\"exchange_type\"\r\n          control={control}\r\n          labelName=\"換匯種類\"\r\n          options={priceTypeOptions}\r\n        />\r\n\r\n        <TextInputField\r\n          name=\"price\"\r\n          control={control}\r\n          labelName=\"通知匯率\"\r\n          placeholder=\"請輸入匯率\"\r\n          type=\"number\"\r\n        />\r\n\r\n        <FEIBHintMessage>\r\n          目前匯率：\r\n          {findSelectedRate(watchedCurrency)}\r\n          （更新時間：\r\n          {currentTime}\r\n          ）\r\n        </FEIBHintMessage>\r\n\r\n        <FEIBButton type=\"submit\">確認</FEIBButton>\r\n      </form>\r\n    </ForeignCurrencyPriceSettingWrapper>\r\n  );\r\n};\r\n\r\nexport default ForeignCurrencyPriceSettingForm;\r\n"],"mappings":"0PAAA,OAASA,OAAO,KAAQ,iBAAiB,CACzC,OAASC,WAAW,KAAQ,yBAAyB,CACrD,OAASC,WAAW,KAAQ,wBAAwB,CAEpD,OAASC,UAAU,CAAEC,eAAe,KAAQ,qBAAqB,CACjE,OAASC,aAAa,CAAEC,cAAc,KAAQ,mBAAmB,CACjE,OAASC,eAAe,KAAQ,mCAAmC,CAEnE,OAASC,SAAS,CAAEC,YAAY,KAAQ,OAAO,CAC/C,MAAOC,mCAAkC,KAAM,qCAAqC,CACpF,OAASC,gBAAgB,KAAQ,oBAAoB,CAAC,wFAEtD,GAAMC,gCAA+B,CAAG,QAAlCA,gCAA+B,MAQ/B,IAPJC,gBAAe,MAAfA,eAAe,CACfC,gBAAgB,MAAhBA,gBAAgB,CAChBC,wBAAwB,MAAxBA,wBAAwB,CACxBC,aAAa,MAAbA,aAAa,CACbC,WAAW,MAAXA,WAAW,CACXC,WAAW,MAAXA,WAAW,CACXC,gBAAgB,MAAhBA,gBAAgB,CAEhB,aAAyCnB,OAAO,CAAC,CAC/CgB,aAAa,CAAbA,aAAa,CACbI,QAAQ,CAAEnB,WAAW,CAACU,gBAAgB,CACxC,CAAC,CAAC,CAHMU,YAAY,UAAZA,YAAY,CAAEC,OAAO,UAAPA,OAAO,CAAEC,KAAK,UAALA,KAAK,CAKpC,GAAMC,gBAAe,CAAGD,KAAK,CAAC,UAAU,CAAC,CAEzC,GAAME,SAAQ,6FAAG,iBAAOC,IAAI,8HACpBC,KAAK,CAAG,CACZC,QAAQ,CAAEF,IAAI,CAACE,QAAQ,CACvBC,KAAK,CAAEH,IAAI,CAACG,KAAK,CAACC,OAAO,CAAC,CAAC,CAAC,CAC5BC,aAAa,CAAEC,MAAM,CAACN,IAAI,CAACK,aAAa,CAC1C,CAAC,KAEGd,WAAW,+CAAQT,UAAS,CAACmB,KAAK,CAAC,2DAC5BlB,aAAY,CAACO,aAAa,CAAEW,KAAK,CAAC,QAE7CZ,wBAAwB,EAAE,CAC1Bb,WAAW,EAAE,CAAC,uDACf,kBAZKuB,SAAQ,6CAYb,CAED,mBACE,KAAC,kCAAkC,EAAC,SAAS,CAAC,iBAAiB,uBAC7D,cAAM,QAAQ,CAAEJ,YAAY,CAACI,QAAQ,CAAE,wBACrC,KAAC,aAAa,EACZ,IAAI,CAAC,UAAU,CACf,SAAS,CAAC,cAAI,CACd,OAAO,CAAEZ,eAAgB,CACzB,OAAO,CAAES,OAAQ,EACjB,cAEF,KAAC,eAAe,EACd,IAAI,CAAC,eAAe,CACpB,OAAO,CAAEA,OAAQ,CACjB,SAAS,CAAC,0BAAM,CAChB,OAAO,CAAER,gBAAiB,EAC1B,cAEF,KAAC,cAAc,EACb,IAAI,CAAC,OAAO,CACZ,OAAO,CAAEQ,OAAQ,CACjB,SAAS,CAAC,0BAAM,CAChB,WAAW,CAAC,gCAAO,CACnB,IAAI,CAAC,QAAQ,EACb,cAEF,MAAC,eAAe,6CAEbH,gBAAgB,CAACK,eAAe,CAAC,wCAEjCN,WAAW,YAEI,cAElB,KAAC,UAAU,EAAC,IAAI,CAAC,QAAQ,0BAAgB,GACpC,EAC4B,CAEzC,CAAC,CAED,cAAeN,gCAA+B"},"metadata":{},"sourceType":"module","externalDependencies":[]}