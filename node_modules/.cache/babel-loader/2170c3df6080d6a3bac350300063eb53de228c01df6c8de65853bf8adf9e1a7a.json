{"ast":null,"code":"import _objectSpread from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable */import{useEffect,useState,useMemo}from'react';import{DragDropContext,Droppable,Draggable}from'react-beautiful-dnd';import{RemoveRounded}from'@material-ui/icons';import BlockEmpty from'assets/images/favoriteBlock/blockEmpty.png';import{EditIcon}from'assets/images/icons';import BottomDrawer from'components/BottomDrawer';import Layout from'components/Layout/Layout';import{showCustomPrompt}from'utilities/MessageModal';import{closeFunc,startFunc}from'utilities/AppScriptProxy';import{FuncID}from'utilities/FuncID';import S00100_1 from'./S00100_1';import{blockBackgroundGenerator,iconGenerator}from'./favoriteGenerator';import FavoriteDrawerWrapper,{DndItemContainer}from'./S00100.style';import{generateTrimmedList,reorder,move,combineLeftAndRight}from'./utils';import{deleteFavoriteItem,getFavoriteList,modifyFavoriteItem}from'./api';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Favorite=function Favorite(){var initialViewControl={title:'我的最愛',content:'home'};var _useState=useState(initialViewControl),_useState2=_slicedToArray(_useState,2),viewControl=_useState2[0],setViewControl=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),pressTimer=_useState4[0],setPressTimer=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),favoriteList=_useState6[0],setFavoriteList=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),dndList=_useState8[0],setDndList=_useState8[1];var isEditOrAddMode=useMemo(function(){if(viewControl.content==='edit'||viewControl.content==='add')return true;return false;},[viewControl]);// 產生有序的列表\nvar orderedList=useMemo(function(){if(!favoriteList.length)return[];var blocks=favoriteList.reduce(function(acc,block){var position=parseInt(block.position,10);// position + 2 -> 前 2 個是固定的，從陣列第三筆開始排序\nif(position<0)acc.push(block);if(position>=0)acc[position+2]=block;return acc;},[]);var trimmedList=generateTrimmedList(blocks,12,BlockEmpty);return trimmedList;},[favoriteList]);// 取得用戶我的最愛清單\nvar updateFavoriteList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getFavoriteList();case 3:res=_context.sent;if(res){_context.next=6;break;}throw new Error('updateFavortieList response is empty');case 6:setFavoriteList(res);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log('updateFavoriteList',_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function updateFavoriteList(){return _ref.apply(this,arguments);};}();// 控制顯示畫面\nvar handleOpenView=function handleOpenView(viewName){var title='新增我的最愛';if(viewName==='edit')title='編輯我的最愛';if(viewName==='remove')title='移除我的最愛';setViewControl({title:title,content:viewName});};// handle all the items remove\nvar memoValues=useMemo(function(){return{needDelArray:[]};},[]);useEffect(function(){var checkItemsRemoveTimer=setInterval(function(){// for debug\n// console.log(`ready_remove_actKey: ${memoValues.needDelArray}`);\n// IIFE\nvar handleRemoveItems=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var actKey,handleCount;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:actKey='';handleCount=0;case 2:if(!true){_context2.next=13;break;}if(!(memoValues.needDelArray.length==0)){_context2.next=6;break;}if(handleCount>0){updateFavoriteList();}return _context2.abrupt(\"return\",false);case 6:actKey=memoValues.needDelArray.shift();if(!(actKey!=='undefined')){_context2.next=11;break;}_context2.next=10;return deleteFavoriteItem(actKey);case 10:handleCount++;case 11:_context2.next=2;break;case 13:case\"end\":return _context2.stop();}}},_callee2);}))();},500);return function(){// page did unmount's callback\nclearInterval(checkItemsRemoveTimer);};},[]);// 點擊移除按鈕\nvar handleClickRemoveBlock=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref3){var actKey,name;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:actKey=_ref3.actKey,name=_ref3.name;_context3.next=3;return showCustomPrompt({message:\"\\u78BA\\u5B9A\\u8981\\u5F9E\\u6211\\u7684\\u6700\\u611B\\u522A\\u9664 \".concat(name,\" \\u55CE?\"),onOk:function onOk(){memoValues.needDelArray.push(actKey);},cancelContent:'取消'});case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function handleClickRemoveBlock(_x){return _ref4.apply(this,arguments);};}();// 處理拖曳事件\nvar handleOnDragEnd=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(result){var source,destination,updatedDndList,foundList,reorderedList,sourceList,destinationList,combinedList,trimmedList;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:source=result.source,destination=result.destination;if(destination){_context4.next=3;break;}return _context4.abrupt(\"return\");case 3:if(source.droppableId===destination.droppableId){foundList=dndList.find(function(_ref6){var id=_ref6.id;return id===source.droppableId;});reorderedList=reorder(foundList,source.index,destination.index);updatedDndList=dndList.reduce(function(acc,cur){if(cur.id===reorderedList.id)acc.push(reorderedList);else acc.push(cur);return acc;},[]);}else{sourceList=dndList.find(function(_ref7){var id=_ref7.id;return id===source.droppableId;});destinationList=dndList.find(function(_ref8){var id=_ref8.id;return id===destination.droppableId;});updatedDndList=move(sourceList,destinationList,source,destination);}combinedList=combineLeftAndRight(updatedDndList[0].items,updatedDndList[1].items);trimmedList=generateTrimmedList(combinedList,10,'');setDndList(updatedDndList);_context4.next=9;return Promise.all(trimmedList.map(function(item,position){return modifyFavoriteItem({actKey:item.actKey||'',position:parseInt(position,10)});}));case 9:_context4.next=11;return updateFavoriteList();case 11:case\"end\":return _context4.stop();}}},_callee4);}));return function handleOnDragEnd(_x2){return _ref5.apply(this,arguments);};}();// 點擊空白處離開移除模式\nvar handleCloseRemoveMode=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(e){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(viewControl.content!=='remove')){_context5.next=2;break;}return _context5.abrupt(\"return\");case 2:if(e.target.classList.contains('dndArea')||e.target.classList.contains('defaultPage')||e.target.classList.contains('dndItemContainer')){setViewControl(initialViewControl);}case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function handleCloseRemoveMode(_x3){return _ref9.apply(this,arguments);};}();// 長按編輯\nvar handleEditBlock=function handleEditBlock(){return handleOpenView('remove');};var handleTouchStart=function handleTouchStart(){return setPressTimer(setTimeout(handleEditBlock,800));};var handleTouchEnd=function handleTouchEnd(){return pressTimer&&clearTimeout(pressTimer);};// 渲染我的最愛列表\nvar renderBlocksElement=function renderBlocksElement(){if(!orderedList.length)return null;return orderedList.map(function(block,index){return/*#__PURE__*/_jsx(\"button\",{type:\"button\",onTouchStart:block.actKey?handleTouchStart:null,onTouchEnd:block.actKey?handleTouchEnd:null,onClick:block.actKey?function(){return startFunc(block.actKey==='B00200'?FuncID.M00100:block.actKey);}:function(){return handleOpenView('add');},children:block.actKey?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:blockBackgroundGenerator(index),alt:\"block\"}),iconGenerator(block.actKey),block.name]}):/*#__PURE__*/_jsx(\"img\",{src:block,alt:\"empty\"})},block.actKey||index-2);});};// 渲染移除模式可拖曳的列表\nvar renderDndBlocksElement=function renderDndBlocksElement(){if(!dndList.length||!favoriteList.length)return null;var fixedList=favoriteList.filter(function(el){return el.position==='-1';});return/*#__PURE__*/_jsxs(DragDropContext,{onDragEnd:handleOnDragEnd,children:[fixedList.map(function(fixedItem,fixedIndex){return/*#__PURE__*/_jsxs(\"div\",{className:\"dndItem\",children:[/*#__PURE__*/_jsx(\"img\",{src:blockBackgroundGenerator(fixedIndex),alt:\"block\"}),iconGenerator(fixedItem.actKey),fixedItem.name]},fixedItem.actKey);}),dndList.map(function(dndItem,parentIndex){return/*#__PURE__*/_jsx(Droppable,{droppableId:dndItem.id,children:function children(droppableProvided){return/*#__PURE__*/_jsxs(DndItemContainer,{className:\"dndItemContainer\",ref:droppableProvided.innerRef,containerLength:dndItem.items.length,children:[dndItem.items.map(function(item,index){return/*#__PURE__*/_jsx(Draggable,{draggableId:item.actKey,index:index,children:function children(provided){return/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread(_objectSpread({className:\"dndItem\",ref:provided.innerRef},provided.draggableProps),provided.dragHandleProps),{},{children:[/*#__PURE__*/_jsx(\"span\",{className:\"removeButton\",onClick:function onClick(){return handleClickRemoveBlock({actKey:item.actKey,name:item.name});},children:/*#__PURE__*/_jsx(RemoveRounded,{})}),/*#__PURE__*/_jsx(\"img\",{src:blockBackgroundGenerator(2*index+(parentIndex+2)),alt:\"block\"}),iconGenerator(item.actKey),item.name]}));}},item.actKey);}),droppableProvided.placeholder]});}},dndItem.id);})]});};var drawerController=function drawerController(){var content=viewControl.content;if(content==='edit'||content==='add'){return/*#__PURE__*/_jsx(S00100_1,{updateFavoriteList:updateFavoriteList,back2MyFavorite:function back2MyFavorite(){return setViewControl(initialViewControl);},isEditAction:viewControl.content==='edit',favoriteList:favoriteList});}return/*#__PURE__*/_jsxs(\"div\",{className:\"defaultPage\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"editButton\",onClick:function onClick(){return handleOpenView('edit');},children:[\"\\u7DE8\\u8F2F\",/*#__PURE__*/_jsx(EditIcon,{})]}),/*#__PURE__*/_jsx(\"div\",{className:content==='remove'?'dndArea':'favoriteArea',children:content==='remove'?renderDndBlocksElement():renderBlocksElement()})]});};useEffect(function(){updateFavoriteList();},[]);useEffect(function(){if(!orderedList.length)return;var left=[];var right=[];var draggableList=orderedList.filter(function(el){return el.position!=='-1'&&!!el.actKey;});draggableList.forEach(function(el,index){if(!(index%2))left.push(el);else right.push(el);});setDndList([{id:'left',items:left},{id:'right',items:right}]);},[orderedList]);return/*#__PURE__*/_jsx(Layout,{children:/*#__PURE__*/_jsx(BottomDrawer,{noScrollable:true,title:viewControl.title,isOpen:true,onClose:function onClose(){return closeFunc();},onBack:isEditOrAddMode?function(){return setViewControl(initialViewControl);}:null,content:/*#__PURE__*/_jsx(FavoriteDrawerWrapper,{onClick:handleCloseRemoveMode,children:drawerController()})})});};export default Favorite;","map":{"version":3,"names":["useEffect","useState","useMemo","DragDropContext","Droppable","Draggable","RemoveRounded","BlockEmpty","EditIcon","BottomDrawer","Layout","showCustomPrompt","closeFunc","startFunc","FuncID","S00100_1","blockBackgroundGenerator","iconGenerator","FavoriteDrawerWrapper","DndItemContainer","generateTrimmedList","reorder","move","combineLeftAndRight","deleteFavoriteItem","getFavoriteList","modifyFavoriteItem","Favorite","initialViewControl","title","content","viewControl","setViewControl","pressTimer","setPressTimer","favoriteList","setFavoriteList","dndList","setDndList","isEditOrAddMode","orderedList","length","blocks","reduce","acc","block","position","parseInt","push","trimmedList","updateFavoriteList","res","Error","console","log","handleOpenView","viewName","memoValues","needDelArray","checkItemsRemoveTimer","setInterval","handleRemoveItems","actKey","handleCount","shift","clearInterval","handleClickRemoveBlock","name","message","onOk","cancelContent","handleOnDragEnd","result","source","destination","droppableId","foundList","find","id","reorderedList","index","updatedDndList","cur","sourceList","destinationList","combinedList","items","Promise","all","map","item","handleCloseRemoveMode","e","target","classList","contains","handleEditBlock","handleTouchStart","setTimeout","handleTouchEnd","clearTimeout","renderBlocksElement","M00100","renderDndBlocksElement","fixedList","filter","el","fixedItem","fixedIndex","dndItem","parentIndex","droppableProvided","innerRef","provided","draggableProps","dragHandleProps","placeholder","drawerController","left","right","draggableList","forEach"],"sources":["C:/Users/allen/git/app2-webview/src/pages/S00100_Favorite/S00100.js"],"sourcesContent":["/* eslint-disable */\r\nimport { useEffect, useState, useMemo } from 'react';\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\r\nimport { RemoveRounded } from '@material-ui/icons';\r\n\r\nimport BlockEmpty from 'assets/images/favoriteBlock/blockEmpty.png';\r\nimport { EditIcon } from 'assets/images/icons';\r\nimport BottomDrawer from 'components/BottomDrawer';\r\nimport Layout from 'components/Layout/Layout';\r\nimport { showCustomPrompt } from 'utilities/MessageModal';\r\nimport { closeFunc, startFunc } from 'utilities/AppScriptProxy';\r\nimport { FuncID } from 'utilities/FuncID';\r\n\r\nimport S00100_1 from './S00100_1';\r\nimport { blockBackgroundGenerator, iconGenerator } from './favoriteGenerator';\r\nimport FavoriteDrawerWrapper, { DndItemContainer } from './S00100.style';\r\nimport {\r\n  generateTrimmedList, reorder, move, combineLeftAndRight,\r\n} from './utils';\r\nimport { deleteFavoriteItem, getFavoriteList, modifyFavoriteItem } from './api';\r\n\r\nconst Favorite = () => {\r\n  const initialViewControl = {\r\n    title: '我的最愛',\r\n    content: 'home',\r\n  };\r\n  const [viewControl, setViewControl] = useState(initialViewControl);\r\n  const [pressTimer, setPressTimer] = useState(0);\r\n  const [favoriteList, setFavoriteList] = useState([]);\r\n  const [dndList, setDndList] = useState([]);\r\n\r\n  const isEditOrAddMode = useMemo(() => {\r\n    if (viewControl.content === 'edit' || viewControl.content === 'add') return true;\r\n    return false;\r\n  }, [viewControl]);\r\n\r\n  // 產生有序的列表\r\n  const orderedList = useMemo(() => {\r\n    if (!favoriteList.length) return [];\r\n    const blocks = favoriteList.reduce((acc, block) => {\r\n      const position = parseInt(block.position, 10);\r\n      // position + 2 -> 前 2 個是固定的，從陣列第三筆開始排序\r\n      if (position < 0) acc.push(block);\r\n      if (position >= 0) acc[position + 2] = block;\r\n      return acc;\r\n    }, []);\r\n    const trimmedList = generateTrimmedList(blocks, 12, BlockEmpty);\r\n    return trimmedList;\r\n  }, [favoriteList]);\r\n\r\n  // 取得用戶我的最愛清單\r\n  const updateFavoriteList = async () => {\r\n    try {\r\n      const res = await getFavoriteList();\r\n      if (!res) throw new Error('updateFavortieList response is empty');\r\n      setFavoriteList(res);\r\n    } catch (err) {\r\n      console.log('updateFavoriteList', err);\r\n    }\r\n  };\r\n\r\n  // 控制顯示畫面\r\n  const handleOpenView = (viewName) => {\r\n    let title = '新增我的最愛';\r\n    if (viewName === 'edit') title = '編輯我的最愛';\r\n    if (viewName === 'remove') title = '移除我的最愛';\r\n    setViewControl({\r\n      title,\r\n      content: viewName,\r\n    });\r\n  };\r\n\r\n\r\n  // handle all the items remove\r\n  const memoValues = useMemo(() => ({ needDelArray: [] }), []);\r\n\r\n  useEffect(() => {\r\n\r\n    const checkItemsRemoveTimer = setInterval(() => {\r\n\r\n      // for debug\r\n      // console.log(`ready_remove_actKey: ${memoValues.needDelArray}`);\r\n\r\n      // IIFE\r\n      const handleRemoveItems = (async function(){\r\n\r\n        let actKey = '';\r\n        let handleCount = 0;\r\n\r\n        while(true){\r\n\r\n          if(memoValues.needDelArray.length == 0 ){\r\n\r\n            if( handleCount > 0 ){\r\n              updateFavoriteList();\r\n            }\r\n\r\n            return false;\r\n          }\r\n\r\n          actKey = memoValues.needDelArray.shift();\r\n\r\n          if( actKey !== 'undefined' ){\r\n            await deleteFavoriteItem(actKey);\r\n\r\n            handleCount++;\r\n          }\r\n        }\r\n      }());\r\n\r\n    }, 500);\r\n\r\n    return () => {// page did unmount's callback\r\n\r\n      clearInterval(checkItemsRemoveTimer);\r\n    };\r\n  }, []);\r\n\r\n  // 點擊移除按鈕\r\n  const handleClickRemoveBlock = async ({actKey, name}) => {\r\n\r\n    await showCustomPrompt({\r\n      message: `確定要從我的最愛刪除 ${name} 嗎?`,\r\n      onOk: () => {\r\n        memoValues.needDelArray.push(actKey);\r\n      },\r\n      cancelContent: '取消',\r\n    });\r\n  };\r\n\r\n  // 處理拖曳事件\r\n  const handleOnDragEnd = async (result) => {\r\n    const { source, destination } = result;\r\n    if (!destination) return;\r\n\r\n    let updatedDndList;\r\n    if (source.droppableId === destination.droppableId) {\r\n      const foundList = dndList.find(({id}) => id === source.droppableId);\r\n      const reorderedList = reorder(\r\n        foundList,\r\n        source.index,\r\n        destination.index,\r\n      );\r\n      updatedDndList = dndList.reduce((acc, cur) => {\r\n        if (cur.id === reorderedList.id) acc.push(reorderedList);\r\n        else acc.push(cur);\r\n        return acc;\r\n      }, []);\r\n    } else {\r\n      const sourceList = dndList.find(({id}) => id === source.droppableId);\r\n      const destinationList = dndList.find(({id}) => id === destination.droppableId);\r\n      updatedDndList = move(\r\n        sourceList,\r\n        destinationList,\r\n        source,\r\n        destination,\r\n      );\r\n    }\r\n\r\n    const combinedList = combineLeftAndRight(updatedDndList[0].items, updatedDndList[1].items);\r\n    const trimmedList = generateTrimmedList(combinedList, 10, '');\r\n    setDndList(updatedDndList);\r\n    await Promise.all(trimmedList.map((item, position) => (\r\n      modifyFavoriteItem({actKey: item.actKey || '', position: parseInt(position, 10)})\r\n    )));\r\n    await updateFavoriteList();\r\n  };\r\n\r\n  // 點擊空白處離開移除模式\r\n  const handleCloseRemoveMode = async (e) => {\r\n    if (viewControl.content !== 'remove') return;\r\n    if (e.target.classList.contains('dndArea')\r\n     || e.target.classList.contains('defaultPage')\r\n     || e.target.classList.contains('dndItemContainer')) {\r\n      setViewControl(initialViewControl);\r\n    }\r\n  };\r\n\r\n  // 長按編輯\r\n  const handleEditBlock = () => handleOpenView('remove');\r\n  const handleTouchStart = () => setPressTimer(setTimeout(handleEditBlock, 800));\r\n  const handleTouchEnd = () => pressTimer && clearTimeout(pressTimer);\r\n\r\n  // 渲染我的最愛列表\r\n  const renderBlocksElement = () => {\r\n    if (!orderedList.length) return null;\r\n    return orderedList.map((block, index) => (\r\n      <button\r\n        type=\"button\"\r\n        key={block.actKey || index - 2}\r\n        onTouchStart={block.actKey ? handleTouchStart : null}\r\n        onTouchEnd={block.actKey ? handleTouchEnd : null}\r\n        onClick={block.actKey ? () => startFunc(block.actKey === 'B00200' ? FuncID.M00100 : block.actKey) : () => handleOpenView('add')}\r\n      >\r\n        {\r\n        block.actKey\r\n          ? (\r\n            <>\r\n              <img src={blockBackgroundGenerator(index)} alt=\"block\" />\r\n              {iconGenerator(block.actKey)}\r\n              {block.name}\r\n            </>\r\n          )\r\n          : <img src={block} alt=\"empty\" />\r\n        }\r\n      </button>\r\n    ));\r\n  };\r\n\r\n  // 渲染移除模式可拖曳的列表\r\n  const renderDndBlocksElement = () => {\r\n    if (!dndList.length || !favoriteList.length) return null;\r\n    const fixedList = favoriteList.filter((el) => el.position === '-1');\r\n    return (\r\n      <DragDropContext onDragEnd={handleOnDragEnd}>\r\n        {fixedList.map((fixedItem, fixedIndex) => (\r\n          <div\r\n            className=\"dndItem\"\r\n            key={fixedItem.actKey}\r\n          >\r\n            <img src={blockBackgroundGenerator(fixedIndex)} alt=\"block\" />\r\n            {iconGenerator(fixedItem.actKey)}\r\n            {fixedItem.name}\r\n          </div>\r\n        ))}\r\n        {\r\n     dndList.map((dndItem, parentIndex) => (\r\n       <Droppable key={dndItem.id} droppableId={dndItem.id}>\r\n         {(droppableProvided) => (\r\n           <DndItemContainer\r\n             className=\"dndItemContainer\"\r\n             ref={droppableProvided.innerRef}\r\n             containerLength={dndItem.items.length}\r\n           >\r\n             {dndItem.items.map((item, index) => (\r\n               <Draggable\r\n                 key={item.actKey}\r\n                 draggableId={item.actKey}\r\n                 index={index}\r\n               >\r\n                 {(provided) => (\r\n                   <div\r\n                     className=\"dndItem\"\r\n                     ref={provided.innerRef}\r\n                     {...provided.draggableProps}\r\n                     {...provided.dragHandleProps}\r\n                   >\r\n                     <span\r\n                       className=\"removeButton\"\r\n                       onClick={() => handleClickRemoveBlock({actKey: item.actKey, name: item.name})}\r\n                     >\r\n                       <RemoveRounded />\r\n                     </span>\r\n                     <img src={blockBackgroundGenerator((2 * index) + (parentIndex + 2))} alt=\"block\" />\r\n                     {iconGenerator(item.actKey)}\r\n                     {item.name}\r\n                   </div>\r\n                 )}\r\n               </Draggable>\r\n             ))}\r\n             {droppableProvided.placeholder}\r\n           </DndItemContainer>\r\n         )}\r\n       </Droppable>\r\n     ))\r\n        }\r\n      </DragDropContext>\r\n    );\r\n  };\r\n\r\n  const drawerController = () => {\r\n    const {content} = viewControl;\r\n    if (content === 'edit' || content === 'add') {\r\n      return (\r\n        <S00100_1\r\n          updateFavoriteList={updateFavoriteList}\r\n          back2MyFavorite={() => setViewControl(initialViewControl)}\r\n          isEditAction={viewControl.content === 'edit'}\r\n          favoriteList={favoriteList}\r\n        />\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"defaultPage\">\r\n        <button type=\"button\" className=\"editButton\" onClick={() => handleOpenView('edit')}>\r\n          編輯\r\n          <EditIcon />\r\n        </button>\r\n        <div className={content === 'remove' ? 'dndArea' : 'favoriteArea'}>\r\n          {content === 'remove' ? renderDndBlocksElement() : renderBlocksElement()}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    updateFavoriteList();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!orderedList.length) return;\r\n    const left = [];\r\n    const right = [];\r\n    const draggableList = orderedList.filter((el) => el.position !== '-1' && !!el.actKey);\r\n    draggableList.forEach((el, index) => {\r\n      if (!(index % 2)) left.push(el);\r\n      else right.push(el);\r\n    });\r\n    setDndList([{id: 'left', items: left}, {id: 'right', items: right}]);\r\n  }, [orderedList]);\r\n\r\n  return (\r\n    <Layout>\r\n      <BottomDrawer\r\n        noScrollable\r\n        title={viewControl.title}\r\n        isOpen\r\n        onClose={() => closeFunc()}\r\n        onBack={isEditOrAddMode ? () => setViewControl(initialViewControl) : null}\r\n        content={(\r\n          <FavoriteDrawerWrapper onClick={handleCloseRemoveMode}>\r\n            { drawerController() }\r\n          </FavoriteDrawerWrapper>\r\n        )}\r\n      />\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Favorite;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}