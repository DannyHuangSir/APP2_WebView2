{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useEffect}from'react';import{useForm}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup';import{transactionAuth,closeFunc}from'utilities/AppScriptProxy';import{renewPwd}from'pages/A00700_RegularPwdModify/api';import{showCustomPrompt,showAnimationModal}from'utilities/MessageModal';/* Elements */import Layout from'components/Layout/Layout';import ConfirmButtons from'components/ConfirmButtons';import InfoArea from'components/InfoArea';import e2ee from'utilities/E2ee';/* Styles */import{AuthCode}from'utilities/TxnAuthCode';import{useDispatch}from'react-redux';import{setWaittingVisible}from'stores/reducers/ModalReducer';import{PasswordInputField}from'components/Fields';import RegularPwdModifyWrapper from'./regularPwdModify.style';import{validationSchema}from'./validationSchema';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RegularPwdModify=function RegularPwdModify(){var dispatch=useDispatch();var _useForm=useForm({defaultValues:{password:'',newPassword:'',newPasswordCheck:''},resolver:yupResolver(validationSchema)}),handleSubmit=_useForm.handleSubmit,control=_useForm.control;// 設定結果彈窗\nvar setResultDialog=function setResultDialog(response){showAnimationModal({isSuccess:response,successTitle:'設定成功',successDesc:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u60A8\\u7684\\u7DB2\\u9280\\u5BC6\\u78BC\\u5DF2\\u8B8A\\u66F4\\u6210\\u529F\\u56C9\\uFF01\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u4E0B\\u6B21\\u8ACB\\u4F7F\\u7528\\u65B0\\u8A2D\\u5B9A\\u4E4B\\u5BC6\\u78BC\\u9032\\u884C\\u767B\\u5165\"})]}),errorTitle:'設定失敗',errorCode:'',errorDesc:'',onClose:function onClose(){return closeFunc();}});};// 點擊儲存變更，呼叫更新網銀密碼API\nvar onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var password,newPassword,newPasswordCheck,jsRs,param,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:password=_ref.password,newPassword=_ref.newPassword,newPasswordCheck=_ref.newPasswordCheck;_context.next=3;return transactionAuth(AuthCode.A00700);case 3:jsRs=_context.sent;if(!jsRs.result){_context.next=12;break;}dispatch(setWaittingVisible(true));param={password:e2ee(password),newPassword:e2ee(newPassword),newPasswordCheck:e2ee(newPasswordCheck),actionCode:1};_context.next=9;return renewPwd(param);case 9:response=_context.sent;dispatch(setWaittingVisible(false));setResultDialog(response);case 12:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();// 不變更密碼，並且離開此頁面\nvar remainSamePwd=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return renewPwd({actionCode:2});case 2:closeFunc();case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function remainSamePwd(){return _ref3.apply(this,arguments);};}();useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var message1,message2;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:message1=/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u89AA\\u611B\\u7684\\u5BA2\\u6236\\uFF0C\\u60A8\\u597D\\uFF1A\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u8DDD\\u96E2\\u60A8\\u4E0A\\u6B21\\u8B8A\\u66F4\\u5BC6\\u78BC\\u5DF2\\u5C46\\u4E00\\u5E74\\u3002\\u70BA\\u4E86\\u4FDD\\u969C\\u5E33\\u6236\\u5B89\\u5168\\uFF0C\\u8ACB\\u518D\\u4E00\\u6B21\\u8B8A\\u66F4\\u5BC6\\u78BC\\u3002\\u8B1D\\u8B1D\\u60A8\\uFF01\"})]});message2=/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u60A8\\u78BA\\u5B9A\\u4E0D\\u8981\\u8B8A\\u66F4\\u7DB2\\u9280\\u5BC6\\u78BC\\u55CE\\uFF1F\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u4E45\\u672A\\u66F4\\u65B0\\u7DB2\\u9280\\u5BC6\\u78BC\\u53EF\\u80FD\\u6703\\u6709\\u5B89\\u5168\\u6027\\u98A8\\u96AA\"})]});// 提醒久未變更密碼彈窗\n_context4.next=4;return showCustomPrompt({message:message1,cancelContent:'維持不變',okContent:'立即變更',onOk:function onOk(){},// 警告不變更密碼會有安全性問題\nonCancel:function(){var _onCancel=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return showCustomPrompt({message:message2,cancelContent:'取消',okContent:'確認',onOk:remainSamePwd});case 2:case\"end\":return _context3.stop();}}},_callee3);}));function onCancel(){return _onCancel.apply(this,arguments);}return onCancel;}()});case 4:case\"end\":return _context4.stop();}}},_callee4);})),[]);return/*#__PURE__*/_jsx(Layout,{title:\"\\u5B9A\\u671F\\u7DB2\\u9280\\u5BC6\\u78BC\\u8B8A\\u66F4\",goBack:false,goHome:false,children:/*#__PURE__*/_jsx(RegularPwdModifyWrapper,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(PasswordInputField,{labelName:\"\\u60A8\\u7684\\u7DB2\\u9280\\u5BC6\\u78BC\",name:\"password\",control:control}),/*#__PURE__*/_jsx(PasswordInputField,{labelName:\"\\u65B0\\u7684\\u7DB2\\u9280\\u5BC6\\u78BC\",name:\"newPassword\",control:control}),/*#__PURE__*/_jsx(PasswordInputField,{labelName:\"\\u8ACB\\u78BA\\u8A8D\\u65B0\\u7684\\u7DB2\\u9280\\u5BC6\\u78BC\",name:\"newPasswordCheck\",control:control})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(InfoArea,{space:\"bottom\",children:\"*\\u5B9A\\u671F\\u9032\\u884C\\u5BC6\\u78BC\\u4EE5\\u53CA\\u500B\\u8CC7\\u66F4\\u65B0\\u4EE5\\u78BA\\u4FDD\\u5E33\\u865F\\u5B89\\u5168\"}),/*#__PURE__*/_jsx(ConfirmButtons,{subButtonValue:\"\\u7DAD\\u6301\\u4E0D\\u8B8A\",mainButtonValue:\"\\u5132\\u5B58\\u8B8A\\u66F4\",subButtonOnClick:remainSamePwd})]})]})})});};export default RegularPwdModify;","map":{"version":3,"names":["useEffect","useForm","yupResolver","transactionAuth","closeFunc","renewPwd","showCustomPrompt","showAnimationModal","Layout","ConfirmButtons","InfoArea","e2ee","AuthCode","useDispatch","setWaittingVisible","PasswordInputField","RegularPwdModifyWrapper","validationSchema","RegularPwdModify","dispatch","defaultValues","password","newPassword","newPasswordCheck","resolver","handleSubmit","control","setResultDialog","response","isSuccess","successTitle","successDesc","errorTitle","errorCode","errorDesc","onClose","onSubmit","A00700","jsRs","result","param","actionCode","remainSamePwd","message1","message2","message","cancelContent","okContent","onOk","onCancel"],"sources":["C:/Users/allen/git/app2-webview/src/pages/A00700_RegularPwdModify/A00700.js"],"sourcesContent":["import { useEffect } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport { transactionAuth, closeFunc } from 'utilities/AppScriptProxy';\r\nimport { renewPwd } from 'pages/A00700_RegularPwdModify/api';\r\nimport { showCustomPrompt, showAnimationModal } from 'utilities/MessageModal';\r\n\r\n/* Elements */\r\nimport Layout from 'components/Layout/Layout';\r\nimport ConfirmButtons from 'components/ConfirmButtons';\r\nimport InfoArea from 'components/InfoArea';\r\nimport e2ee from 'utilities/E2ee';\r\n\r\n/* Styles */\r\nimport { AuthCode } from 'utilities/TxnAuthCode';\r\nimport { useDispatch } from 'react-redux';\r\nimport { setWaittingVisible } from 'stores/reducers/ModalReducer';\r\nimport { PasswordInputField } from 'components/Fields';\r\nimport RegularPwdModifyWrapper from './regularPwdModify.style';\r\nimport { validationSchema } from './validationSchema';\r\n\r\nconst RegularPwdModify = () => {\r\n  const dispatch = useDispatch();\r\n  const { handleSubmit, control } = useForm({\r\n    defaultValues: {\r\n      password: '',\r\n      newPassword: '',\r\n      newPasswordCheck: '',\r\n    },\r\n    resolver: yupResolver(validationSchema),\r\n  });\r\n\r\n  // 設定結果彈窗\r\n  const setResultDialog = (response) => {\r\n    showAnimationModal({\r\n      isSuccess: response,\r\n      successTitle: '設定成功',\r\n      successDesc: (\r\n        <>\r\n          <p>您的網銀密碼已變更成功囉！</p>\r\n          <p>下次請使用新設定之密碼進行登入</p>\r\n        </>\r\n      ),\r\n      errorTitle: '設定失敗',\r\n      errorCode: '',\r\n      errorDesc: '',\r\n      onClose: () => closeFunc(),\r\n    });\r\n  };\r\n\r\n  // 點擊儲存變更，呼叫更新網銀密碼API\r\n  const onSubmit = async ({ password, newPassword, newPasswordCheck }) => {\r\n    const jsRs = await transactionAuth(AuthCode.A00700);\r\n    if (jsRs.result) {\r\n      dispatch(setWaittingVisible(true));\r\n      const param = {\r\n        password: e2ee(password),\r\n        newPassword: e2ee(newPassword),\r\n        newPasswordCheck: e2ee(newPasswordCheck),\r\n        actionCode: 1,\r\n      };\r\n      const response = await renewPwd(param);\r\n      dispatch(setWaittingVisible(false));\r\n      setResultDialog(response);\r\n    }\r\n  };\r\n\r\n  // 不變更密碼，並且離開此頁面\r\n  const remainSamePwd = async () => {\r\n    await renewPwd({ actionCode: 2 });\r\n    closeFunc();\r\n  };\r\n\r\n  useEffect(async () => {\r\n    const message1 = (\r\n      <>\r\n        <p>親愛的客戶，您好：</p>\r\n        <p>距離您上次變更密碼已屆一年。為了保障帳戶安全，請再一次變更密碼。謝謝您！</p>\r\n      </>\r\n    );\r\n\r\n    const message2 = (\r\n      <>\r\n        <p>您確定不要變更網銀密碼嗎？</p>\r\n        <p>久未更新網銀密碼可能會有安全性風險</p>\r\n      </>\r\n    );\r\n\r\n    // 提醒久未變更密碼彈窗\r\n    await showCustomPrompt({\r\n      message: message1,\r\n      cancelContent: '維持不變',\r\n      okContent: '立即變更',\r\n      onOk: () => {},\r\n      // 警告不變更密碼會有安全性問題\r\n      onCancel: async () => {\r\n        await showCustomPrompt({\r\n          message: message2,\r\n          cancelContent: '取消',\r\n          okContent: '確認',\r\n          onOk: remainSamePwd,\r\n        });\r\n      },\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <Layout title=\"定期網銀密碼變更\" goBack={false} goHome={false}>\r\n      <RegularPwdModifyWrapper>\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <div>\r\n            <PasswordInputField\r\n              labelName=\"您的網銀密碼\"\r\n              name=\"password\"\r\n              control={control}\r\n            />\r\n            <PasswordInputField\r\n              labelName=\"新的網銀密碼\"\r\n              name=\"newPassword\"\r\n              control={control}\r\n            />\r\n            <PasswordInputField\r\n              labelName=\"請確認新的網銀密碼\"\r\n              name=\"newPasswordCheck\"\r\n              control={control}\r\n            />\r\n          </div>\r\n          <div>\r\n            <InfoArea space=\"bottom\">\r\n              *定期進行密碼以及個資更新以確保帳號安全\r\n            </InfoArea>\r\n            <ConfirmButtons\r\n              subButtonValue=\"維持不變\"\r\n              mainButtonValue=\"儲存變更\"\r\n              subButtonOnClick={remainSamePwd}\r\n            />\r\n          </div>\r\n        </form>\r\n      </RegularPwdModifyWrapper>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default RegularPwdModify;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}