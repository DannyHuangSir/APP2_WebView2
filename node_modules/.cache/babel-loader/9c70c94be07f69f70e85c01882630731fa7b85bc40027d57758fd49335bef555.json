{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useHistory,useLocation}from'react-router';import Layout from'components/Layout/Layout';import AccountDetails from'components/AccountDetails/accountDetails';import{closeFunc}from'utilities/AppScriptProxy';import{dateToYMD}from'utilities/Generator';import{showError}from'utilities/MessageModal';import{getTransactionDetails}from'./api';/**\r\n * C00600 存錢計畫 歷程頁\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";var DepositPlanTransactionPage=function DepositPlanTransactionPage(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),plan=_useState2[0],setPlan=_useState2[1];var history=useHistory();var _useLocation=useLocation(),state=_useLocation.state;useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// 從別的頁面跳轉至此頁時，應指定所查詢的帳戶。\nif(state!==null&&state!==void 0&&state.plan){setPlan(_objectSpread(_objectSpread({},state.plan),{},{accountNo:state.plan.bindAccountNo,balance:state.plan.currentBalance}));}else{showError('查無計畫',closeFunc);}case 1:case\"end\":return _context.stop();}}},_callee);})),[]);/**\r\n   * 更新帳戶交易明細清單\r\n   * @param {*} conditions 查詢條件。\r\n   */var updateTransactions=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(conditions){var request,transData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:request=_objectSpread({accountNo:plan===null||plan===void 0?void 0:plan.bindAccountNo,// TODO plan 內的 createDate 格式為 '2022-11-28T05:49:11Z'，應該請後端修改成與 endDate 相同格式(YYYYMMDD)\nstartDate:dateToYMD(new Date(plan.createDate)),// 查詢起始日為計畫建立的當天\nendDate:plan===null||plan===void 0?void 0:plan.endDate},conditions);// 取得帳戶交易明細（三年內）\n_context2.next=3;return getTransactionDetails(request);case 3:transData=_context2.sent;return _context2.abrupt(\"return\",transData);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function updateTransactions(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Layout,{title:\"\\u5B58\\u9322\\u6B77\\u7A0B\",hasClearHeader:true,goBackFunc:function goBackFunc(){return history.goBack();},children:plan?/*#__PURE__*/_jsx(AccountDetails,{selectedAccount:plan,onSearch:updateTransactions,mode:1}):null});};export default DepositPlanTransactionPage;","map":{"version":3,"names":["useState","useEffect","useHistory","useLocation","Layout","AccountDetails","closeFunc","dateToYMD","showError","getTransactionDetails","DepositPlanTransactionPage","plan","setPlan","history","state","accountNo","bindAccountNo","balance","currentBalance","updateTransactions","conditions","request","startDate","Date","createDate","endDate","transData","goBack"],"sources":["C:/Users/allen/git/app2-webview/src/pages/C00600_DepositPlan/C00600_1.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useHistory, useLocation } from 'react-router';\r\n\r\nimport Layout from 'components/Layout/Layout';\r\nimport AccountDetails from 'components/AccountDetails/accountDetails';\r\nimport { closeFunc } from 'utilities/AppScriptProxy';\r\nimport { dateToYMD } from 'utilities/Generator';\r\nimport { showError } from 'utilities/MessageModal';\r\n\r\nimport { getTransactionDetails } from './api';\r\n\r\n/**\r\n * C00600 存錢計畫 歷程頁\r\n */\r\nconst DepositPlanTransactionPage = () => {\r\n  const [plan, setPlan] = useState(null);\r\n  const history = useHistory();\r\n  const {state} = useLocation();\r\n\r\n  useEffect(async () => {\r\n    // 從別的頁面跳轉至此頁時，應指定所查詢的帳戶。\r\n    if (state?.plan) {\r\n      setPlan({\r\n        ...state.plan,\r\n        accountNo: state.plan.bindAccountNo,\r\n        balance: state.plan.currentBalance,\r\n      });\r\n    } else {\r\n      showError('查無計畫', closeFunc);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * 更新帳戶交易明細清單\r\n   * @param {*} conditions 查詢條件。\r\n   */\r\n  const updateTransactions = async (conditions) => {\r\n    const request = {\r\n      accountNo: plan?.bindAccountNo,\r\n      // TODO plan 內的 createDate 格式為 '2022-11-28T05:49:11Z'，應該請後端修改成與 endDate 相同格式(YYYYMMDD)\r\n      startDate: dateToYMD(new Date(plan.createDate)), // 查詢起始日為計畫建立的當天\r\n      endDate: plan?.endDate,\r\n      ...conditions,\r\n    };\r\n\r\n    // 取得帳戶交易明細（三年內）\r\n    const transData = await getTransactionDetails(request);\r\n    return transData;\r\n  };\r\n\r\n  return (\r\n    <Layout title=\"存錢歷程\" hasClearHeader goBackFunc={() => history.goBack()}>\r\n      {plan ? (\r\n        <AccountDetails\r\n          selectedAccount={plan}\r\n          onSearch={updateTransactions}\r\n          mode={1}\r\n        />\r\n      ) : null}\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default DepositPlanTransactionPage;\r\n"],"mappings":"meAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,UAAU,CAAEC,WAAW,KAAQ,cAAc,CAEtD,MAAOC,OAAM,KAAM,0BAA0B,CAC7C,MAAOC,eAAc,KAAM,0CAA0C,CACrE,OAASC,SAAS,KAAQ,0BAA0B,CACpD,OAASC,SAAS,KAAQ,qBAAqB,CAC/C,OAASC,SAAS,KAAQ,wBAAwB,CAElD,OAASC,qBAAqB,KAAQ,OAAO,CAE7C;AACA;AACA,GAFA,2CAGA,GAAMC,2BAA0B,CAAG,QAA7BA,2BAA0B,EAAS,CACvC,cAAwBV,QAAQ,CAAC,IAAI,CAAC,wCAA/BW,IAAI,eAAEC,OAAO,eACpB,GAAMC,QAAO,CAAGX,UAAU,EAAE,CAC5B,iBAAgBC,WAAW,EAAE,CAAtBW,KAAK,cAALA,KAAK,CAEZb,SAAS,wEAAC,qIACR;AACA,GAAIa,KAAK,SAALA,KAAK,WAALA,KAAK,CAAEH,IAAI,CAAE,CACfC,OAAO,gCACFE,KAAK,CAACH,IAAI,MACbI,SAAS,CAAED,KAAK,CAACH,IAAI,CAACK,aAAa,CACnCC,OAAO,CAAEH,KAAK,CAACH,IAAI,CAACO,cAAc,GAClC,CACJ,CAAC,IAAM,CACLV,SAAS,CAAC,MAAM,CAAEF,SAAS,CAAC,CAC9B,CAAC,sDACF,GAAE,EAAE,CAAC,CAEN;AACF;AACA;AACA,KACE,GAAMa,mBAAkB,6FAAG,kBAAOC,UAAU,8IACpCC,OAAO,gBACXN,SAAS,CAAEJ,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEK,aAAa,CAC9B;AACAM,SAAS,CAAEf,SAAS,CAAC,GAAIgB,KAAI,CAACZ,IAAI,CAACa,UAAU,CAAC,CAAC,CAAE;AACjDC,OAAO,CAAEd,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEc,OAAO,EACnBL,UAAU,EAGf;AAAA,uBACwBX,sBAAqB,CAACY,OAAO,CAAC,QAAhDK,SAAS,iDACRA,SAAS,0DACjB,kBAZKP,mBAAkB,6CAYvB,CAED,mBACE,KAAC,MAAM,EAAC,KAAK,CAAC,0BAAM,CAAC,cAAc,MAAC,UAAU,CAAE,4BAAMN,QAAO,CAACc,MAAM,EAAE,EAAC,UACpEhB,IAAI,cACH,KAAC,cAAc,EACb,eAAe,CAAEA,IAAK,CACtB,QAAQ,CAAEQ,kBAAmB,CAC7B,IAAI,CAAE,CAAE,EACR,CACA,IAAI,EACD,CAEb,CAAC,CAED,cAAeT,2BAA0B"},"metadata":{},"sourceType":"module","externalDependencies":[]}