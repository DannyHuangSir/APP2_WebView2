{"ast":null,"code":"import _classCallCheck from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/createClass.js\";/* eslint-disable class-methods-use-this */import CipherUtil from'./CipherUtil';var assert=require('assert');var JWTUtil=/*#__PURE__*/function(){function JWTUtil(){_classCallCheck(this,JWTUtil);}_createClass(JWTUtil,[{key:\"encryptJWTMessage\",value:/**\r\n   * Encrypt JWT Message\r\n   * @param {*} aesKey\r\n   * @param {*} iv\r\n   * @param {*} message\r\n   */function encryptJWTMessage(aesKey,iv,message){var data=CipherUtil.encryptAES(aesKey,iv,message);var hmac=CipherUtil.encryptHMAC(aesKey,message);return{data:data,mac:hmac};}/**\r\n   * Decrypt JWT Message\r\n   * @param {*} aesKey\r\n   * @param {*} iv\r\n   * @param {*} message\r\n   * @param {*} mac\r\n   */},{key:\"decryptJWTMessage\",value:function decryptJWTMessage(aesKey,iv,message,mac){try{var request=CipherUtil.decryptAES(aesKey,iv,message);var hmac=CipherUtil.encryptHMAC(aesKey,request);assert.strictEqual(hmac,mac);var json=JSON.parse(request);return json;}catch(ex){console.log(ex);return null;}}}]);return JWTUtil;}();export default new JWTUtil();","map":{"version":3,"names":["CipherUtil","assert","require","JWTUtil","aesKey","iv","message","data","encryptAES","hmac","encryptHMAC","mac","request","decryptAES","strictEqual","json","JSON","parse","ex","console","log"],"sources":["C:/Users/allen/git/app2-webview/src/utilities/JWTUtil.js"],"sourcesContent":["/* eslint-disable class-methods-use-this */\r\nimport CipherUtil from './CipherUtil';\r\n\r\nconst assert = require('assert');\r\n\r\nclass JWTUtil {\r\n  /**\r\n   * Encrypt JWT Message\r\n   * @param {*} aesKey\r\n   * @param {*} iv\r\n   * @param {*} message\r\n   */\r\n  encryptJWTMessage(aesKey, iv, message) {\r\n    const data = CipherUtil.encryptAES(aesKey, iv, message);\r\n    const hmac = CipherUtil.encryptHMAC(aesKey, message);\r\n\r\n    return {\r\n      data,\r\n      mac: hmac,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Decrypt JWT Message\r\n   * @param {*} aesKey\r\n   * @param {*} iv\r\n   * @param {*} message\r\n   * @param {*} mac\r\n   */\r\n  decryptJWTMessage(aesKey, iv, message, mac) {\r\n    try {\r\n      const request = CipherUtil.decryptAES(aesKey, iv, message);\r\n      const hmac = CipherUtil.encryptHMAC(aesKey, request);\r\n      assert.strictEqual(hmac, mac);\r\n      const json = JSON.parse(request);\r\n      return json;\r\n    } catch (ex) {\r\n      console.log(ex);\r\n      return null;\r\n    }\r\n  }\r\n}\r\nexport default new JWTUtil();\r\n"],"mappings":"wOAAA,2CACA,MAAOA,WAAU,KAAM,cAAc,CAErC,GAAMC,OAAM,CAAGC,OAAO,CAAC,QAAQ,CAAC,CAAC,GAE3BC,QAAO,gIACX;AACF;AACA;AACA;AACA;AACA,KACE,2BAAkBC,MAAM,CAAEC,EAAE,CAAEC,OAAO,CAAE,CACrC,GAAMC,KAAI,CAAGP,UAAU,CAACQ,UAAU,CAACJ,MAAM,CAAEC,EAAE,CAAEC,OAAO,CAAC,CACvD,GAAMG,KAAI,CAAGT,UAAU,CAACU,WAAW,CAACN,MAAM,CAAEE,OAAO,CAAC,CAEpD,MAAO,CACLC,IAAI,CAAJA,IAAI,CACJI,GAAG,CAAEF,IACP,CAAC,CACH,CAEA;AACF;AACA;AACA;AACA;AACA;AACA,KANE,iCAOA,2BAAkBL,MAAM,CAAEC,EAAE,CAAEC,OAAO,CAAEK,GAAG,CAAE,CAC1C,GAAI,CACF,GAAMC,QAAO,CAAGZ,UAAU,CAACa,UAAU,CAACT,MAAM,CAAEC,EAAE,CAAEC,OAAO,CAAC,CAC1D,GAAMG,KAAI,CAAGT,UAAU,CAACU,WAAW,CAACN,MAAM,CAAEQ,OAAO,CAAC,CACpDX,MAAM,CAACa,WAAW,CAACL,IAAI,CAAEE,GAAG,CAAC,CAC7B,GAAMI,KAAI,CAAGC,IAAI,CAACC,KAAK,CAACL,OAAO,CAAC,CAChC,MAAOG,KAAI,CACb,CAAE,MAAOG,EAAE,CAAE,CACXC,OAAO,CAACC,GAAG,CAACF,EAAE,CAAC,CACf,MAAO,KAAI,CACb,CACF,CAAC,uBAEH,cAAe,IAAIf,QAAO,EAAE"},"metadata":{},"sourceType":"module","externalDependencies":[]}