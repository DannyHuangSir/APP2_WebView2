{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useHistory}from'react-router';import{useDispatch}from'react-redux';import uuid from'react-uuid';import{setWaittingVisible}from'stores/reducers/ModalReducer';import Main from'components/Layout';import Layout from'components/Layout/Layout';import Badge from'components/Badge';import{FEIBButton,FEIBTabContext,FEIBTabList,FEIBTab}from'components/elements';import EmptyData from'components/EmptyData';import{currencySymbolGenerator}from'utilities/Generator';import{getThisMonth,getMonthList}from'utilities/MonthGenerator';import{getRewards}from'./api';import{RewardPageWrapper}from'./C00700.style';/**\r\n * C00700_2 信用卡 回饋\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var C007002=function C007002(){var history=useHistory();var dispatch=useDispatch();var _useState=useState(),_useState2=_slicedToArray(_useState,2),rewards=_useState2[0],setRewards=_useState2[1];var _useState3=useState(getThisMonth()),_useState4=_slicedToArray(_useState3,2),selectedMonth=_useState4[0],setSelectedMonth=_useState4[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setWaittingVisible(true));// TODO getRewards API 尚未有回傳資料\n_context.next=3;return getRewards();case 3:response=_context.sent;setRewards(response.data);dispatch(setWaittingVisible(false));case 6:case\"end\":return _context.stop();}}},_callee);})),[]);var handleOnTabChange=function handleOnTabChange(_,id){setSelectedMonth(id);};var renderSelectedReward=function renderSelectedReward(){if(!rewards)return null;// TODO 不確定 getRewards 回傳的 period 是什麼格式，有測資時可能會出錯，後續需要修改\nvar foundReward=rewards.find(function(r){return r.period===selectedMonth;});return foundReward?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Badge,{label:\"\".concat(foundReward.date.slice(0,4),\"/\").concat(foundReward.date.slice(4,6),\" \\u56DE\\u994B\\u5408\\u8A08\"),value:currencySymbolGenerator('TWD',foundReward.amount+foundReward.communityAmount)}),/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"w-3/4\",children:\"\\u6D3B\\u52D5\\u540D\\u7A31\"}),/*#__PURE__*/_jsx(\"th\",{className:\"w-1/4\",children:\"\\u91D1\\u984D\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"\\u5237\\u5361\\u56DE\\u994B\"}),/*#__PURE__*/_jsx(\"td\",{children:currencySymbolGenerator('TWD',foundReward.amount)})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"\\u793E\\u7FA4\\u5708\\u5206\\u6F64\"}),/*#__PURE__*/_jsx(\"td\",{children:currencySymbolGenerator('TWD',foundReward.communityAmount)})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"font-14 mb-6\",children:\"\\u5BE6\\u969B\\u56DE\\u994B\\u91D1\\u984D\\u4EE5\\u5E33\\u55AE\\u70BA\\u6E96\"})]}):/*#__PURE__*/_jsx(\"div\",{style:{height:'20rem',marginTop:'6rem'},children:/*#__PURE__*/_jsx(EmptyData,{})});};return/*#__PURE__*/_jsx(Layout,{title:\"\\u6BCF\\u6708\\u73FE\\u91D1\\u56DE\\u994B\",goBackFunc:function goBackFunc(){return history.goBack();},children:/*#__PURE__*/_jsx(Main,{children:/*#__PURE__*/_jsxs(RewardPageWrapper,{children:[/*#__PURE__*/_jsx(FEIBTabContext,{value:selectedMonth,children:/*#__PURE__*/_jsx(FEIBTabList,{$size:\"small\",$type:\"fixed\",onChange:handleOnTabChange,children:getMonthList().map(function(m){return/*#__PURE__*/_jsx(FEIBTab,{label:\"\".concat(m.slice(4,6),\"\\u6708\"),value:m},uuid());})})}),renderSelectedReward(),/*#__PURE__*/_jsx(FEIBButton,{onClick:function onClick(){return history.goBack();},children:\"\\u56DE\\u4FE1\\u7528\\u5361\\u9996\\u9801\"})]})})});};export default C007002;","map":{"version":3,"names":["useState","useEffect","useHistory","useDispatch","uuid","setWaittingVisible","Main","Layout","Badge","FEIBButton","FEIBTabContext","FEIBTabList","FEIBTab","EmptyData","currencySymbolGenerator","getThisMonth","getMonthList","getRewards","RewardPageWrapper","C007002","history","dispatch","rewards","setRewards","selectedMonth","setSelectedMonth","response","data","handleOnTabChange","_","id","renderSelectedReward","foundReward","find","r","period","date","slice","amount","communityAmount","height","marginTop","goBack","map","m"],"sources":["C:/Users/allen/git/app2-webview/src/pages/C00700_CreditCard/C00700_2.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useHistory } from 'react-router';\r\nimport { useDispatch } from 'react-redux';\r\nimport uuid from 'react-uuid';\r\n\r\nimport { setWaittingVisible } from 'stores/reducers/ModalReducer';\r\nimport Main from 'components/Layout';\r\nimport Layout from 'components/Layout/Layout';\r\nimport Badge from 'components/Badge';\r\nimport {\r\n  FEIBButton, FEIBTabContext, FEIBTabList, FEIBTab,\r\n} from 'components/elements';\r\nimport EmptyData from 'components/EmptyData';\r\nimport { currencySymbolGenerator } from 'utilities/Generator';\r\nimport { getThisMonth, getMonthList } from 'utilities/MonthGenerator';\r\n\r\nimport { getRewards } from './api';\r\nimport { RewardPageWrapper } from './C00700.style';\r\n\r\n/**\r\n * C00700_2 信用卡 回饋\r\n */\r\nconst C007002 = () => {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const [rewards, setRewards] = useState();\r\n  const [selectedMonth, setSelectedMonth] = useState(getThisMonth());\r\n\r\n  useEffect(async () => {\r\n    dispatch(setWaittingVisible(true));\r\n    // TODO getRewards API 尚未有回傳資料\r\n    const response = await getRewards();\r\n    setRewards(response.data);\r\n    dispatch(setWaittingVisible(false));\r\n  }, []);\r\n\r\n  const handleOnTabChange = (_, id) => {\r\n    setSelectedMonth(id);\r\n  };\r\n\r\n  const renderSelectedReward = () => {\r\n    if (!rewards) return null;\r\n    // TODO 不確定 getRewards 回傳的 period 是什麼格式，有測資時可能會出錯，後續需要修改\r\n    const foundReward = rewards.find((r) => r.period === selectedMonth);\r\n    return foundReward ? (\r\n      <>\r\n        <Badge\r\n          label={`${foundReward.date.slice(0, 4)}/${foundReward.date.slice(4, 6)} 回饋合計`}\r\n          value={currencySymbolGenerator('TWD', foundReward.amount + foundReward.communityAmount)}\r\n        />\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th className=\"w-3/4\">活動名稱</th>\r\n              <th className=\"w-1/4\">金額</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td>刷卡回饋</td>\r\n              <td>{currencySymbolGenerator('TWD', foundReward.amount)}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>社群圈分潤</td>\r\n              <td>{currencySymbolGenerator('TWD', foundReward.communityAmount)}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        <hr />\r\n        <div className=\"font-14 mb-6\">\r\n          實際回饋金額以帳單為準\r\n        </div>\r\n      </>\r\n    ) : (\r\n      <div style={{ height: '20rem', marginTop: '6rem' }}>\r\n        <EmptyData />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Layout title=\"每月現金回饋\" goBackFunc={() => history.goBack()}>\r\n      <Main>\r\n        <RewardPageWrapper>\r\n          <FEIBTabContext value={selectedMonth}>\r\n            <FEIBTabList $size=\"small\" $type=\"fixed\" onChange={handleOnTabChange}>\r\n              { getMonthList().map((m) => <FEIBTab key={uuid()} label={`${m.slice(4, 6)}月`} value={m} />)}\r\n            </FEIBTabList>\r\n          </FEIBTabContext>\r\n          {renderSelectedReward()}\r\n          <FEIBButton onClick={() => history.goBack()}>回信用卡首頁</FEIBButton>\r\n        </RewardPageWrapper>\r\n      </Main>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default C007002;\r\n"],"mappings":"+WAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,WAAW,KAAQ,aAAa,CACzC,MAAOC,KAAI,KAAM,YAAY,CAE7B,OAASC,kBAAkB,KAAQ,8BAA8B,CACjE,MAAOC,KAAI,KAAM,mBAAmB,CACpC,MAAOC,OAAM,KAAM,0BAA0B,CAC7C,MAAOC,MAAK,KAAM,kBAAkB,CACpC,OACEC,UAAU,CAAEC,cAAc,CAAEC,WAAW,CAAEC,OAAO,KAC3C,qBAAqB,CAC5B,MAAOC,UAAS,KAAM,sBAAsB,CAC5C,OAASC,uBAAuB,KAAQ,qBAAqB,CAC7D,OAASC,YAAY,CAAEC,YAAY,KAAQ,0BAA0B,CAErE,OAASC,UAAU,KAAQ,OAAO,CAClC,OAASC,iBAAiB,KAAQ,gBAAgB,CAElD;AACA;AACA,GAFA,6IAGA,GAAMC,QAAO,CAAG,QAAVA,QAAO,EAAS,CACpB,GAAMC,QAAO,CAAGlB,UAAU,EAAE,CAC5B,GAAMmB,SAAQ,CAAGlB,WAAW,EAAE,CAC9B,cAA8BH,QAAQ,EAAE,wCAAjCsB,OAAO,eAAEC,UAAU,eAC1B,eAA0CvB,QAAQ,CAACe,YAAY,EAAE,CAAC,yCAA3DS,aAAa,eAAEC,gBAAgB,eAEtCxB,SAAS,wEAAC,kJACRoB,QAAQ,CAAChB,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAClC;AAAA,sBACuBY,WAAU,EAAE,QAA7BS,QAAQ,eACdH,UAAU,CAACG,QAAQ,CAACC,IAAI,CAAC,CACzBN,QAAQ,CAAChB,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC,sDACrC,GAAE,EAAE,CAAC,CAEN,GAAMuB,kBAAiB,CAAG,QAApBA,kBAAiB,CAAIC,CAAC,CAAEC,EAAE,CAAK,CACnCL,gBAAgB,CAACK,EAAE,CAAC,CACtB,CAAC,CAED,GAAMC,qBAAoB,CAAG,QAAvBA,qBAAoB,EAAS,CACjC,GAAI,CAACT,OAAO,CAAE,MAAO,KAAI,CACzB;AACA,GAAMU,YAAW,CAAGV,OAAO,CAACW,IAAI,CAAC,SAACC,CAAC,QAAKA,EAAC,CAACC,MAAM,GAAKX,aAAa,GAAC,CACnE,MAAOQ,YAAW,cAChB,wCACE,KAAC,KAAK,EACJ,KAAK,WAAKA,WAAW,CAACI,IAAI,CAACC,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,aAAIL,WAAW,CAACI,IAAI,CAACC,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,6BAAQ,CAC9E,KAAK,CAAEvB,uBAAuB,CAAC,KAAK,CAAEkB,WAAW,CAACM,MAAM,CAAGN,WAAW,CAACO,eAAe,CAAE,EACxF,cACF,eAAO,SAAS,CAAC,OAAO,wBACtB,oCACE,mCACE,WAAI,SAAS,CAAC,OAAO,sCAAU,cAC/B,WAAI,SAAS,CAAC,OAAO,0BAAQ,GAC1B,EACC,cACR,sCACE,mCACE,gDAAa,cACb,oBAAKzB,uBAAuB,CAAC,KAAK,CAAEkB,WAAW,CAACM,MAAM,CAAC,EAAM,GAC1D,cACL,mCACE,sDAAc,cACd,oBAAKxB,uBAAuB,CAAC,KAAK,CAAEkB,WAAW,CAACO,eAAe,CAAC,EAAM,GACnE,GACC,GACF,cACR,aAAM,cACN,YAAK,SAAS,CAAC,cAAc,gFAEvB,GACL,cAEH,YAAK,KAAK,CAAE,CAAEC,MAAM,CAAE,OAAO,CAAEC,SAAS,CAAE,MAAO,CAAE,uBACjD,KAAC,SAAS,IAAG,EAEhB,CACH,CAAC,CAED,mBACE,KAAC,MAAM,EAAC,KAAK,CAAC,sCAAQ,CAAC,UAAU,CAAE,4BAAMrB,QAAO,CAACsB,MAAM,EAAE,EAAC,uBACxD,KAAC,IAAI,wBACH,MAAC,iBAAiB,yBAChB,KAAC,cAAc,EAAC,KAAK,CAAElB,aAAc,uBACnC,KAAC,WAAW,EAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAEI,iBAAkB,UACjEZ,YAAY,EAAE,CAAC2B,GAAG,CAAC,SAACC,CAAC,qBAAK,KAAC,OAAO,EAAc,KAAK,WAAKA,CAAC,CAACP,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,UAAI,CAAC,KAAK,CAAEO,CAAE,EAA7CxC,IAAI,EAAE,CAA0C,GAAC,EAC/E,EACC,CAChB2B,oBAAoB,EAAE,cACvB,KAAC,UAAU,EAAC,OAAO,CAAE,yBAAMX,QAAO,CAACsB,MAAM,EAAE,EAAC,kDAAoB,GAC9C,EACf,EACA,CAEb,CAAC,CAED,cAAevB,QAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}