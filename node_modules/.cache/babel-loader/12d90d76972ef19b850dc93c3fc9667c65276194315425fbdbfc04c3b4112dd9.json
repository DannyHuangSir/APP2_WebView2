{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import uuid from'react-uuid';import{callAPI}from'utilities/axios';import e2ee from'utilities/E2ee';export var login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){var payload,loginRs,response,result,errCode,message,relogin;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:payload={txnId:\"WVIEW_\".concat(uuid()),custId:data.identity.toUpperCase(),username:e2ee(data.account),password:e2ee(data.password),rsaPubK:sessionStorage.getItem('publicKey'),isRepeat:!!data.isRepeat};_context.next=3;return callAPI('/smJwe/v1/login',payload);case 3:loginRs=_context.sent;if(!(loginRs.code==='0000')){_context.next=21;break;}response=loginRs.data;result=response.result,errCode=response.errCode,message=response.message;if(!(result===true)){_context.next=9;break;}return _context.abrupt(\"return\",true);case 9:if(!(errCode==='E004')){_context.next=18;break;}if(!window.confirm(message)){_context.next=15;break;}relogin=_objectSpread(_objectSpread({},data),{},{isRepeat:true,isgToken:response.isgToken});_context.next=14;return login(relogin);case 14:return _context.abrupt(\"return\",_context.sent);case 15:alert('已取消登入');_context.next=19;break;case 18:alert(message);case 19:_context.next=22;break;case 21:alert(loginRs.message);case 22:return _context.abrupt(\"return\",false);case 23:case\"end\":return _context.stop();}}},_callee);}));return function login(_x){return _ref.apply(this,arguments);};}();export var personalDataPreload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(request){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return callAPI('/auth/preload',request);case 2:response=_context2.sent;return _context2.abrupt(\"return\",response);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function personalDataPreload(_x2){return _ref2.apply(this,arguments);};}();export var getInitData=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return callAPI('/smApi/v1/getInitData');case 2:response=_context3.sent;return _context3.abrupt(\"return\",response);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function getInitData(){return _ref3.apply(this,arguments);};}();export var getAnnouncementData=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return callAPI('/smApi/v1/getAnnouncementData');case 2:response=_context4.sent;return _context4.abrupt(\"return\",response);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function getAnnouncementData(){return _ref4.apply(this,arguments);};}();export var getHomeData=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var response;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return callAPI('/smApi/v1/getHomeData');case 2:response=_context5.sent;return _context5.abrupt(\"return\",response);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function getHomeData(){return _ref5.apply(this,arguments);};}();","map":{"version":3,"names":["uuid","callAPI","e2ee","login","data","payload","txnId","custId","identity","toUpperCase","username","account","password","rsaPubK","sessionStorage","getItem","isRepeat","loginRs","code","response","result","errCode","message","window","confirm","relogin","isgToken","alert","personalDataPreload","request","getInitData","getAnnouncementData","getHomeData"],"sources":["C:/Users/allen/git/app2-webview/src/proto/Login/login.api.js"],"sourcesContent":["import uuid from 'react-uuid';\r\nimport { callAPI } from 'utilities/axios';\r\nimport e2ee from 'utilities/E2ee';\r\n\r\nexport const login = async (data) => {\r\n  const payload = {\r\n    txnId: `WVIEW_${uuid()}`,\r\n    custId: data.identity.toUpperCase(),\r\n    username: e2ee(data.account),\r\n    password: e2ee(data.password),\r\n    rsaPubK: sessionStorage.getItem('publicKey'),\r\n    isRepeat: !!data.isRepeat,\r\n  };\r\n  const loginRs = await callAPI('/smJwe/v1/login', payload);\r\n  if (loginRs.code === '0000') {\r\n    const response = loginRs.data;\r\n    const { result, errCode, message } = response;\r\n\r\n    if (result === true) return true;\r\n\r\n    if (errCode === 'E004') {\r\n      if (window.confirm(message)) {\r\n        const relogin = {\r\n          ...data,\r\n          isRepeat: true,\r\n          isgToken: response.isgToken,\r\n        };\r\n        return await login(relogin);\r\n      }\r\n\r\n      alert('已取消登入');\r\n    } else alert(message);\r\n  } else alert(loginRs.message);\r\n\r\n  return false;\r\n};\r\n\r\nexport const personalDataPreload = async (request) => {\r\n  const response = await callAPI('/auth/preload', request);\r\n  return response;\r\n};\r\n\r\nexport const getInitData = async () => {\r\n  const response = await callAPI('/smApi/v1/getInitData');\r\n  return response;\r\n};\r\n\r\nexport const getAnnouncementData = async () => {\r\n  const response = await callAPI('/smApi/v1/getAnnouncementData');\r\n  return response;\r\n};\r\n\r\nexport const getHomeData = async () => {\r\n  const response = await callAPI('/smApi/v1/getHomeData');\r\n  return response;\r\n};\r\n"],"mappings":"8WAAA,MAAOA,KAAI,KAAM,YAAY,CAC7B,OAASC,OAAO,KAAQ,iBAAiB,CACzC,MAAOC,KAAI,KAAM,gBAAgB,CAEjC,MAAO,IAAMC,MAAK,4FAAG,iBAAOC,IAAI,gLACxBC,OAAO,CAAG,CACdC,KAAK,iBAAWN,IAAI,EAAE,CAAE,CACxBO,MAAM,CAAEH,IAAI,CAACI,QAAQ,CAACC,WAAW,EAAE,CACnCC,QAAQ,CAAER,IAAI,CAACE,IAAI,CAACO,OAAO,CAAC,CAC5BC,QAAQ,CAAEV,IAAI,CAACE,IAAI,CAACQ,QAAQ,CAAC,CAC7BC,OAAO,CAAEC,cAAc,CAACC,OAAO,CAAC,WAAW,CAAC,CAC5CC,QAAQ,CAAE,CAAC,CAACZ,IAAI,CAACY,QACnB,CAAC,uBACqBf,QAAO,CAAC,iBAAiB,CAAEI,OAAO,CAAC,QAAnDY,OAAO,oBACTA,OAAO,CAACC,IAAI,GAAK,MAAM,2BACnBC,QAAQ,CAAGF,OAAO,CAACb,IAAI,CACrBgB,MAAM,CAAuBD,QAAQ,CAArCC,MAAM,CAAEC,OAAO,CAAcF,QAAQ,CAA7BE,OAAO,CAAEC,OAAO,CAAKH,QAAQ,CAApBG,OAAO,MAE5BF,MAAM,GAAK,IAAI,0DAAS,IAAI,cAE5BC,OAAO,GAAK,MAAM,+BAChBE,MAAM,CAACC,OAAO,CAACF,OAAO,CAAC,0BACnBG,OAAO,gCACRrB,IAAI,MACPY,QAAQ,CAAE,IAAI,CACdU,QAAQ,CAAEP,QAAQ,CAACO,QAAQ,0BAEhBvB,MAAK,CAACsB,OAAO,CAAC,gEAG7BE,KAAK,CAAC,OAAO,CAAC,CAAC,+BACVA,KAAK,CAACL,OAAO,CAAC,CAAC,uCACjBK,KAAK,CAACV,OAAO,CAACK,OAAO,CAAC,CAAC,wCAEvB,KAAK,yDACb,kBA/BYnB,MAAK,4CA+BjB,CAED,MAAO,IAAMyB,oBAAmB,6FAAG,kBAAOC,OAAO,4JACxB5B,QAAO,CAAC,eAAe,CAAE4B,OAAO,CAAC,QAAlDV,QAAQ,iDACPA,QAAQ,0DAChB,kBAHYS,oBAAmB,8CAG/B,CAED,MAAO,IAAME,YAAW,6FAAG,8KACF7B,QAAO,CAAC,uBAAuB,CAAC,QAAjDkB,QAAQ,iDACPA,QAAQ,0DAChB,kBAHYW,YAAW,2CAGvB,CAED,MAAO,IAAMC,oBAAmB,6FAAG,8KACV9B,QAAO,CAAC,+BAA+B,CAAC,QAAzDkB,QAAQ,iDACPA,QAAQ,0DAChB,kBAHYY,oBAAmB,2CAG/B,CAED,MAAO,IAAMC,YAAW,6FAAG,8KACF/B,QAAO,CAAC,uBAAuB,CAAC,QAAjDkB,QAAQ,iDACPA,QAAQ,0DAChB,kBAHYa,YAAW,2CAGvB"},"metadata":{},"sourceType":"module","externalDependencies":[]}