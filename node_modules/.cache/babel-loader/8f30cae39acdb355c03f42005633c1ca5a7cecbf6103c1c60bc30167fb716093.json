{"ast":null,"code":"import _objectSpread from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable no-use-before-define */ /* eslint-disable object-curly-newline */import{useEffect,useReducer,useState}from'react';import{useDispatch}from'react-redux';import{useForm}from'react-hook-form';/* Elements */import Layout from'components/Layout/Layout';import AccountOverview from'components/AccountOverview/AccountOverview';import DepositDetailPanel from'components/DepositDetailPanel/depositDetailPanel';import{FEIBInputLabel,FEIBInput}from'components/elements';/* Reducers & JS functions */import{setWaittingVisible}from'stores/reducers/ModalReducer';import{customPopup,showPrompt}from'utilities/MessageModal';import{loadFuncParams,startFunc,closeFunc}from'utilities/AppScriptProxy';import{switchZhNumber,currencySymbolGenerator}from'utilities/Generator';import{getAccountsList,getAccountBonus,updateAccount}from'utilities/CacheData';import{FuncID}from'utilities/FuncID';import{ArrowNextIcon,SwitchIcon}from'assets/images/icons';import{getTransactions,downloadDepositBookCover,setAccountAlias}from'./api';import PageWrapper from'./C00300.style';/**\r\n * C00300 台幣帳戶首頁\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var C00300=function C00300(){var dispatch=useDispatch();var _useReducer=useReducer(function(x){return x+1;},0),_useReducer2=_slicedToArray(_useReducer,2),forceUpdate=_useReducer2[1];var _useForm=useForm(),register=_useForm.register,unregister=_useForm.unregister,handleSubmit=_useForm.handleSubmit;var _useState=useState(),_useState2=_slicedToArray(_useState,2),accounts=_useState2[0],setAccounts=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),selectedAccountIdx=_useState4[0],setSelectedAccountIdx=_useState4[1];var selectedAccount=accounts?accounts[selectedAccountIdx!==null&&selectedAccountIdx!==void 0?selectedAccountIdx:0]:null;// 優存(利率/利息)資訊 顯示模式（true.優惠利率, false.累積利息)\nvar _useState5=useState(),_useState6=_slicedToArray(_useState5,2),showRate=_useState6[0],setShowRate=_useState6[1];/**\r\n   * 頁面啟動，初始化\r\n   */useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(setWaittingVisible(true));// 取得帳號基本資料，不含跨轉優惠次數，且餘額「非即時」。\n// NOTE 使用非同步方式更新畫面，一開始會先顯示帳戶基本資料，待取得跨轉等資訊時再更新一次畫面。\ngetAccountsList('MC',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(items){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(items.length===0)){_context.next=5;break;}_context.next=3;return showPrompt('您還沒有任何台幣存款帳戶，請在系統關閉此功能後，立即申請。',function(){return closeFunc();});case 3:_context.next=9;break;case 5:setAccounts(items);_context.next=8;return processStartParams(items);case 8:dispatch(setWaittingVisible(false));case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());case 2:case\"end\":return _context2.stop();}}},_callee2);})),[]);/**\r\n   * 處理 Function Controller 提供的啟動參數。\r\n   * @param {[*]} accts\r\n   */var processStartParams=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(accts){var startParams,index;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return loadFuncParams();case 2:startParams=_context3.sent;// 取得 Function Controller 提供的 keepData(model)\nif(startParams&&startParams instanceof Object){index=accts.findIndex(function(acc){return acc.accountNo===startParams.defaultAccount;});setSelectedAccountIdx(index);setShowRate(startParams.showRate);}else{setSelectedAccountIdx(0);setShowRate(true);}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function processStartParams(_x2){return _ref3.apply(this,arguments);};}();/**\r\n   * 更新帳戶交易明細清單。\r\n   * @returns 需有傳回明細清單供顯示。\r\n   */var loadTransactions=function loadTransactions(account){var txnDetails=account.txnDetails;if(!account.isLoadingTxn){account.isLoadingTxn=true;// 避免因為非同步執行造成的重覆下載\nif(!txnDetails){// 取得帳戶交易明細（三年內的前25筆即可）\ngetTransactions(account.accountNo).then(function(transData){var details=transData.acctTxDtls.slice(0,10);// 最多只需保留 10筆。\naccount.txnDetails=details;// 更新餘額。\nif(transData.length>0)account.balance=details[0].balance;delete account.isLoadingTxn;// 載入完成才能清掉旗標！\nforceUpdate();});}}return txnDetails;};/**\r\n   * 下載 優存(利率/利息)資訊\r\n   */var loadExtraInfo=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(account){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!account.bonus||!account.bonus.loading){account.bonus={loading:true};getAccountBonus(account.accountNo,function(info){account.bonus=info;forceUpdate();delete account.bonus.loading;});}case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function loadExtraInfo(_x3){return _ref4.apply(this,arguments);};}();/**\r\n   * 顯示 優存(利率/利息)資訊\r\n   */var renderBonusInfoPanel=function renderBonusInfoPanel(){if(!selectedAccount)return null;var bonus=selectedAccount.bonus;if(!bonus)loadExtraInfo(selectedAccount);// 下載 優存(利率/利息)資訊\nvar _ref5=bonus!==null&&bonus!==void 0?bonus:{freeWithdrawRemain:null,freeTransferRemain:null,bonusQuota:null,bonusRate:null,interest:null// 預設值\n},freeWithdrawRemain=_ref5.freeWithdrawRemain,freeTransferRemain=_ref5.freeTransferRemain,bonusQuota=_ref5.bonusQuota,bonusRate=_ref5.bonusRate,interest=_ref5.interest;var value1=bonusRate?\"\".concat(bonusRate*100,\"%\"):'-';var value2=interest>0?\"\".concat(currencySymbolGenerator('TWD',interest)):'0';return/*#__PURE__*/_jsxs(\"div\",{className:\"interestRatePanel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panelItem\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u514D\\u8CBB\\u8DE8\\u63D0/\\u8F49\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\".concat(freeWithdrawRemain!==null&&freeWithdrawRemain!==void 0?freeWithdrawRemain:'-',\"/\").concat(freeTransferRemain!==null&&freeTransferRemain!==void 0?freeTransferRemain:'-')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panelItem\",onClick:function onClick(){return setShowRate(!showRate);},children:[/*#__PURE__*/_jsxs(\"h3\",{children:[showRate?'優惠利率':'累積利息',/*#__PURE__*/_jsx(SwitchIcon,{className:\"switchIcon\"})]}),/*#__PURE__*/_jsx(\"p\",{children:showRate?value1:value2})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panelItem\",onClick:function onClick(){return handleFunctionClick('depositPlus');},children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\u512A\\u60E0\\u5229\\u7387\\u984D\\u5EA6\",/*#__PURE__*/_jsx(ArrowNextIcon,{})]}),/*#__PURE__*/_jsx(\"p\",{children:switchZhNumber(bonusQuota,false)})]})]});};/**\r\n   * 編輯帳戶名稱\r\n   * @param {*} name 原始帳戶名稱\r\n   */var showRenameDialog=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(name){var body,onOk;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:// Note: 因為這個 Dialog 是動態產生的，所以一定要刪掉註冊的元件。\n//       否則，下次註冊將失效，而且持續傳回最後一次的輪入值，而不會改變。\nunregister('newName',{keepDirty:false});body=/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FEIBInputLabel,{children:\"\\u65B0\\u7684\\u5E33\\u6236\\u540D\\u7A31\"}),/*#__PURE__*/_jsx(FEIBInput,_objectSpread(_objectSpread({},register('newName')),{},{autoFocus:true,inputProps:{maxLength:10,placeholder:'請設定此帳戶的專屬名稱',defaultValue:name,autoComplete:'off'}}))]});onOk=function onOk(values){selectedAccount.alias=values.newName;// 變更卡片上的帳戶名稱\nsetAccountAlias(selectedAccount.accountNo,selectedAccount.alias);forceUpdate();// NOTE 明細資料不需要存入Cache，下次進入C00300時才會更新。\nvar newAccount=_objectSpread({},selectedAccount);delete newAccount.isLoadingTxn;delete newAccount.txnDetails;updateAccount(newAccount);};_context5.next=5;return customPopup('帳戶名稱編輯',body,handleSubmit(onOk));case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function showRenameDialog(_x4){return _ref6.apply(this,arguments);};}();/**\r\n   * 執行指定的單元功能。\r\n   * @param {*} funcCode 功能代碼\r\n   */var handleFunctionClick=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(funcCode){var params,keepData;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:params=null;keepData={defaultAccount:selectedAccount.accountNo,showRate:showRate};_context6.t0=funcCode;_context6.next=_context6.t0==='moreTranscations'?5:_context6.t0===FuncID.D00100_台幣轉帳?7:_context6.t0==='D00300'?9:_context6.t0===FuncID.E00100_換匯?11:_context6.t0==='DownloadCover'?13:_context6.t0==='Rename'?15:_context6.t0==='depositPlus'?17:17;break;case 5:// 更多明細\nparams=_objectSpread(_objectSpread({},selectedAccount),{},{// 直接提供帳戶摘要資訊就不用再下載。\ncardColor:'purple'});return _context6.abrupt(\"break\",18);case 7:params={transOut:selectedAccount.accountNo};return _context6.abrupt(\"break\",18);case 9:// 無卡提款，只有母帳號才可以使用。 // TODO 帶參數過去\nparams={transOut:selectedAccount.accountNo};return _context6.abrupt(\"break\",18);case 11:// TODO 帶參數過去\nparams={transOut:selectedAccount.accountNo};return _context6.abrupt(\"break\",18);case 13:// 存摺封面下載\ndownloadDepositBookCover(selectedAccount.accountNo);// 預設檔名為「帳號-日期.pdf」，密碼：身分證號碼\nreturn _context6.abrupt(\"return\");case 15:// 帳戶名稱編輯\nshowRenameDialog(selectedAccount.alias);return _context6.abrupt(\"return\");case 17:return _context6.abrupt(\"break\",18);case 18:startFunc(funcCode,params,keepData);case 19:case\"end\":return _context6.stop();}}},_callee6);}));return function handleFunctionClick(_x5){return _ref7.apply(this,arguments);};}();/**\r\n   * 頁面輸出\r\n   */return/*#__PURE__*/_jsx(Layout,{title:\"\\u53F0\\u5E63\\u6D3B\\u5B58\",children:/*#__PURE__*/_jsx(PageWrapper,{small:true,children:selectedAccount?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AccountOverview,{accounts:accounts,defaultSlide:selectedAccountIdx,onAccountChanged:setSelectedAccountIdx,onFunctionClick:handleFunctionClick,cardColor:\"purple\",funcList:[{fid:FuncID.D00100_台幣轉帳,title:'轉帳'},{fid:'D00300',title:'無卡提款',hidden:selectedAccount.acctType!=='M'}],moreFuncs:[// { fid: null, title: '定存', icon: 'fixedDeposit', enabled: false }, // TODO: 此階段隱藏\n{fid:FuncID.E00100_換匯,title:'換匯',icon:'exchange',enabled:selectedAccount.balance>0},{fid:'DownloadCover',title:'存摺封面下載',icon:'coverDownload'},{fid:'Rename',title:'帳戶名稱編輯',icon:'edit'}]}),renderBonusInfoPanel(),/*#__PURE__*/_jsx(DepositDetailPanel,{details:loadTransactions(selectedAccount),onMoreFuncClick:function onMoreFuncClick(){return handleFunctionClick('moreTranscations');}})]}):null})});};export default C00300;","map":{"version":3,"names":["useEffect","useReducer","useState","useDispatch","useForm","Layout","AccountOverview","DepositDetailPanel","FEIBInputLabel","FEIBInput","setWaittingVisible","customPopup","showPrompt","loadFuncParams","startFunc","closeFunc","switchZhNumber","currencySymbolGenerator","getAccountsList","getAccountBonus","updateAccount","FuncID","ArrowNextIcon","SwitchIcon","getTransactions","downloadDepositBookCover","setAccountAlias","PageWrapper","C00300","dispatch","x","forceUpdate","register","unregister","handleSubmit","accounts","setAccounts","selectedAccountIdx","setSelectedAccountIdx","selectedAccount","showRate","setShowRate","items","length","processStartParams","accts","startParams","Object","index","findIndex","acc","accountNo","defaultAccount","loadTransactions","account","txnDetails","isLoadingTxn","then","transData","details","acctTxDtls","slice","balance","loadExtraInfo","bonus","loading","info","renderBonusInfoPanel","freeWithdrawRemain","freeTransferRemain","bonusQuota","bonusRate","interest","value1","value2","handleFunctionClick","showRenameDialog","name","keepDirty","body","maxLength","placeholder","defaultValue","autoComplete","onOk","values","alias","newName","newAccount","funcCode","params","keepData","D00100_台幣轉帳","E00100_換匯","cardColor","transOut","fid","title","hidden","acctType","icon","enabled"],"sources":["C:/Users/allen/git/app2-webview/src/pages/C00300_NtdDeposit/C00300.js"],"sourcesContent":["/* eslint-disable no-use-before-define */\r\n/* eslint-disable object-curly-newline */\r\nimport { useEffect, useReducer, useState } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useForm } from 'react-hook-form';\r\n\r\n/* Elements */\r\nimport Layout from 'components/Layout/Layout';\r\nimport AccountOverview from 'components/AccountOverview/AccountOverview';\r\nimport DepositDetailPanel from 'components/DepositDetailPanel/depositDetailPanel';\r\nimport { FEIBInputLabel, FEIBInput } from 'components/elements';\r\n\r\n/* Reducers & JS functions */\r\nimport { setWaittingVisible } from 'stores/reducers/ModalReducer';\r\nimport { customPopup, showPrompt } from 'utilities/MessageModal';\r\nimport { loadFuncParams, startFunc, closeFunc } from 'utilities/AppScriptProxy';\r\nimport { switchZhNumber, currencySymbolGenerator } from 'utilities/Generator';\r\nimport { getAccountsList, getAccountBonus, updateAccount } from 'utilities/CacheData';\r\nimport { FuncID } from 'utilities/FuncID';\r\nimport { ArrowNextIcon, SwitchIcon } from 'assets/images/icons';\r\nimport {\r\n  getTransactions,\r\n  downloadDepositBookCover,\r\n  setAccountAlias,\r\n} from './api';\r\nimport PageWrapper from './C00300.style';\r\n\r\n/**\r\n * C00300 台幣帳戶首頁\r\n */\r\nconst C00300 = () => {\r\n  const dispatch = useDispatch();\r\n  const [, forceUpdate] = useReducer((x) => x + 1, 0);\r\n\r\n  const { register, unregister, handleSubmit } = useForm();\r\n\r\n  const [accounts, setAccounts] = useState();\r\n  const [selectedAccountIdx, setSelectedAccountIdx] = useState();\r\n\r\n  const selectedAccount = accounts ? accounts[selectedAccountIdx ?? 0] : null;\r\n\r\n  // 優存(利率/利息)資訊 顯示模式（true.優惠利率, false.累積利息)\r\n  const [showRate, setShowRate] = useState();\r\n\r\n  /**\r\n   * 頁面啟動，初始化\r\n   */\r\n  useEffect(async () => {\r\n    dispatch(setWaittingVisible(true));\r\n\r\n    // 取得帳號基本資料，不含跨轉優惠次數，且餘額「非即時」。\r\n    // NOTE 使用非同步方式更新畫面，一開始會先顯示帳戶基本資料，待取得跨轉等資訊時再更新一次畫面。\r\n    getAccountsList('MC', async (items) => { // M=台幣主帳戶、C=台幣子帳戶\r\n      if (items.length === 0) {\r\n        await showPrompt('您還沒有任何台幣存款帳戶，請在系統關閉此功能後，立即申請。', () => closeFunc());\r\n      } else {\r\n        setAccounts(items);\r\n        await processStartParams(items);\r\n        dispatch(setWaittingVisible(false));\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  /**\r\n   * 處理 Function Controller 提供的啟動參數。\r\n   * @param {[*]} accts\r\n   */\r\n  const processStartParams = async (accts) => {\r\n    // startParams: {\r\n    //   defaultAccount: 預設帳號\r\n    //   showRate: 優存(利率/利息)資訊 顯示模式\r\n    // }\r\n    const startParams = await loadFuncParams();\r\n    // 取得 Function Controller 提供的 keepData(model)\r\n    if (startParams && (startParams instanceof Object)) {\r\n      const index = accts.findIndex((acc) => acc.accountNo === startParams.defaultAccount);\r\n      setSelectedAccountIdx(index);\r\n      setShowRate(startParams.showRate);\r\n    } else {\r\n      setSelectedAccountIdx(0);\r\n      setShowRate(true);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * 更新帳戶交易明細清單。\r\n   * @returns 需有傳回明細清單供顯示。\r\n   */\r\n  const loadTransactions = (account) => {\r\n    const { txnDetails } = account;\r\n    if (!account.isLoadingTxn) {\r\n      account.isLoadingTxn = true; // 避免因為非同步執行造成的重覆下載\r\n      if (!txnDetails) {\r\n        // 取得帳戶交易明細（三年內的前25筆即可）\r\n        getTransactions(account.accountNo).then((transData) => {\r\n          const details = transData.acctTxDtls.slice(0, 10); // 最多只需保留 10筆。\r\n          account.txnDetails = details;\r\n\r\n          // 更新餘額。\r\n          if (transData.length > 0) account.balance = details[0].balance;\r\n\r\n          delete account.isLoadingTxn; // 載入完成才能清掉旗標！\r\n          forceUpdate();\r\n        });\r\n      }\r\n    }\r\n    return txnDetails;\r\n  };\r\n\r\n  /**\r\n   * 下載 優存(利率/利息)資訊\r\n   */\r\n  const loadExtraInfo = async (account) => {\r\n    if (!account.bonus || !account.bonus.loading) {\r\n      account.bonus = { loading: true };\r\n      getAccountBonus(account.accountNo, (info) => {\r\n        account.bonus = info;\r\n        forceUpdate();\r\n        delete account.bonus.loading;\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * 顯示 優存(利率/利息)資訊\r\n   */\r\n  const renderBonusInfoPanel = () => {\r\n    if (!selectedAccount) return null;\r\n\r\n    const { bonus } = selectedAccount;\r\n    if (!bonus) loadExtraInfo(selectedAccount); // 下載 優存(利率/利息)資訊\r\n\r\n    const { freeWithdrawRemain, freeTransferRemain, bonusQuota, bonusRate, interest } = bonus ?? {\r\n      freeWithdrawRemain: null, freeTransferRemain: null, bonusQuota: null, bonusRate: null, interest: null, // 預設值\r\n    };\r\n    const value1 = bonusRate ? `${bonusRate * 100}%` : '-';\r\n    const value2 = (interest > 0) ? `${currencySymbolGenerator('TWD', interest)}` : '0';\r\n    return (\r\n      <div className=\"interestRatePanel\">\r\n        <div className=\"panelItem\">\r\n          <h3>免費跨提/轉</h3>\r\n          <p>{`${freeWithdrawRemain ?? '-'}/${freeTransferRemain ?? '-'}`}</p>\r\n        </div>\r\n        <div className=\"panelItem\" onClick={() => setShowRate(!showRate)}>\r\n          <h3>\r\n            {showRate ? '優惠利率' : '累積利息'}\r\n            <SwitchIcon className=\"switchIcon\" />\r\n          </h3>\r\n          <p>{showRate ? value1 : value2 }</p>\r\n        </div>\r\n\r\n        {/* 用 startFunc 執行 depositPlus ，將 model 存入 keepData 返回時就不用再重 Load */}\r\n        <div className=\"panelItem\" onClick={() => handleFunctionClick('depositPlus')}>\r\n          <h3>\r\n            優惠利率額度\r\n            <ArrowNextIcon />\r\n          </h3>\r\n          <p>{switchZhNumber(bonusQuota, false)}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  /**\r\n   * 編輯帳戶名稱\r\n   * @param {*} name 原始帳戶名稱\r\n   */\r\n  const showRenameDialog = async (name) => {\r\n    // Note: 因為這個 Dialog 是動態產生的，所以一定要刪掉註冊的元件。\r\n    //       否則，下次註冊將失效，而且持續傳回最後一次的輪入值，而不會改變。\r\n    unregister('newName', { keepDirty: false });\r\n\r\n    const body = (\r\n      <>\r\n        <FEIBInputLabel>新的帳戶名稱</FEIBInputLabel>\r\n        <FEIBInput\r\n          {...register('newName')}\r\n          autoFocus\r\n          inputProps={{ maxLength: 10, placeholder: '請設定此帳戶的專屬名稱', defaultValue: name, autoComplete: 'off' }}\r\n        />\r\n      </>\r\n    );\r\n    const onOk = (values) => {\r\n      selectedAccount.alias = values.newName; // 變更卡片上的帳戶名稱\r\n      setAccountAlias(selectedAccount.accountNo, selectedAccount.alias);\r\n      forceUpdate();\r\n\r\n      // NOTE 明細資料不需要存入Cache，下次進入C00300時才會更新。\r\n      const newAccount = {...selectedAccount};\r\n      delete newAccount.isLoadingTxn;\r\n      delete newAccount.txnDetails;\r\n      updateAccount(newAccount);\r\n    };\r\n    await customPopup('帳戶名稱編輯', body, handleSubmit(onOk));\r\n  };\r\n\r\n  /**\r\n   * 執行指定的單元功能。\r\n   * @param {*} funcCode 功能代碼\r\n   */\r\n  const handleFunctionClick = async (funcCode) => {\r\n    let params = null;\r\n\r\n    const keepData = { defaultAccount: selectedAccount.accountNo, showRate };\r\n    switch (funcCode) {\r\n      case 'moreTranscations': // 更多明細\r\n        params = {\r\n          ...selectedAccount, // 直接提供帳戶摘要資訊就不用再下載。\r\n          cardColor: 'purple',\r\n        };\r\n        break;\r\n\r\n      case FuncID.D00100_台幣轉帳:\r\n        params = { transOut: selectedAccount.accountNo };\r\n        break;\r\n\r\n      case 'D00300': // 無卡提款，只有母帳號才可以使用。 // TODO 帶參數過去\r\n        params = { transOut: selectedAccount.accountNo };\r\n        break;\r\n\r\n      case FuncID.E00100_換匯: // TODO 帶參數過去\r\n        params = { transOut: selectedAccount.accountNo };\r\n        break;\r\n\r\n      case 'DownloadCover': // 存摺封面下載\r\n        downloadDepositBookCover(selectedAccount.accountNo); // 預設檔名為「帳號-日期.pdf」，密碼：身分證號碼\r\n        return;\r\n\r\n      case 'Rename': // 帳戶名稱編輯\r\n        showRenameDialog(selectedAccount.alias);\r\n        return;\r\n\r\n      case 'depositPlus':\r\n      default:\r\n        break;\r\n    }\r\n\r\n    startFunc(funcCode, params, keepData);\r\n  };\r\n\r\n  /**\r\n   * 頁面輸出\r\n   */\r\n  return (\r\n    <Layout title=\"台幣活存\">\r\n      <PageWrapper small>\r\n        {selectedAccount\r\n          ? (\r\n            <>\r\n              <AccountOverview\r\n                accounts={accounts}\r\n                defaultSlide={selectedAccountIdx}\r\n                onAccountChanged={setSelectedAccountIdx}\r\n                onFunctionClick={handleFunctionClick}\r\n                cardColor=\"purple\"\r\n                funcList={[\r\n                  { fid: FuncID.D00100_台幣轉帳, title: '轉帳' },\r\n                  { fid: 'D00300', title: '無卡提款', hidden: (selectedAccount.acctType !== 'M') },\r\n                ]}\r\n                moreFuncs={[\r\n                  // { fid: null, title: '定存', icon: 'fixedDeposit', enabled: false }, // TODO: 此階段隱藏\r\n                  { fid: FuncID.E00100_換匯, title: '換匯', icon: 'exchange', enabled: (selectedAccount.balance > 0) },\r\n                  { fid: 'DownloadCover', title: '存摺封面下載', icon: 'coverDownload' },\r\n                  { fid: 'Rename', title: '帳戶名稱編輯', icon: 'edit' },\r\n                ]}\r\n              />\r\n\r\n              {/* 顯示 優惠利率資訊面版 */}\r\n              { renderBonusInfoPanel() }\r\n\r\n              <DepositDetailPanel\r\n                details={loadTransactions(selectedAccount)}\r\n                onMoreFuncClick={() => handleFunctionClick('moreTranscations')}\r\n              />\r\n            </>\r\n          ) : null}\r\n      </PageWrapper>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default C00300;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}