{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from'react';import{useDispatch}from'react-redux';import{accountFormatter,currencySymbolGenerator}from'utilities/Generator';/* Elements */import Layout from'components/Layout/Layout';import Accordion from'components/Accordion';import BottomAction from'components/BottomAction';import InformationList from'components/InformationList';import SnackModal from'components/SnackModal';import theme from'themes/theme';import SuccessFailureAnimations from'components/SuccessFailureAnimations';import{CameraIcon}from'assets/images/icons';import{CameraAltOutlined,ShareOutlined}from'@material-ui/icons';import{setWaittingVisible}from'stores/reducers/ModalReducer';/* Styles */import ForeignCurrencyTransferWrapper from'./foreignCurrencyTransfer.style';import{executeTransfer}from'./api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ForeignCurrencyTransfer2=function ForeignCurrencyTransfer2(_ref){var _model$transOut;var location=_ref.location;var dispatch=useDispatch();var _useState=useState(location.state),_useState2=_slicedToArray(_useState,2),model=_useState2[0],setModel=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),transferResult=_useState4[0],setTransferResult=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),showSnapshotSuccess=_useState6[0],setShowSnapshotSuccess=_useState6[1];/**\r\n   * 頁面初始化\r\n   */useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result,isSuccess;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setWaittingVisible(true));_context.next=3;return executeTransfer();case 3:result=_context.sent;isSuccess=(result===null||result===void 0?void 0:result.code)==='0000';// Debug 假設！\n_context.next=7;return setTransferResult({isSuccess:isSuccess,errorCode:result===null||result===void 0?void 0:result.code,message:result===null||result===void 0?void 0:result.message// 錯誤訊息\n});case 7:console.log('==> 轉帳執行結果：',result);console.log('==> transferResult：',transferResult);if(isSuccess){console.log('==> isSuccess：',isSuccess);setModel(function(prevModel){var updatedBalance=result.acctBalance;return _objectSpread(_objectSpread({},prevModel),{},{transOut:_objectSpread(_objectSpread({},prevModel.transOut),{},{balance:updatedBalance})});});}console.log('==> model：',model);case 11:case\"end\":return _context.stop();}}},_callee);})),[]);/**\r\n   * 初始化完成，關閉等待中狀態。\r\n   */useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log('==> (66)transferResult：',transferResult);if(transferResult)dispatch(setWaittingVisible(false));case 2:case\"end\":return _context2.stop();}}},_callee2);})),[transferResult]);var handleClickScreenshot=function handleClickScreenshot(){// TODO 透過原生功能進行截圖。\nsetShowSnapshotSuccess(true);setTimeout(function(){return setShowSnapshotSuccess(false);},1000);// 1 秒後自動關閉。\n};return/*#__PURE__*/_jsx(Layout,{title:\"\\u5916\\u5E63\\u8F49\\u5E33\\u7D50\\u679C\",children:/*#__PURE__*/_jsxs(ForeignCurrencyTransferWrapper,{className:transferResult.isSuccess?'confirmAndResult':'confirmAndResult fail',children:[/*#__PURE__*/_jsx(SuccessFailureAnimations,{isSuccess:transferResult.isSuccess,successTitle:\"\\u8F49\\u5E33\\u6210\\u529F\",errorTitle:\"\\u8F49\\u5E33\\u5931\\u6557\"}),transferResult.isSuccess&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"confrimDataContainer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dataLabel\",children:\"\\u8F49\\u51FA\\u91D1\\u984D\\u8207\\u8F49\\u5165\\u5E33\\u865F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"balance\",children:[currencySymbolGenerator(model===null||model===void 0?void 0:model.inCcyCd),model===null||model===void 0?void 0:model.inAmt]}),/*#__PURE__*/_jsx(\"div\",{className:\"accountInfo\",children:\"\\u9060\\u6771\\u5546\\u9280(805)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"accountInfo\",children:accountFormatter(model===null||model===void 0?void 0:model.inAcct)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"line\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"infoListContainer\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(InformationList,{title:\"\\u8F49\\u51FA\\u5E33\\u865F\",content:accountFormatter(model===null||model===void 0?void 0:model.outAcct)}),/*#__PURE__*/_jsx(InformationList,{title:\"\\u6642\\u9593\",content:model===null||model===void 0?void 0:model.dateStr})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'8rem'},children:/*#__PURE__*/_jsxs(Accordion,{title:\"\\u8A73\\u7D30\\u4EA4\\u6613\",children:[/*#__PURE__*/_jsx(InformationList,{title:\"\\u5E33\\u6236\\u9918\\u984D\",content:\"\".concat(currencySymbolGenerator(model===null||model===void 0?void 0:model.outCcyCd)).concat(model===null||model===void 0?void 0:(_model$transOut=model.transOut)===null||_model$transOut===void 0?void 0:_model$transOut.balance)}),/*#__PURE__*/_jsx(InformationList,{title:\"\\u532F\\u6B3E\\u6027\\u8CEA\\u5206\\u985E\",content:model===null||model===void 0?void 0:model.leglDesc}),/*#__PURE__*/_jsx(InformationList,{title:\"\\u5099\\u8A3B\",content:model===null||model===void 0?void 0:model.memo})]})})]}),/*#__PURE__*/_jsxs(BottomAction,{position:0,children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:handleClickScreenshot,children:[/*#__PURE__*/_jsx(CameraAltOutlined,{}),\"\\u756B\\u9762\\u622A\\u5716\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"divider\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:function onClick(){return console.log('跳轉查詢明細');},children:[/*#__PURE__*/_jsx(ShareOutlined,{}),\"\\u67E5\\u8A62\\u660E\\u7D30\"]})]})]}),showSnapshotSuccess&&/*#__PURE__*/_jsx(SnackModal,{icon:/*#__PURE__*/_jsx(CameraIcon,{size:32,color:theme.colors.basic.white}),text:\"\\u622A\\u5716\\u6210\\u529F\"})]})});};export default ForeignCurrencyTransfer2;","map":{"version":3,"names":["useEffect","useState","useDispatch","accountFormatter","currencySymbolGenerator","Layout","Accordion","BottomAction","InformationList","SnackModal","theme","SuccessFailureAnimations","CameraIcon","CameraAltOutlined","ShareOutlined","setWaittingVisible","ForeignCurrencyTransferWrapper","executeTransfer","ForeignCurrencyTransfer2","location","dispatch","state","model","setModel","transferResult","setTransferResult","showSnapshotSuccess","setShowSnapshotSuccess","result","isSuccess","code","errorCode","message","console","log","prevModel","updatedBalance","acctBalance","transOut","balance","handleClickScreenshot","setTimeout","inCcyCd","inAmt","inAcct","outAcct","dateStr","marginBottom","outCcyCd","leglDesc","memo","colors","basic","white"],"sources":["C:/Users/allen/git/app2-webview/src/pages/D00700_ForeignCurrencyTransfer/foreignCurrencyTransfer_2.js"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { accountFormatter, currencySymbolGenerator } from 'utilities/Generator';\r\n\r\n/* Elements */\r\nimport Layout from 'components/Layout/Layout';\r\nimport Accordion from 'components/Accordion';\r\nimport BottomAction from 'components/BottomAction';\r\nimport InformationList from 'components/InformationList';\r\nimport SnackModal from 'components/SnackModal';\r\nimport theme from 'themes/theme';\r\nimport SuccessFailureAnimations from 'components/SuccessFailureAnimations';\r\nimport { CameraIcon } from 'assets/images/icons';\r\nimport {\r\n  CameraAltOutlined, ShareOutlined,\r\n} from '@material-ui/icons';\r\n\r\nimport { setWaittingVisible } from 'stores/reducers/ModalReducer';\r\n\r\n/* Styles */\r\nimport ForeignCurrencyTransferWrapper from './foreignCurrencyTransfer.style';\r\nimport { executeTransfer } from './api';\r\n\r\nconst ForeignCurrencyTransfer2 = ({ location }) => {\r\n  const dispatch = useDispatch();\r\n\r\n  const [model, setModel] = useState(location.state);\r\n  const [transferResult, setTransferResult] = useState({});\r\n  const [showSnapshotSuccess, setShowSnapshotSuccess] = useState();\r\n\r\n  /**\r\n   * 頁面初始化\r\n   */\r\n  useEffect(async () => {\r\n    dispatch(setWaittingVisible(true));\r\n\r\n    const result = await executeTransfer();\r\n    const isSuccess = (result?.code === '0000'); // Debug 假設！\r\n    await setTransferResult({\r\n      isSuccess,\r\n      errorCode: result?.code,\r\n      message: result?.message, // 錯誤訊息\r\n    });\r\n    console.log('==> 轉帳執行結果：', result);\r\n    console.log('==> transferResult：', transferResult);\r\n    if (isSuccess) {\r\n      console.log('==> isSuccess：', isSuccess);\r\n      setModel((prevModel) => {\r\n        const updatedBalance = result.acctBalance;\r\n        return {\r\n          ...prevModel,\r\n          transOut: {\r\n            ...prevModel.transOut,\r\n            balance: updatedBalance,\r\n          },\r\n        };\r\n      });\r\n    }\r\n    console.log('==> model：', model);\r\n  }, []);\r\n\r\n  /**\r\n   * 初始化完成，關閉等待中狀態。\r\n   */\r\n  useEffect(async () => {\r\n    console.log('==> (66)transferResult：', transferResult);\r\n    if (transferResult) dispatch(setWaittingVisible(false));\r\n  }, [transferResult]);\r\n\r\n  const handleClickScreenshot = () => {\r\n    // TODO 透過原生功能進行截圖。\r\n    setShowSnapshotSuccess(true);\r\n    setTimeout(() => setShowSnapshotSuccess(false), 1000); // 1 秒後自動關閉。\r\n  };\r\n\r\n  return (\r\n    <Layout title=\"外幣轉帳結果\">\r\n      <ForeignCurrencyTransferWrapper className={transferResult.isSuccess ? 'confirmAndResult' : 'confirmAndResult fail'}>\r\n        <SuccessFailureAnimations isSuccess={transferResult.isSuccess} successTitle=\"轉帳成功\" errorTitle=\"轉帳失敗\" />\r\n        {\r\n          transferResult.isSuccess && (\r\n            <>\r\n              <div className=\"confrimDataContainer\">\r\n                <div className=\"dataLabel\">轉出金額與轉入帳號</div>\r\n                <div className=\"balance\">\r\n                  {\r\n                    currencySymbolGenerator(model?.inCcyCd)\r\n                  }\r\n                  {\r\n                    model?.inAmt\r\n                  }\r\n                </div>\r\n                <div className=\"accountInfo\">遠東商銀(805)</div>\r\n                <div className=\"accountInfo\">{ accountFormatter(model?.inAcct) }</div>\r\n              </div>\r\n              <div className=\"line\" />\r\n              <div className=\"infoListContainer\">\r\n                <div>\r\n                  <InformationList title=\"轉出帳號\" content={accountFormatter(model?.outAcct)} />\r\n                  <InformationList title=\"時間\" content={model?.dateStr} />\r\n                </div>\r\n                <div style={{ marginBottom: '8rem' }}>\r\n                  <Accordion title=\"詳細交易\">\r\n                    <InformationList title=\"帳戶餘額\" content={`${currencySymbolGenerator(model?.outCcyCd)}${model?.transOut?.balance}`} />\r\n                    <InformationList title=\"匯款性質分類\" content={model?.leglDesc} />\r\n                    <InformationList title=\"備註\" content={model?.memo} />\r\n                  </Accordion>\r\n                </div>\r\n              </div>\r\n              <BottomAction position={0}>\r\n                <button type=\"button\" onClick={handleClickScreenshot}>\r\n                  <CameraAltOutlined />\r\n                  畫面截圖\r\n                </button>\r\n                <div className=\"divider\" />\r\n                <button type=\"button\" onClick={() => console.log('跳轉查詢明細')}>\r\n                  <ShareOutlined />\r\n                  查詢明細\r\n                </button>\r\n              </BottomAction>\r\n            </>\r\n          )\r\n        }\r\n        { showSnapshotSuccess && (\r\n          <SnackModal icon={<CameraIcon size={32} color={theme.colors.basic.white} />} text=\"截圖成功\" />\r\n        ) }\r\n      </ForeignCurrencyTransferWrapper>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default ForeignCurrencyTransfer2;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}