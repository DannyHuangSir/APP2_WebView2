{"ast":null,"code":"import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useHistory}from'react-router';import{useEffect,useState}from'react';import{StarRounded}from'@material-ui/icons';import{getThisMonth}from'utilities/MonthGenerator';/* Elements */import Layout from'components/Layout/Layout';// import Dialog from 'components/Dialog';\nimport{FEIBTab,FEIBTabContext,FEIBTabList}from'components/elements';/* Reducers & JS functions */import{useCheckLocation,usePageInfo}from'hooks';import{ArrowNextIcon}from'assets/images/icons';import{toCurrency}from'utilities/Generator';import{getBonusPeriodList,getDepositPlus,getDepositPlusLevelList}from'./api';import DepositPlusWrapper from'./depositPlus.style';/**\r\n * DepositPlus 優惠利率額度\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Deposit=function Deposit(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),tabId=_useState2[0],setTabId=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),monthly=_useState4[0],setMonthly=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),levelList=_useState6[0],setLevelList=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),depositPlusDetail=_useState8[0],setDepositPlusDetail=_useState8[1];var history=useHistory();/* 若無值/值為NaN，顯示0而非橫線 */var renderText=function renderText(value){if(value==='NaN'){return'0';}return value||'0';};var renderMonthlyTabs=function renderMonthlyTabs(list){return list.map(function(month){return/*#__PURE__*/_jsx(FEIBTab,{label:\"\".concat(month.substr(4),\"\\u6708\"),value:month},month);});};var renderTabArea=function renderTabArea(monthList){return/*#__PURE__*/_jsx(FEIBTabContext,{value:tabId,children:/*#__PURE__*/_jsx(FEIBTabList,{onChange:function onChange(event,id){return setTabId(id);},$size:\"small\",className:\"tabList\",children:renderMonthlyTabs(monthList)})});};var nextPage=function nextPage(){history.push('/depositPlusDetail',{bonusDetail:depositPlusDetail.bonusDetail,year:tabId.substr(0,4)});};useCheckLocation();usePageInfo('/api/depositPlus');useEffect(function(){getBonusPeriodList({}).then(function(response){var sortedMonthly=response===null||response===void 0?void 0:response.sort(function(a,b){return b-a;});if(!response.length)sortedMonthly.push(getThisMonth());// 如果沒有回傳資料，顯示系統年月\nsetMonthly(sortedMonthly);setTabId(sortedMonthly[0]);});},[]);useEffect(function(){if(monthly.length)setTabId(monthly[0]);},[monthly.length]);// 切換頁籤撈取不同月份資料\nuseEffect(function(){if(tabId){getDepositPlus({dateRange:tabId}).then(function(response){return setDepositPlusDetail(response);});}},[tabId]);// 優惠利率額度等級表，點開彈窗再撈取資料\nuseEffect(function(){var year=\"\".concat(tabId.substr(0,4));// 如果已有資料則不再重複撈取資料\nif(!levelList.length){getDepositPlusLevelList({year:year}).then(function(response){return setLevelList(response!==null&&response!==void 0?response:[]);});}},[levelList.length]);return/*#__PURE__*/_jsx(Layout,{title:\"\\u512A\\u60E0\\u5229\\u7387\\u984D\\u5EA6\",children:/*#__PURE__*/_jsxs(DepositPlusWrapper,{children:[tabId&&monthly.length&&renderTabArea(monthly),/*#__PURE__*/_jsxs(\"div\",{className:\"mainArea\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[depositPlusDetail.period!==undefined&&\"\".concat(!depositPlusDetail.period?monthly[0].substr(0,4):depositPlusDetail.period.substr(0,4),\"/\").concat(!depositPlusDetail.period?monthly[0].substr(4):depositPlusDetail.period.substr(4)),\"\\u512A\\u60E0\\u5229\\u7387\\u984D\\u5EA6\\u7E3D\\u8A08\"]}),/*#__PURE__*/_jsx(\"h3\",{children:\"$\".concat(renderText(toCurrency(parseInt(depositPlusDetail.summaryBonusQuota,10))))})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"detailArea\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sectionTitle\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u6D3B\\u52D5\\u660E\\u7D30\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:function onClick(){return nextPage();},children:[\"\\u5404\\u9805\\u6D3B\\u52D5\\u8AAA\\u660E\",/*#__PURE__*/_jsx(ArrowNextIcon,{})]})]}),/*#__PURE__*/_jsxs(\"ul\",{className:\"detailList\",children:[/*#__PURE__*/_jsxs(\"li\",{className:\"listHead\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u6D3B\\u52D5\\u540D\\u7A31/\\u8AAA\\u660E\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u512A\\u60E0\\u5B9A\\u984D\\u4E0A\\u9650\"})]}),!!depositPlusDetail.bonusDetail&&depositPlusDetail.bonusDetail.map(function(detail){return/*#__PURE__*/_jsxs(\"li\",{className:\"listBody\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:detail.promotionName}),/*#__PURE__*/_jsx(\"span\",{children:detail.memo})]}),/*#__PURE__*/_jsx(\"p\",{className:\"limitPrice\",children:\"$\".concat(toCurrency(parseInt(detail.bonusQuota,10)))})]},detail);})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"remarkArea\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u6A19\\u793A\"}),/*#__PURE__*/_jsx(StarRounded,{className:\"starIcon\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u6D3B\\u52D5\\u4E4B\\u512A\\u60E0\\u5229\\u7387\\u64C7\\u512A\\u8A08\\u7B97\"})]})]})]})});};export default Deposit;","map":{"version":3,"names":["useHistory","useEffect","useState","StarRounded","getThisMonth","Layout","FEIBTab","FEIBTabContext","FEIBTabList","useCheckLocation","usePageInfo","ArrowNextIcon","toCurrency","getBonusPeriodList","getDepositPlus","getDepositPlusLevelList","DepositPlusWrapper","Deposit","tabId","setTabId","monthly","setMonthly","levelList","setLevelList","depositPlusDetail","setDepositPlusDetail","history","renderText","value","renderMonthlyTabs","list","map","month","substr","renderTabArea","monthList","event","id","nextPage","push","bonusDetail","year","then","response","sortedMonthly","sort","a","b","length","dateRange","period","undefined","parseInt","summaryBonusQuota","detail","promotionName","memo","bonusQuota"],"sources":["C:/Users/allen/git/app2-webview/src/pages/C00300_NtdDeposit/DepositPlus/index.js"],"sourcesContent":["import { useHistory } from 'react-router';\r\nimport { useEffect, useState } from 'react';\r\nimport { StarRounded } from '@material-ui/icons';\r\nimport { getThisMonth } from 'utilities/MonthGenerator';\r\n\r\n/* Elements */\r\nimport Layout from 'components/Layout/Layout';\r\n// import Dialog from 'components/Dialog';\r\nimport {\r\n  FEIBTab, FEIBTabContext, FEIBTabList,\r\n} from 'components/elements';\r\n\r\n/* Reducers & JS functions */\r\nimport { useCheckLocation, usePageInfo } from 'hooks';\r\nimport { ArrowNextIcon } from 'assets/images/icons';\r\nimport { toCurrency } from 'utilities/Generator';\r\nimport { getBonusPeriodList, getDepositPlus, getDepositPlusLevelList } from './api';\r\nimport DepositPlusWrapper from './depositPlus.style';\r\n\r\n/**\r\n * DepositPlus 優惠利率額度\r\n */\r\nconst Deposit = () => {\r\n  const [tabId, setTabId] = useState('');\r\n  const [monthly, setMonthly] = useState([]);\r\n  const [levelList, setLevelList] = useState([]);\r\n  const [depositPlusDetail, setDepositPlusDetail] = useState({});\r\n\r\n  const history = useHistory();\r\n\r\n  /* 若無值/值為NaN，顯示0而非橫線 */\r\n  const renderText = (value) => {\r\n    if (value === 'NaN') {\r\n      return '0';\r\n    }\r\n    return value || '0';\r\n  };\r\n\r\n  const renderMonthlyTabs = (list) => list.map((month) => (\r\n    <FEIBTab key={month} label={`${month.substr(4)}月`} value={month} />\r\n  ));\r\n\r\n  const renderTabArea = (monthList) => (\r\n    <FEIBTabContext value={tabId}>\r\n      <FEIBTabList onChange={(event, id) => setTabId(id)} $size=\"small\" className=\"tabList\">\r\n        { renderMonthlyTabs(monthList) }\r\n      </FEIBTabList>\r\n    </FEIBTabContext>\r\n  );\r\n\r\n  const nextPage = () => {\r\n    history.push('/depositPlusDetail', { bonusDetail: depositPlusDetail.bonusDetail, year: tabId.substr(0, 4) });\r\n  };\r\n\r\n  useCheckLocation();\r\n  usePageInfo('/api/depositPlus');\r\n\r\n  useEffect(() => {\r\n    getBonusPeriodList({})\r\n      .then((response) => {\r\n        const sortedMonthly = response?.sort((a, b) => b - a);\r\n        if (!response.length) sortedMonthly.push(getThisMonth()); // 如果沒有回傳資料，顯示系統年月\r\n        setMonthly(sortedMonthly);\r\n        setTabId(sortedMonthly[0]);\r\n      });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (monthly.length) setTabId(monthly[0]);\r\n  }, [monthly.length]);\r\n\r\n  // 切換頁籤撈取不同月份資料\r\n  useEffect(() => {\r\n    if (tabId) {\r\n      getDepositPlus({ dateRange: tabId })\r\n        .then((response) => setDepositPlusDetail(response));\r\n    }\r\n  }, [tabId]);\r\n\r\n  // 優惠利率額度等級表，點開彈窗再撈取資料\r\n  useEffect(() => {\r\n    const year = `${tabId.substr(0, 4)}`;\r\n    // 如果已有資料則不再重複撈取資料\r\n    if (!levelList.length) {\r\n      getDepositPlusLevelList({ year })\r\n        .then((response) => setLevelList(response ?? []));\r\n    }\r\n  }, [levelList.length]);\r\n\r\n  return (\r\n    <Layout title=\"優惠利率額度\">\r\n      <DepositPlusWrapper>\r\n        { tabId && monthly.length && renderTabArea(monthly) }\r\n\r\n        <div className=\"mainArea\">\r\n          <span>\r\n            {/* 如果沒有回傳資料，顯示系統年月 */}\r\n            {depositPlusDetail.period !== undefined && `${!depositPlusDetail.period ? monthly[0].substr(0, 4) : depositPlusDetail.period.substr(0, 4)}/${!depositPlusDetail.period ? monthly[0].substr(4) : depositPlusDetail.period.substr(4)}`}\r\n            優惠利率額度總計\r\n          </span>\r\n          <h3>{`$${renderText(toCurrency(parseInt(depositPlusDetail.summaryBonusQuota, 10)))}`}</h3>\r\n        </div>\r\n\r\n        <section className=\"detailArea\">\r\n          <div className=\"sectionTitle\">\r\n            <h3>活動明細</h3>\r\n            <button type=\"button\" onClick={() => nextPage()}>\r\n              各項活動說明\r\n              <ArrowNextIcon />\r\n            </button>\r\n          </div>\r\n\r\n          <ul className=\"detailList\">\r\n            <li className=\"listHead\">\r\n              <span>活動名稱/說明</span>\r\n              <span>優惠定額上限</span>\r\n            </li>\r\n            {!!depositPlusDetail.bonusDetail && depositPlusDetail.bonusDetail.map((detail) => (\r\n              <li className=\"listBody\" key={detail}>\r\n                <div>\r\n                  <p>{detail.promotionName}</p>\r\n                  <span>{detail.memo}</span>\r\n                </div>\r\n                <p className=\"limitPrice\">\r\n                  {`$${toCurrency(parseInt(detail.bonusQuota, 10))}`}\r\n                </p>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n\r\n          <div className=\"remarkArea\">\r\n            <span>標示</span>\r\n            <StarRounded className=\"starIcon\" />\r\n            <span>活動之優惠利率擇優計算</span>\r\n          </div>\r\n        </section>\r\n      </DepositPlusWrapper>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Deposit;\r\n"],"mappings":"qHAAA,OAASA,UAAU,KAAQ,cAAc,CACzC,OAASC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,WAAW,KAAQ,oBAAoB,CAChD,OAASC,YAAY,KAAQ,0BAA0B,CAEvD,cACA,MAAOC,OAAM,KAAM,0BAA0B,CAC7C;AACA,OACEC,OAAO,CAAEC,cAAc,CAAEC,WAAW,KAC/B,qBAAqB,CAE5B,6BACA,OAASC,gBAAgB,CAAEC,WAAW,KAAQ,OAAO,CACrD,OAASC,aAAa,KAAQ,qBAAqB,CACnD,OAASC,UAAU,KAAQ,qBAAqB,CAChD,OAASC,kBAAkB,CAAEC,cAAc,CAAEC,uBAAuB,KAAQ,OAAO,CACnF,MAAOC,mBAAkB,KAAM,qBAAqB,CAEpD;AACA;AACA,GAFA,wFAGA,GAAMC,QAAO,CAAG,QAAVA,QAAO,EAAS,CACpB,cAA0Bf,QAAQ,CAAC,EAAE,CAAC,wCAA/BgB,KAAK,eAAEC,QAAQ,eACtB,eAA8BjB,QAAQ,CAAC,EAAE,CAAC,yCAAnCkB,OAAO,eAAEC,UAAU,eAC1B,eAAkCnB,QAAQ,CAAC,EAAE,CAAC,yCAAvCoB,SAAS,eAAEC,YAAY,eAC9B,eAAkDrB,QAAQ,CAAC,CAAC,CAAC,CAAC,yCAAvDsB,iBAAiB,eAAEC,oBAAoB,eAE9C,GAAMC,QAAO,CAAG1B,UAAU,EAAE,CAE5B,uBACA,GAAM2B,WAAU,CAAG,QAAbA,WAAU,CAAIC,KAAK,CAAK,CAC5B,GAAIA,KAAK,GAAK,KAAK,CAAE,CACnB,MAAO,GAAG,CACZ,CACA,MAAOA,MAAK,EAAI,GAAG,CACrB,CAAC,CAED,GAAMC,kBAAiB,CAAG,QAApBA,kBAAiB,CAAIC,IAAI,QAAKA,KAAI,CAACC,GAAG,CAAC,SAACC,KAAK,qBACjD,KAAC,OAAO,EAAa,KAAK,WAAKA,KAAK,CAACC,MAAM,CAAC,CAAC,CAAC,UAAI,CAAC,KAAK,CAAED,KAAM,EAAlDA,KAAK,CAAgD,EACpE,CAAC,GAEF,GAAME,cAAa,CAAG,QAAhBA,cAAa,CAAIC,SAAS,qBAC9B,KAAC,cAAc,EAAC,KAAK,CAAEjB,KAAM,uBAC3B,KAAC,WAAW,EAAC,QAAQ,CAAE,kBAACkB,KAAK,CAAEC,EAAE,QAAKlB,SAAQ,CAACkB,EAAE,CAAC,EAAC,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,SAAS,UACjFR,iBAAiB,CAACM,SAAS,CAAC,EAClB,EACC,EAClB,CAED,GAAMG,SAAQ,CAAG,QAAXA,SAAQ,EAAS,CACrBZ,OAAO,CAACa,IAAI,CAAC,oBAAoB,CAAE,CAAEC,WAAW,CAAEhB,iBAAiB,CAACgB,WAAW,CAAEC,IAAI,CAAEvB,KAAK,CAACe,MAAM,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAC9G,CAAC,CAEDxB,gBAAgB,EAAE,CAClBC,WAAW,CAAC,kBAAkB,CAAC,CAE/BT,SAAS,CAAC,UAAM,CACdY,kBAAkB,CAAC,CAAC,CAAC,CAAC,CACnB6B,IAAI,CAAC,SAACC,QAAQ,CAAK,CAClB,GAAMC,cAAa,CAAGD,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEE,IAAI,CAAC,SAACC,CAAC,CAAEC,CAAC,QAAKA,EAAC,CAAGD,CAAC,GAAC,CACrD,GAAI,CAACH,QAAQ,CAACK,MAAM,CAAEJ,aAAa,CAACL,IAAI,CAACnC,YAAY,EAAE,CAAC,CAAE;AAC1DiB,UAAU,CAACuB,aAAa,CAAC,CACzBzB,QAAQ,CAACyB,aAAa,CAAC,CAAC,CAAC,CAAC,CAC5B,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN3C,SAAS,CAAC,UAAM,CACd,GAAImB,OAAO,CAAC4B,MAAM,CAAE7B,QAAQ,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAC1C,CAAC,CAAE,CAACA,OAAO,CAAC4B,MAAM,CAAC,CAAC,CAEpB;AACA/C,SAAS,CAAC,UAAM,CACd,GAAIiB,KAAK,CAAE,CACTJ,cAAc,CAAC,CAAEmC,SAAS,CAAE/B,KAAM,CAAC,CAAC,CACjCwB,IAAI,CAAC,SAACC,QAAQ,QAAKlB,qBAAoB,CAACkB,QAAQ,CAAC,GAAC,CACvD,CACF,CAAC,CAAE,CAACzB,KAAK,CAAC,CAAC,CAEX;AACAjB,SAAS,CAAC,UAAM,CACd,GAAMwC,KAAI,WAAMvB,KAAK,CAACe,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,CAAE,CACpC;AACA,GAAI,CAACX,SAAS,CAAC0B,MAAM,CAAE,CACrBjC,uBAAuB,CAAC,CAAE0B,IAAI,CAAJA,IAAK,CAAC,CAAC,CAC9BC,IAAI,CAAC,SAACC,QAAQ,QAAKpB,aAAY,CAACoB,QAAQ,SAARA,QAAQ,UAARA,QAAQ,CAAI,EAAE,CAAC,GAAC,CACrD,CACF,CAAC,CAAE,CAACrB,SAAS,CAAC0B,MAAM,CAAC,CAAC,CAEtB,mBACE,KAAC,MAAM,EAAC,KAAK,CAAC,sCAAQ,uBACpB,MAAC,kBAAkB,YACf9B,KAAK,EAAIE,OAAO,CAAC4B,MAAM,EAAId,aAAa,CAACd,OAAO,CAAC,cAEnD,aAAK,SAAS,CAAC,UAAU,wBACvB,wBAEGI,iBAAiB,CAAC0B,MAAM,GAAKC,SAAS,YAAO,CAAC3B,iBAAiB,CAAC0B,MAAM,CAAG9B,OAAO,CAAC,CAAC,CAAC,CAACa,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,CAAGT,iBAAiB,CAAC0B,MAAM,CAACjB,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,aAAI,CAACT,iBAAiB,CAAC0B,MAAM,CAAG9B,OAAO,CAAC,CAAC,CAAC,CAACa,MAAM,CAAC,CAAC,CAAC,CAAGT,iBAAiB,CAAC0B,MAAM,CAACjB,MAAM,CAAC,CAAC,CAAC,CAAE,sDAE/N,cACP,+BAASN,UAAU,CAACf,UAAU,CAACwC,QAAQ,CAAC5B,iBAAiB,CAAC6B,iBAAiB,CAAE,EAAE,CAAC,CAAC,CAAC,GAAQ,GACtF,cAEN,iBAAS,SAAS,CAAC,YAAY,wBAC7B,aAAK,SAAS,CAAC,cAAc,wBAC3B,gDAAa,cACb,gBAAQ,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAE,yBAAMf,SAAQ,EAAE,EAAC,+DAE9C,KAAC,aAAa,IAAG,GACV,GACL,cAEN,YAAI,SAAS,CAAC,YAAY,wBACxB,YAAI,SAAS,CAAC,UAAU,wBACtB,+DAAoB,cACpB,8DAAmB,GAChB,CACJ,CAAC,CAACd,iBAAiB,CAACgB,WAAW,EAAIhB,iBAAiB,CAACgB,WAAW,CAACT,GAAG,CAAC,SAACuB,MAAM,qBAC3E,YAAI,SAAS,CAAC,UAAU,wBACtB,oCACE,mBAAIA,MAAM,CAACC,aAAa,EAAK,cAC7B,sBAAOD,MAAM,CAACE,IAAI,EAAQ,GACtB,cACN,UAAG,SAAS,CAAC,YAAY,qBAClB5C,UAAU,CAACwC,QAAQ,CAACE,MAAM,CAACG,UAAU,CAAE,EAAE,CAAC,CAAC,GAC9C,GAPwBH,MAAM,CAQ/B,EACN,CAAC,GACC,cAEL,aAAK,SAAS,CAAC,YAAY,wBACzB,sCAAe,cACf,KAAC,WAAW,EAAC,SAAS,CAAC,UAAU,EAAG,cACpC,4FAAwB,GACpB,GACE,GACS,EACd,CAEb,CAAC,CAED,cAAerC,QAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}