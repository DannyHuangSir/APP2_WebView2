{"ast":null,"code":"import _objectSpread from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import BankCode from'components/BankCodeInput/bankSelector';import{FEIBErrorMessage,FEIBInput,FEIBInputLabel}from'components/elements';import{ListIcon}from'assets/images/icons';import{Controller}from'react-hook-form';import{getBankCode}from'utilities/CacheData';import Loading from'components/Loading';/*\r\n* ================== BankCodeInput 組件說明 ==================\r\n* BankCodeInput 組件封裝了 Input 和 BankCode 清單\r\n* ================== BankCodeInput 可傳參數 ==================\r\n* *** 所有參數皆供表單驗證與取值用 ***\r\n* 1. id -> Input 的 id、name、Controller 的 name 均會代入此參數\r\n*    此組件將根據上述 4 種不同狀態而產生不同的樣式色彩，預設為 \"error\"\r\n* 2. control -> 傳入 react-hook-form 的 control 參數\r\n* 3. setValue -> 傳入 react-hook-form 的 setValue 參數\r\n* 4. trigger -> 傳入 react-hook-form 的 trigger 參數\r\n* 5. errorMessage -> 表單驗證的錯誤訊息\r\n* 6. value -> 若原先就有 value 值，可傳入，若無則預設為帶有 2 個空字串的物件\r\n* */import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BankCodeInput=function BankCodeInput(_ref){var name=_ref.name,control=_ref.control,setValue=_ref.setValue,trigger=_ref.trigger,rules=_ref.rules,errorMessage=_ref.errorMessage,value=_ref.value,readonly=_ref.readonly;var _useState=useState(),_useState2=_slicedToArray(_useState,2),bankList=_useState2[0],setBankList=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),showSelector=_useState4[0],setShowSelector=_useState4[1];/**\r\n   *- 初始化\r\n   */useEffect(function(){getBankCode().then(function(banks){return setBankList(banks);});// D00500_AccountEditor 會渲染此 Component 的瞬間馬上 unmount，\n// getBankCode 屬於 asynchronous，若 unmount 會造成 memory leaks，故在此新增 teardown function\nreturn function(){return setBankList(null);};},[]);/**\r\n   * HTML輸出。\r\n   */ //  在 bankList 還沒準備好之前，不應該出現 Input 欄位給使用者點擊，\n// 因為 bankList 此時還是 undefined，會造成 JavaScript Crash\nif(!bankList)return/*#__PURE__*/_jsx(Loading,{space:\"bottom\",isCentered:true});return/*#__PURE__*/_jsxs(\"div\",{style:{pointerEvents:readonly?'none':'auto'},children:[/*#__PURE__*/_jsx(Controller,{control:control,name:name,rules:rules,render:function render(_ref2){var _bankList$find$bankNa,_bankList$find;var field=_ref2.field;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FEIBInputLabel,{htmlFor:name,children:\"\\u9280\\u884C\\u4EE3\\u78BC\"}),/*#__PURE__*/_jsx(FEIBInput,_objectSpread(_objectSpread({},field),{},{placeholder:\"\\u8ACB\\u9078\\u64C7\",value:\"\".concat(value!==null&&value!==void 0?value:'',\" \").concat((_bankList$find$bankNa=bankList===null||bankList===void 0?void 0:(_bankList$find=bankList.find(function(b){return b.bankNo===value;}))===null||_bankList$find===void 0?void 0:_bankList$find.bankName)!==null&&_bankList$find$bankNa!==void 0?_bankList$find$bankNa:''),$icon:/*#__PURE__*/_jsx(ListIcon,{}),$iconFontSize:2.4,$iconOnClick:function $iconOnClick(){return setShowSelector(true);},readOnly:true,error:!!errorMessage,onClick:function onClick(){return setShowSelector(true);}})),/*#__PURE__*/_jsx(FEIBErrorMessage,{children:errorMessage})]});}}),showSelector?/*#__PURE__*/_jsx(BankCode,{banks:bankList,onClose:function onClose(){return setShowSelector(false);},onSelected:function onSelected(bank){setValue(name,bank.bankNo);trigger(name);}}):null]});};export default BankCodeInput;","map":{"version":3,"names":["useState","useEffect","BankCode","FEIBErrorMessage","FEIBInput","FEIBInputLabel","ListIcon","Controller","getBankCode","Loading","BankCodeInput","name","control","setValue","trigger","rules","errorMessage","value","readonly","bankList","setBankList","showSelector","setShowSelector","then","banks","pointerEvents","field","find","b","bankNo","bankName","bank"],"sources":["C:/Users/allen/git/app2-webview/src/components/BankCodeInput/index.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport BankCode from 'components/BankCodeInput/bankSelector';\r\nimport { FEIBErrorMessage, FEIBInput, FEIBInputLabel } from 'components/elements';\r\nimport { ListIcon } from 'assets/images/icons';\r\nimport { Controller } from 'react-hook-form';\r\nimport { getBankCode } from 'utilities/CacheData';\r\nimport Loading from 'components/Loading';\r\n\r\n/*\r\n* ================== BankCodeInput 組件說明 ==================\r\n* BankCodeInput 組件封裝了 Input 和 BankCode 清單\r\n* ================== BankCodeInput 可傳參數 ==================\r\n* *** 所有參數皆供表單驗證與取值用 ***\r\n* 1. id -> Input 的 id、name、Controller 的 name 均會代入此參數\r\n*    此組件將根據上述 4 種不同狀態而產生不同的樣式色彩，預設為 \"error\"\r\n* 2. control -> 傳入 react-hook-form 的 control 參數\r\n* 3. setValue -> 傳入 react-hook-form 的 setValue 參數\r\n* 4. trigger -> 傳入 react-hook-form 的 trigger 參數\r\n* 5. errorMessage -> 表單驗證的錯誤訊息\r\n* 6. value -> 若原先就有 value 值，可傳入，若無則預設為帶有 2 個空字串的物件\r\n* */\r\n\r\nconst BankCodeInput = ({\r\n  name,\r\n  control,\r\n  setValue,\r\n  trigger,\r\n  rules,\r\n  errorMessage,\r\n  value,\r\n  readonly,\r\n}) => {\r\n  const [bankList, setBankList] = useState();\r\n  const [showSelector, setShowSelector] = useState();\r\n\r\n  /**\r\n   *- 初始化\r\n   */\r\n  useEffect(() => {\r\n    getBankCode().then((banks) => setBankList(banks));\r\n    // D00500_AccountEditor 會渲染此 Component 的瞬間馬上 unmount，\r\n    // getBankCode 屬於 asynchronous，若 unmount 會造成 memory leaks，故在此新增 teardown function\r\n    return () => setBankList(null);\r\n  }, []);\r\n\r\n  /**\r\n   * HTML輸出。\r\n   */\r\n\r\n  //  在 bankList 還沒準備好之前，不應該出現 Input 欄位給使用者點擊，\r\n  // 因為 bankList 此時還是 undefined，會造成 JavaScript Crash\r\n  if (!bankList) return <Loading space=\"bottom\" isCentered />;\r\n\r\n  return (\r\n    <div style={{ pointerEvents: readonly ? 'none' : 'auto' }}>\r\n      <Controller\r\n        control={control}\r\n        name={name}\r\n        rules={rules}\r\n        render={({ field }) => (\r\n          <>\r\n            <FEIBInputLabel htmlFor={name}>銀行代碼</FEIBInputLabel>\r\n            <FEIBInput\r\n              {...field}\r\n              placeholder=\"請選擇\"\r\n              value={`${value ?? ''} ${\r\n                bankList?.find((b) => b.bankNo === value)?.bankName ?? ''\r\n              }`}\r\n              $icon={<ListIcon />}\r\n              $iconFontSize={2.4}\r\n              $iconOnClick={() => setShowSelector(true)}\r\n              readOnly\r\n              error={!!errorMessage}\r\n              onClick={() => setShowSelector(true)}\r\n            />\r\n            <FEIBErrorMessage>{errorMessage}</FEIBErrorMessage>\r\n          </>\r\n        )}\r\n      />\r\n      {showSelector ? (\r\n        <BankCode\r\n          banks={bankList}\r\n          onClose={() => setShowSelector(false)}\r\n          onSelected={(bank) => {\r\n            setValue(name, bank.bankNo);\r\n            trigger(name);\r\n          }}\r\n        />\r\n      ) : null}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BankCodeInput;\r\n"],"mappings":"yOAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAOC,SAAQ,KAAM,uCAAuC,CAC5D,OAASC,gBAAgB,CAAEC,SAAS,CAAEC,cAAc,KAAQ,qBAAqB,CACjF,OAASC,QAAQ,KAAQ,qBAAqB,CAC9C,OAASC,UAAU,KAAQ,iBAAiB,CAC5C,OAASC,WAAW,KAAQ,qBAAqB,CACjD,MAAOC,QAAO,KAAM,oBAAoB,CAExC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAZA,6IAcA,GAAMC,cAAa,CAAG,QAAhBA,cAAa,MASb,IARJC,KAAI,MAAJA,IAAI,CACJC,OAAO,MAAPA,OAAO,CACPC,QAAQ,MAARA,QAAQ,CACRC,OAAO,MAAPA,OAAO,CACPC,KAAK,MAALA,KAAK,CACLC,YAAY,MAAZA,YAAY,CACZC,KAAK,MAALA,KAAK,CACLC,QAAQ,MAARA,QAAQ,CAER,cAAgClB,QAAQ,EAAE,wCAAnCmB,QAAQ,eAAEC,WAAW,eAC5B,eAAwCpB,QAAQ,EAAE,yCAA3CqB,YAAY,eAAEC,eAAe,eAEpC;AACF;AACA,KACErB,SAAS,CAAC,UAAM,CACdO,WAAW,EAAE,CAACe,IAAI,CAAC,SAACC,KAAK,QAAKJ,YAAW,CAACI,KAAK,CAAC,GAAC,CACjD;AACA;AACA,MAAO,kBAAMJ,YAAW,CAAC,IAAI,CAAC,GAChC,CAAC,CAAE,EAAE,CAAC,CAEN;AACF;AACA,KAFE,CAIA;AACA;AACA,GAAI,CAACD,QAAQ,CAAE,mBAAO,KAAC,OAAO,EAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,OAAG,CAE3D,mBACE,aAAK,KAAK,CAAE,CAAEM,aAAa,CAAEP,QAAQ,CAAG,MAAM,CAAG,MAAO,CAAE,wBACxD,KAAC,UAAU,EACT,OAAO,CAAEN,OAAQ,CACjB,IAAI,CAAED,IAAK,CACX,KAAK,CAAEI,KAAM,CACb,MAAM,CAAE,mEAAGW,MAAK,OAALA,KAAK,oBACd,wCACE,KAAC,cAAc,EAAC,OAAO,CAAEf,IAAK,sCAAsB,cACpD,KAAC,SAAS,gCACJe,KAAK,MACT,WAAW,CAAC,oBAAK,CACjB,KAAK,WAAKT,KAAK,SAALA,KAAK,UAALA,KAAK,CAAI,EAAE,oCACnBE,QAAQ,SAARA,QAAQ,iCAARA,QAAQ,CAAEQ,IAAI,CAAC,SAACC,CAAC,QAAKA,EAAC,CAACC,MAAM,GAAKZ,KAAK,GAAC,yCAAzC,eAA2Ca,QAAQ,+DAAI,EAAE,CACxD,CACH,KAAK,cAAE,KAAC,QAAQ,IAAI,CACpB,aAAa,CAAE,GAAI,CACnB,YAAY,CAAE,8BAAMR,gBAAe,CAAC,IAAI,CAAC,EAAC,CAC1C,QAAQ,MACR,KAAK,CAAE,CAAC,CAACN,YAAa,CACtB,OAAO,CAAE,yBAAMM,gBAAe,CAAC,IAAI,CAAC,EAAC,GACrC,cACF,KAAC,gBAAgB,WAAEN,YAAY,EAAoB,GAClD,EACH,EACF,CACDK,YAAY,cACX,KAAC,QAAQ,EACP,KAAK,CAAEF,QAAS,CAChB,OAAO,CAAE,yBAAMG,gBAAe,CAAC,KAAK,CAAC,EAAC,CACtC,UAAU,CAAE,oBAACS,IAAI,CAAK,CACpBlB,QAAQ,CAACF,IAAI,CAAEoB,IAAI,CAACF,MAAM,CAAC,CAC3Bf,OAAO,CAACH,IAAI,CAAC,CACf,CAAE,EACF,CACA,IAAI,GACJ,CAEV,CAAC,CAED,cAAeD,cAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}