{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useDispatch}from'react-redux';import{getThisMonth}from'utilities/MonthGenerator';import{closeFunc}from'utilities/AppScriptProxy';import{currencySymbolGenerator}from'utilities/Generator';import{setWaittingVisible}from'stores/reducers/ModalReducer';/* Element */import Layout from'components/Layout/Layout';import Main from'components/Layout';import Badge from'components/Badge';import Accordion from'components/Accordion';import AccordionContent from'./components/AccordionContent';import Reminder from'./components/Reminder';import Transactions from'./components/Transactions';import BillDetails from'./components/BillDetails';import Tray from'./components/Tray';/* Data */import{getBillDeducStatus,getBillDetail}from'./api';/* Style */import PageWrapper from'./R00300.style';/**\r\n * R00300 信用卡 帳單頁\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Page=function Page(){var _bills$currency,_bills$newBalance;var dispatch=useDispatch();var _useState=useState(getThisMonth()),_useState2=_slicedToArray(_useState,2),currentMonth=_useState2[0],setCurrentMonth=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),bills=_useState4[0],setBills=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),deductInfo=_useState6[0],setDeductInfo=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isExpanded=_useState8[0],setIsExpanded=_useState8[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var deductRt,billsRt;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setWaittingVisible(true));_context.next=3;return getBillDeducStatus();case 3:deductRt=_context.sent;_context.next=6;return getBillDetail(currentMonth);case 6:billsRt=_context.sent;console.log('R00300',{billsRt:billsRt});setDeductInfo(deductRt);setBills(billsRt);dispatch(setWaittingVisible(false));case 11:case\"end\":return _context.stop();}}},_callee);})),[]);var handleChangeMonth=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(selected){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setCurrentMonth(selected);_context2.t0=setBills;_context2.next=4;return getBillDetail(selected);case 4:_context2.t1=_context2.sent;(0,_context2.t0)(_context2.t1);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function handleChangeMonth(_x){return _ref2.apply(this,arguments);};}();var handleGoBack=function handleGoBack(){if(isExpanded)setIsExpanded(false);else closeFunc();};return/*#__PURE__*/_jsx(Layout,{title:\"\\u4FE1\\u7528\\u5361\\u5E33\\u55AE\",goBackFunc:handleGoBack,children:/*#__PURE__*/_jsx(Main,{small:true,children:/*#__PURE__*/_jsxs(PageWrapper,{children:[/*#__PURE__*/_jsx(Badge,{label:\"\".concat(parseInt(currentMonth.slice(-2),10).toString(),\"\\u6708\\u61C9\\u7E73\\u91D1\\u984D\"),value:currencySymbolGenerator((_bills$currency=bills===null||bills===void 0?void 0:bills.currency)!==null&&_bills$currency!==void 0?_bills$currency:'NTD',(_bills$newBalance=bills===null||bills===void 0?void 0:bills.newBalance)!==null&&_bills$newBalance!==void 0?_bills$newBalance:0)}),/*#__PURE__*/_jsx(Reminder,{bills:bills,deductInfo:deductInfo}),/*#__PURE__*/_jsx(Transactions,{bills:bills,isExpanded:isExpanded,onExpandClick:function onExpandClick(){return setIsExpanded(true);},handleChangeMonth:handleChangeMonth}),(bills===null||bills===void 0?void 0:bills.newBalance)>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(BillDetails,{bills:bills}),/*#__PURE__*/_jsx(Accordion,{children:/*#__PURE__*/_jsx(AccordionContent,{})}),isExpanded&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed-bottom\",children:\"\\u66F4\\u591A\\u5E33\\u55AE\\u8CC7\\u8A0A\\u8ACB\\u6ED1\\u81F3\\u5E95\\u90E8\\u67E5\\u770B\"}),/*#__PURE__*/_jsx(Tray,{deductInfo:deductInfo})]})]})})});};export default Page;","map":{"version":3,"names":["useState","useEffect","useDispatch","getThisMonth","closeFunc","currencySymbolGenerator","setWaittingVisible","Layout","Main","Badge","Accordion","AccordionContent","Reminder","Transactions","BillDetails","Tray","getBillDeducStatus","getBillDetail","PageWrapper","Page","dispatch","currentMonth","setCurrentMonth","bills","setBills","deductInfo","setDeductInfo","isExpanded","setIsExpanded","deductRt","billsRt","console","log","handleChangeMonth","selected","handleGoBack","parseInt","slice","toString","currency","newBalance"],"sources":["C:/Users/allen/git/app2-webview/src/pages/R00300_CCBill/R00300.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { getThisMonth } from 'utilities/MonthGenerator';\r\nimport { closeFunc } from 'utilities/AppScriptProxy';\r\nimport { currencySymbolGenerator } from 'utilities/Generator';\r\nimport { setWaittingVisible } from 'stores/reducers/ModalReducer';\r\n\r\n/* Element */\r\nimport Layout from 'components/Layout/Layout';\r\nimport Main from 'components/Layout';\r\nimport Badge from 'components/Badge';\r\nimport Accordion from 'components/Accordion';\r\nimport AccordionContent from './components/AccordionContent';\r\nimport Reminder from './components/Reminder';\r\nimport Transactions from './components/Transactions';\r\nimport BillDetails from './components/BillDetails';\r\nimport Tray from './components/Tray';\r\n\r\n/* Data */\r\nimport { getBillDeducStatus, getBillDetail } from './api';\r\n\r\n/* Style */\r\nimport PageWrapper from './R00300.style';\r\n\r\n/**\r\n * R00300 信用卡 帳單頁\r\n */\r\nconst Page = () => {\r\n  const dispatch = useDispatch();\r\n  const [currentMonth, setCurrentMonth] = useState(getThisMonth());\r\n  const [bills, setBills] = useState();\r\n  const [deductInfo, setDeductInfo] = useState();\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n\r\n  useEffect(async () => {\r\n    dispatch(setWaittingVisible(true));\r\n    const deductRt = await getBillDeducStatus();\r\n    const billsRt = await getBillDetail(currentMonth);\r\n    console.log('R00300', {billsRt});\r\n\r\n    setDeductInfo(deductRt);\r\n    setBills(billsRt);\r\n    dispatch(setWaittingVisible(false));\r\n  }, []);\r\n\r\n  const handleChangeMonth = async (selected) => {\r\n    setCurrentMonth(selected);\r\n    setBills(await getBillDetail(selected));\r\n  };\r\n\r\n  const handleGoBack = () => {\r\n    if (isExpanded) setIsExpanded(false);\r\n    else closeFunc();\r\n  };\r\n\r\n  return (\r\n    <Layout title=\"信用卡帳單\" goBackFunc={handleGoBack}>\r\n      <Main small>\r\n        <PageWrapper>\r\n          <Badge\r\n            label={`${parseInt(currentMonth.slice(-2), 10).toString()}月應繳金額`}\r\n            value={currencySymbolGenerator(bills?.currency ?? 'NTD', bills?.newBalance ?? 0)}\r\n          />\r\n          <Reminder bills={bills} deductInfo={deductInfo} />\r\n          <Transactions\r\n            bills={bills}\r\n            isExpanded={isExpanded}\r\n            onExpandClick={() => setIsExpanded(true)}\r\n            handleChangeMonth={handleChangeMonth}\r\n          />\r\n          { bills?.newBalance > 0 && (\r\n            <>\r\n              <BillDetails bills={bills} />\r\n              <Accordion>\r\n                <AccordionContent />\r\n              </Accordion>\r\n              { isExpanded && (\r\n                <div className=\"fixed-bottom\">更多帳單資訊請滑至底部查看</div>\r\n              )}\r\n              <Tray deductInfo={deductInfo} />\r\n            </>\r\n          )}\r\n        </PageWrapper>\r\n      </Main>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Page;\r\n"],"mappings":"+WAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,WAAW,KAAQ,aAAa,CACzC,OAASC,YAAY,KAAQ,0BAA0B,CACvD,OAASC,SAAS,KAAQ,0BAA0B,CACpD,OAASC,uBAAuB,KAAQ,qBAAqB,CAC7D,OAASC,kBAAkB,KAAQ,8BAA8B,CAEjE,aACA,MAAOC,OAAM,KAAM,0BAA0B,CAC7C,MAAOC,KAAI,KAAM,mBAAmB,CACpC,MAAOC,MAAK,KAAM,kBAAkB,CACpC,MAAOC,UAAS,KAAM,sBAAsB,CAC5C,MAAOC,iBAAgB,KAAM,+BAA+B,CAC5D,MAAOC,SAAQ,KAAM,uBAAuB,CAC5C,MAAOC,aAAY,KAAM,2BAA2B,CACpD,MAAOC,YAAW,KAAM,0BAA0B,CAClD,MAAOC,KAAI,KAAM,mBAAmB,CAEpC,UACA,OAASC,kBAAkB,CAAEC,aAAa,KAAQ,OAAO,CAEzD,WACA,MAAOC,YAAW,KAAM,gBAAgB,CAExC;AACA;AACA,GAFA,6IAGA,GAAMC,KAAI,CAAG,QAAPA,KAAI,EAAS,uCACjB,GAAMC,SAAQ,CAAGlB,WAAW,EAAE,CAC9B,cAAwCF,QAAQ,CAACG,YAAY,EAAE,CAAC,wCAAzDkB,YAAY,eAAEC,eAAe,eACpC,eAA0BtB,QAAQ,EAAE,yCAA7BuB,KAAK,eAAEC,QAAQ,eACtB,eAAoCxB,QAAQ,EAAE,yCAAvCyB,UAAU,eAAEC,aAAa,eAChC,eAAoC1B,QAAQ,CAAC,KAAK,CAAC,yCAA5C2B,UAAU,eAAEC,aAAa,eAEhC3B,SAAS,wEAAC,0JACRmB,QAAQ,CAACd,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAC,sBACZU,mBAAkB,EAAE,QAArCa,QAAQ,qCACQZ,cAAa,CAACI,YAAY,CAAC,QAA3CS,OAAO,eACbC,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAE,CAACF,OAAO,CAAPA,OAAO,CAAC,CAAC,CAEhCJ,aAAa,CAACG,QAAQ,CAAC,CACvBL,QAAQ,CAACM,OAAO,CAAC,CACjBV,QAAQ,CAACd,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC,uDACrC,GAAE,EAAE,CAAC,CAEN,GAAM2B,kBAAiB,6FAAG,kBAAOC,QAAQ,wHACvCZ,eAAe,CAACY,QAAQ,CAAC,CAAC,aAC1BV,QAAQ,wBAAOP,cAAa,CAACiB,QAAQ,CAAC,2HACvC,kBAHKD,kBAAiB,6CAGtB,CAED,GAAME,aAAY,CAAG,QAAfA,aAAY,EAAS,CACzB,GAAIR,UAAU,CAAEC,aAAa,CAAC,KAAK,CAAC,CAAC,IAChCxB,UAAS,EAAE,CAClB,CAAC,CAED,mBACE,KAAC,MAAM,EAAC,KAAK,CAAC,gCAAO,CAAC,UAAU,CAAE+B,YAAa,uBAC7C,KAAC,IAAI,EAAC,KAAK,4BACT,MAAC,WAAW,yBACV,KAAC,KAAK,EACJ,KAAK,WAAKC,QAAQ,CAACf,YAAY,CAACgB,KAAK,CAAC,CAAC,CAAC,CAAC,CAAE,EAAE,CAAC,CAACC,QAAQ,EAAE,kCAAQ,CACjE,KAAK,CAAEjC,uBAAuB,kBAACkB,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEgB,QAAQ,mDAAI,KAAK,oBAAEhB,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEiB,UAAU,uDAAI,CAAC,CAAE,EACjF,cACF,KAAC,QAAQ,EAAC,KAAK,CAAEjB,KAAM,CAAC,UAAU,CAAEE,UAAW,EAAG,cAClD,KAAC,YAAY,EACX,KAAK,CAAEF,KAAM,CACb,UAAU,CAAEI,UAAW,CACvB,aAAa,CAAE,+BAAMC,cAAa,CAAC,IAAI,CAAC,EAAC,CACzC,iBAAiB,CAAEK,iBAAkB,EACrC,CACA,CAAAV,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEiB,UAAU,EAAG,CAAC,eACrB,wCACE,KAAC,WAAW,EAAC,KAAK,CAAEjB,KAAM,EAAG,cAC7B,KAAC,SAAS,wBACR,KAAC,gBAAgB,IAAG,EACV,CACVI,UAAU,eACV,YAAK,SAAS,CAAC,cAAc,4FAC9B,cACD,KAAC,IAAI,EAAC,UAAU,CAAEF,UAAW,EAAG,GAEnC,GACW,EACT,EACA,CAEb,CAAC,CAED,cAAeN,KAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}