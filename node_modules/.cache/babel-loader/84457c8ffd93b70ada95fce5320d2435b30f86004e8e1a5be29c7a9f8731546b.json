{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useEffect}from'react';import{useHistory}from'react-router';import{useForm}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup';import{showError}from'utilities/MessageModal';import{getThisMonth}from'utilities/MonthGenerator';import Accordion from'components/Accordion';import Layout from'components/Layout/Layout';import{FEIBButton}from'components/elements';import{RadioGroupField}from'components/Fields/radioGroupField';import{queryCardBill}from'./api';import InstalmentWrapper from'./R00200.style';import{entranceSchema}from'./validationSchema';import{R00200AccordionContent2}from'./utils';/**\r\n * R00200 晚點付首頁\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var R00200=function R00200(){var history=useHistory();var _useForm=useForm({defaultValues:{installmentType:'1',NewBalance:0},resolver:yupResolver(entranceSchema)}),handleSubmit=_useForm.handleSubmit,control=_useForm.control,reset=_useForm.reset;var installmentTypeOptions=[{label:'單筆',value:'1'},{label:'總額',value:'2'}];var showInsufficientContent=function showInsufficientContent(type){return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u60A8\\u76EE\\u524D\\u6C92\\u6709\\u53EF\\u5206\\u671F\\u7684\\u6D88\\u8CBB\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"(\",type==='1'?'消費全額':'單筆消費限額',\"\\u9700\\u90543,000\\u5143\\u4EE5\\u4E0A)\"]})]});};var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var newBalance,installmentType;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:newBalance=_ref.newBalance,installmentType=_ref.installmentType;if(!(!newBalance||newBalance<3000)){_context.next=4;break;}showError(showInsufficientContent(installmentType));return _context.abrupt(\"return\");case 4:history.push('/R002001',{installmentType:installmentType,installmentData:''});// TODO: 需帶參數進下一頁\ncase 5:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$queryCardBill,newBalance;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return queryCardBill(getThisMonth());case 2:_yield$queryCardBill=_context2.sent;newBalance=_yield$queryCardBill.newBalance;reset({newBalance:newBalance,installmentType:'1'});case 5:case\"end\":return _context2.stop();}}},_callee2);})),[]);return/*#__PURE__*/_jsx(Layout,{title:\"\\u665A\\u9EDE\\u4ED8\",children:/*#__PURE__*/_jsx(InstalmentWrapper,{className:\"InstalmentWrapper\",small:true,children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"InstalmentWrapperText\",children:\"\\u9EDE\\u9078\\u7533\\u8ACB\\u665A\\u9EDE\\u4ED8\\u9805\\u76EE\"}),/*#__PURE__*/_jsx(RadioGroupField,{name:\"installmentType\",control:control,options:installmentTypeOptions}),/*#__PURE__*/_jsx(Accordion,{space:\"both\",children:/*#__PURE__*/_jsx(R00200AccordionContent2,{})})]}),/*#__PURE__*/_jsx(FEIBButton,{type:\"submit\",children:\"\\u4E0B\\u4E00\\u6B65\"})]})})});};export default R00200;","map":{"version":3,"names":["useEffect","useHistory","useForm","yupResolver","showError","getThisMonth","Accordion","Layout","FEIBButton","RadioGroupField","queryCardBill","InstalmentWrapper","entranceSchema","R00200AccordionContent2","R00200","history","defaultValues","installmentType","NewBalance","resolver","handleSubmit","control","reset","installmentTypeOptions","label","value","showInsufficientContent","type","textAlign","onSubmit","newBalance","push","installmentData"],"sources":["C:/Users/allen/git/app2-webview/src/pages/R00200_Instalment/R00200.js"],"sourcesContent":["import { useEffect } from 'react';\r\nimport { useHistory } from 'react-router';\r\nimport { useForm } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\n\r\nimport { showError } from 'utilities/MessageModal';\r\nimport { getThisMonth } from 'utilities/MonthGenerator';\r\nimport Accordion from 'components/Accordion';\r\nimport Layout from 'components/Layout/Layout';\r\nimport { FEIBButton } from 'components/elements';\r\nimport { RadioGroupField } from 'components/Fields/radioGroupField';\r\n\r\nimport { queryCardBill } from './api';\r\nimport InstalmentWrapper from './R00200.style';\r\nimport { entranceSchema } from './validationSchema';\r\nimport { R00200AccordionContent2 } from './utils';\r\n\r\n/**\r\n * R00200 晚點付首頁\r\n */\r\n\r\nconst R00200 = () => {\r\n  const history = useHistory();\r\n\r\n  const {handleSubmit, control, reset } = useForm({\r\n    defaultValues: {installmentType: '1', NewBalance: 0 },\r\n    resolver: yupResolver(entranceSchema),\r\n  });\r\n\r\n  const installmentTypeOptions = [{label: '單筆', value: '1'}, {label: '總額', value: '2'}];\r\n\r\n  const showInsufficientContent = (type) => (\r\n    <div style={{ textAlign: 'center' }}>\r\n      <p>您目前沒有可分期的消費</p>\r\n      <p>\r\n        (\r\n        {type === '1' ? '消費全額' : '單筆消費限額'}\r\n        需達3,000元以上)\r\n      </p>\r\n    </div>\r\n  );\r\n\r\n  const onSubmit = async ({ newBalance, installmentType }) => {\r\n    if (!newBalance || newBalance < 3000) {\r\n      showError(showInsufficientContent(installmentType));\r\n      return;\r\n    }\r\n\r\n    history.push('/R002001', { installmentType, installmentData: '' }); // TODO: 需帶參數進下一頁\r\n  };\r\n\r\n  useEffect(async () => {\r\n    // TODO 目前不確定 晚點付 要打哪一支 API 取得應繳資訊，先以 queryCardBill 進行測試\r\n    const { newBalance } = await queryCardBill(getThisMonth());\r\n    reset({ newBalance, installmentType: '1' });\r\n  }, []);\r\n\r\n  return (\r\n    <Layout title=\"晚點付\">\r\n      <InstalmentWrapper className=\"InstalmentWrapper\" small>\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <div>\r\n            <div className=\"InstalmentWrapperText\">點選申請晚點付項目</div>\r\n            <RadioGroupField\r\n              name=\"installmentType\"\r\n              control={control}\r\n              options={installmentTypeOptions}\r\n            />\r\n            <Accordion space=\"both\">\r\n              {/* TODO 目前 hardcode，注意事項是否應從後端取得 */}\r\n              <R00200AccordionContent2 />\r\n            </Accordion>\r\n          </div>\r\n          <FEIBButton type=\"submit\">下一步</FEIBButton>\r\n        </form>\r\n      </InstalmentWrapper>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default R00200;\r\n"],"mappings":"0PAAA,OAASA,SAAS,KAAQ,OAAO,CACjC,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,OAAO,KAAQ,iBAAiB,CACzC,OAASC,WAAW,KAAQ,yBAAyB,CAErD,OAASC,SAAS,KAAQ,wBAAwB,CAClD,OAASC,YAAY,KAAQ,0BAA0B,CACvD,MAAOC,UAAS,KAAM,sBAAsB,CAC5C,MAAOC,OAAM,KAAM,0BAA0B,CAC7C,OAASC,UAAU,KAAQ,qBAAqB,CAChD,OAASC,eAAe,KAAQ,mCAAmC,CAEnE,OAASC,aAAa,KAAQ,OAAO,CACrC,MAAOC,kBAAiB,KAAM,gBAAgB,CAC9C,OAASC,cAAc,KAAQ,oBAAoB,CACnD,OAASC,uBAAuB,KAAQ,SAAS,CAEjD;AACA;AACA,GAFA,wFAIA,GAAMC,OAAM,CAAG,QAATA,OAAM,EAAS,CACnB,GAAMC,QAAO,CAAGd,UAAU,EAAE,CAE5B,aAAwCC,OAAO,CAAC,CAC9Cc,aAAa,CAAE,CAACC,eAAe,CAAE,GAAG,CAAEC,UAAU,CAAE,CAAE,CAAC,CACrDC,QAAQ,CAAEhB,WAAW,CAACS,cAAc,CACtC,CAAC,CAAC,CAHKQ,YAAY,UAAZA,YAAY,CAAEC,OAAO,UAAPA,OAAO,CAAEC,KAAK,UAALA,KAAK,CAKnC,GAAMC,uBAAsB,CAAG,CAAC,CAACC,KAAK,CAAE,IAAI,CAAEC,KAAK,CAAE,GAAG,CAAC,CAAE,CAACD,KAAK,CAAE,IAAI,CAAEC,KAAK,CAAE,GAAG,CAAC,CAAC,CAErF,GAAMC,wBAAuB,CAAG,QAA1BA,wBAAuB,CAAIC,IAAI,qBACnC,aAAK,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAS,CAAE,wBAClC,yFAAkB,cAClB,yBAEGD,IAAI,GAAK,GAAG,CAAG,MAAM,CAAG,QAAQ,0CAE/B,GACA,EACP,CAED,GAAME,SAAQ,6FAAG,wKAASC,UAAU,MAAVA,UAAU,CAAEb,eAAe,MAAfA,eAAe,MAC/C,CAACa,UAAU,EAAIA,UAAU,CAAG,IAAI,0BAClC1B,SAAS,CAACsB,uBAAuB,CAACT,eAAe,CAAC,CAAC,CAAC,wCAItDF,OAAO,CAACgB,IAAI,CAAC,UAAU,CAAE,CAAEd,eAAe,CAAfA,eAAe,CAAEe,eAAe,CAAE,EAAG,CAAC,CAAC,CAAE;AAAA,sDACrE,kBAPKH,SAAQ,6CAOb,CAED7B,SAAS,wEAAC,qMAEqBU,cAAa,CAACL,YAAY,EAAE,CAAC,4CAAlDyB,UAAU,sBAAVA,UAAU,CAClBR,KAAK,CAAC,CAAEQ,UAAU,CAAVA,UAAU,CAAEb,eAAe,CAAE,GAAI,CAAC,CAAC,CAAC,wDAC7C,GAAE,EAAE,CAAC,CAEN,mBACE,KAAC,MAAM,EAAC,KAAK,CAAC,oBAAK,uBACjB,KAAC,iBAAiB,EAAC,SAAS,CAAC,mBAAmB,CAAC,KAAK,4BACpD,cAAM,QAAQ,CAAEG,YAAY,CAACS,QAAQ,CAAE,wBACrC,oCACE,YAAK,SAAS,CAAC,uBAAuB,oEAAgB,cACtD,KAAC,eAAe,EACd,IAAI,CAAC,iBAAiB,CACtB,OAAO,CAAER,OAAQ,CACjB,OAAO,CAAEE,sBAAuB,EAChC,cACF,KAAC,SAAS,EAAC,KAAK,CAAC,MAAM,uBAErB,KAAC,uBAAuB,IAAG,EACjB,GACR,cACN,KAAC,UAAU,EAAC,IAAI,CAAC,QAAQ,gCAAiB,GACrC,EACW,EACb,CAEb,CAAC,CAED,cAAeT,OAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}