{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable react/jsx-max-props-per-line */ /* eslint-disable react/jsx-first-prop-new-line */ /* eslint-disable no-use-before-define */import React,{useEffect,useReducer,useState}from'react';import{useHistory}from'react-router';import{useDispatch}from'react-redux';import{useForm,Controller}from'react-hook-form';import*as yup from'yup';import{yupResolver}from'@hookform/resolvers/yup';import{RadioGroup}from'@material-ui/core';import Layout from'components/Layout/Layout';import{FEIBTabContext,FEIBTabList,FEIBTab,FEIBTabPanel,FEIBInputLabel,FEIBInput,FEIBErrorMessage,FEIBButton,FEIBRadioLabel,FEIBRadio,FEIBSelect,FEIBOption}from'components/elements';import AccountOverview from'components/AccountOverview/AccountOverview';import DatePicker from'components/DatePicker';import DateRangePicker from'components/DateRangePicker';import Accordion from'components/Accordion';import BankCodeInput from'components/BankCodeInput';import MemberAccountCard from'components/MemberAccountCard';import{setWaittingVisible}from'stores/reducers/ModalReducer';import{showError,showInfo,showPrompt}from'utilities/MessageModal';import{loadFuncParams,startFunc,closeFunc}from'utilities/AppScriptProxy';import{numberToChinese}from'utilities/Generator';import{getAccountBonus,getAccountsList}from'utilities/CacheData';import{ChangeMemberIcon}from'assets/images/icons';import TransferWrapper from'./D00100.style';import D00100AccordionContent from'./D00100_AccordionContent';/**\r\n * 轉帳首頁\r\n * @param {*} { state } 是由轉帳確認頁(D001001)或轉帳結果頁(D001002)在 goBack 時再傳回來的 Model 資料。\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Transfer=function Transfer(props){var _model$transOut,_model$transOut2,_startFuncParams$tran2,_accounts$at,_errors$transIn,_errors$transIn$bank,_errors$transIn3,_errors$transIn3$acco,_errors$amount,_errors$booking,_errors$booking$trans,_errors$booking2,_errors$booking2$tran,_errors$booking3,_errors$booking3$cycl,_errors$booking4,_errors$booking4$cycl;var location=props.location;var state=location.state;var history=useHistory();var dispatch=useDispatch();var _useReducer=useReducer(function(x){return x+1;},0),_useReducer2=_slicedToArray(_useReducer,2),forceUpdate=_useReducer2[1];var _useState=useState(),_useState2=_slicedToArray(_useState,2),model=_useState2[0],setModel=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),accounts=_useState4[0],setAccounts=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),selectedAccountIdx=_useState6[0],setSelectedAccountIdx=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),amountText=_useState8[0],setAmountText=_useState8[1];// 轉帳金額的輸出文字。\nvar _useState9=useState([10000,30000,50000]),_useState10=_slicedToArray(_useState9,2),tranferQuota=_useState10[0],setTranferQuota=_useState10[1];// 目前帳戶的轉帳限額。\nvar transTypes=['一般轉帳','常用轉帳','約定轉帳','社群轉帳'];var cycleWeekly=['周日','周一','周二','周三','周四','周五','周六'];var cycleMonthly=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,'29*','30*','31*'];var datePickerLimit={// 用來限制設定選擇日期時的範圍。\nminDate:new Date(new Date().setDate(new Date().getDate()+1)),// 預約轉帳只能從次日開始。\nmaxDate:new Date(new Date().setFullYear(new Date().getFullYear()+2))// 二年內。\n};// Form 欄位名稱。\nvar idTransIn='transIn';var idTransType='transIn.type';var idTransInBank='transIn.bank';var idTransInAcct='transIn.account';var idAmount='amount';var idMode='booking.mode';var idMultiTimes='booking.multiTimes';var idTransDate='booking.transDate';var idTransRange='booking.transRange';var idCycleMode='booking.cycleMode';var idCycleTime='booking.cycleTiming';var idMemo='memo';/**\r\n   * 表單資料驗證規則\r\n   */var schema=yup.object().shape({transIn:yup.object().shape({type:yup.number().min(0).max(3).required(),bank:yup.string().when('type',function(type,s){return type===0?s.required():s.nullable();}),account:yup.string().when('type',function(type,s){return type===0?s.required().min(10).max(14):s.nullable();}),freqAcct:yup.object().when('type',function(type,s){return type===1?s.required():s.nullable();}),regAcct:yup.object().when('type',function(type,s){return type===2?s.required():s.nullable();})}),amount:yup.string().required(),booking:yup.object().shape({mode:yup.number().min(0).max(1).required(),multiTimes:yup.string().required().length(1).oneOf(['1','*']),transDate:yup.date().when(['mode','multiTimes'],function(mode,multiTimes,s){return mode===1&&multiTimes==='1'?s.typeError('請指定交易日期'):s.nullable();}),transRange:yup.array().transform(function(v){return v!==null&&v!==void 0?v:[];}).when('multiTimes',function(multiTimes,s){return multiTimes==='*'?s.length(2):s.nullable();}),cycleMode:yup.number().when('multiTimes',function(multiTimes,s){return multiTimes==='*'?s.required().min(1).max(2):s.nullable();}),cycleTiming:yup.number().when('multiTimes',function(multiTimes,s){return multiTimes==='*'?s.when('cycleMode',function(cycleMode,s1){return cycleMode===1?s1.required().min(0).max(6):s1.required().min(1).max(31);}):s.nullable();})})});/**\r\n   *- 表單資料\r\n   */ // eslint-disable-next-line object-curly-newline\nvar _useForm=useForm({resolver:yupResolver(schema),defaultValues:{transOut:{account:null,// 轉出帳號\nbalance:null,// 帳戶餘額\nalias:null,// TODO 帳戶別名\nfreeTransfer:null,// 免費跨轉次數\nfreeTransferRemain:null// 免費跨轉剩餘次數\n},transIn:{// 轉入帳戶\ntype:0,// 0.一般轉帳, 1.常用轉帳, 2.約定轉帳, 3.社群轉帳\nbank:undefined,// 轉入帳戶的銀行\naccount:'',// 轉入帳戶的帳號\nfreqAcct:undefined,// 目前選擇的 常用帳號\nregAcct:undefined// 目前選擇的 約定帳號\n},amount:undefined,// 轉出金額\nbooking:{// 「預約轉帳」資訊\nmode:0,// 0.立即轉帳, 1.預約轉帳\nmultiTimes:'1',// 1.單次, *.多次\ntransDate:null,// 轉帳日期，multiTimes='1'時。\ntransRange:null,// 轉帳日期區間，multiTimes='*'時。\ncycleMode:1,// 交易頻率: 1.每周, 2.每月\ncycleTiming:0,// 交易週期: 〔 0~6: 周日~周六 〕或〔 1~31: 每月1~31〕, 月底(29/30/31)會加警示。\ntransTimes:0// 預約轉帳次數。 【註】在 onSubmit 時計算並寫入。\n},memo:''// 備註\n}}),control=_useForm.control,reset=_useForm.reset,handleSubmit=_useForm.handleSubmit,getValues=_useForm.getValues,setValue=_useForm.setValue,watch=_useForm.watch,trigger=_useForm.trigger,setFocus=_useForm.setFocus,errors=_useForm.formState.errors;// 透過 startFunc 啟動轉帳時，由前一個功能提供的參數。\n// NOTE 只要其中的欄位不是 null，就鎖定不允許變更。\nvar _useState11=useState({transOut:null,// 轉出帳號,\ntransIn:{bank:null,// 轉入銀行,\naccount:null// 轉入帳號\n},amount:0,// 轉帳金額,\nmemo:''// 備註,\n}),_useState12=_slicedToArray(_useState11,2),startFuncParams=_useState12[0],setStartFuncParams=_useState12[1];/**\r\n   * 初始化\r\n   */useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(setWaittingVisible(true));// 取得帳號基本資料，不含跨轉優惠次數，且餘額「非即時」。\n// NOTE 使用非同步方式更新畫面，一開始會先顯示帳戶基本資料，待取得跨轉等資訊時再更新一次畫面。\ngetAccountsList('MSC',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(items){var _mData$selectedAccoun,accts,mData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(items.length===0)){_context.next=5;break;}_context.next=3;return showPrompt('您還沒有任何台幣存款帳戶，請在系統關閉此功能後，立即申請。',function(){return closeFunc();});case 3:_context.next=17;break;case 5:accts=items;// TODO .filter((acct) => acct.transable); // 排除 transable = false 的帳戶。\nsetAccounts(accts);// 從 D00100_1 返回時會以 state 傳回原 model\n_context.t0=state;if(_context.t0){_context.next=12;break;}_context.next=11;return processStartParams(accts);case 11:_context.t0=_context.sent;case 12:mData=_context.t0;setModel(mData);setSelectedAccountIdx((_mData$selectedAccoun=mData.selectedAccountIdx)!==null&&_mData$selectedAccoun!==void 0?_mData$selectedAccoun:0);// Swiper 切回原本的 Slide\n// 將 Model 資料填入 UI Form 的對應欄位。\n// reset(mData);\n// 使用前值 formValues 避免所有 defaultValues 都被 mData 覆蓋掉\nreset(function(formValues){return _objectSpread(_objectSpread({},formValues),mData);});dispatch(setWaittingVisible(false));case 17:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());case 2:case\"end\":return _context2.stop();}}},_callee2);})),[]);/**\r\n   * 處理 Function Controller 提供的啟動參數。\r\n   * @param {[*]} accts\r\n   * @returns {Promise<*>} 包含 startFunc 提供的參數的 Model 物件。\r\n   */var processStartParams=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(accts){var params;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return loadFuncParams();case 2:params=_context3.sent;if(params){_context3.next=5;break;}return _context3.abrupt(\"return\",getValues());case 5:if(!params.response){_context3.next=10;break;}if(params.transIn.type===1)params.transIn.freqAcct=params.response;if(params.transIn.type===2)params.transIn.regAcct=params.response;delete params.response;return _context3.abrupt(\"return\",params);case 10:_context3.next=12;return convertStartParamsToModel(accts,params);case 12:return _context3.abrupt(\"return\",_context3.sent);case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function processStartParams(_x2){return _ref3.apply(this,arguments);};}();/**\r\n   * 將啟動參數轉為 Model 物件，包含只保留指定帳號，以及將預設值資填入畫面。\r\n   * @param {[*]} accts\r\n   * @param {*} params 前一功能提供的參數。\r\n   * @returns {Promise<*>} 包含 startFunc 提供的參數的 Model 物件。\r\n   */var convertStartParamsToModel=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(accts,params){var _params$transOut;var initModel,transOutAccount,index,transIn;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:transOutAccount=(_params$transOut=params.transOut)!==null&&_params$transOut!==void 0?_params$transOut:'';// 若啟動參數有指定預設帳號(transOut)時，則不能切換轉出帳號，只保留此帳號卡。\n// 若未指定時，則維持所有帳號供使用者選擇。\nif(!(transOutAccount.constructor===String&&!!transOutAccount)){_context4.next=13;break;}// NOTE 用建構式來判斷資料型別！\nindex=accts.findIndex(function(acct){return acct.accountNo===transOutAccount;});if(!(index<0)){_context4.next=7;break;}_context4.next=6;return showError(\"\\u60A8\\u7684\\u5E33\\u6236\\u4E2D\\u4E26\\u6C92\\u6709\\u6307\\u5B9A\\u7684\\u8F49\\u51FA\\u5E33\\u865F(\".concat(transOutAccount,\")\\uFF0C\\u8ACB\\u6D3D\\u5BA2\\u670D\\u4EBA\\u54E1\\u3002\"),function(){return closeFunc();});case 6:return _context4.abrupt(\"return\",null);case 7:// 從其他功能(C00300)啟動轉帳時提供的參數。\n// { transOut: 預設轉出帳號 }\nsetStartFuncParams(params);// 為了鎖住欄位，所以要另外保存下來。\ninitModel=getValues();// 雖然此時Form並沒有資料，但可以為傳回的 Model 建立屬性，使UI不會出錯\ninitModel.selectedAccountIdx=index;// 將只有帳號字串，改為 model 的 transOut 物件。\ninitModel.transOut.account=transOutAccount;_context4.next=16;break;case 13:// 從 QRCode/D00500/D00600 返回時，才會進這段邏輯。\ntransIn=params.transIn;if(!transIn.freqAcct&&!transIn.regAcct)transIn.type=0;initModel=params;case 16:return _context4.abrupt(\"return\",initModel);case 17:case\"end\":return _context4.stop();}}},_callee4);}));return function convertStartParamsToModel(_x3,_x4){return _ref4.apply(this,arguments);};}();/**\r\n   * 保存資料，進入確認頁。\r\n   */var onSubmit=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(values){var newModel,amount,booking,quota,transTimes,param;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:newModel=_objectSpread(_objectSpread(_objectSpread({},model),values),{},{transOut:model.transOut// NOTE 因為在切換帳戶卡時，會取得餘額等資訊。\n});amount=newModel.amount,booking=newModel.booking;// 單筆轉帳限額檢查\nif(!(amount>tranferQuota[0])){_context5.next=8;break;}quota=new Intl.NumberFormat('en-US').format(tranferQuota[0]);_context5.next=6;return showInfo(\"\\u60A8\\u7684\\u8F49\\u5E33\\u91D1\\u984D\\u5DF2\\u8D85\\u904E\\u55AE\\u7B46\\u8F49\\u5E33\\u9650\\u984D(\".concat(quota,\")\\u4E0A\\u9650\\uFF1B\\u82E5\\u60A8\\u9700\\u8981\\u63D0\\u9AD8\\u8F49\\u5E33\\u984D\\u5EA6\\uFF0C\\u53EF\\u900F\\u904E\\u81EA\\u7136\\u4EBA\\u6191\\u8B49\\u5B8C\\u6210\\u5E33\\u6236\\u5347\\u7D1A\\u6210\\u3010\\u4E00\\u985E\\u5E33\\u6236\\u3011\\u3002\"));case 6:setFocus(idAmount);return _context5.abrupt(\"return\");case 8:// idCycleTime 防呆，調整起始日期\ntransTimes=checkTransDate(booking);if(!(booking.mode===1&&transTimes<=0)){_context5.next=14;break;}_context5.next=12;return showInfo('您指定的交易時間範圍內，並不會有任何轉帳交易發生！請重新調整交易時間範圍、交易頻率或週期。');case 12:setFocus(idTransRange);return _context5.abrupt(\"return\");case 14:param=_objectSpread(_objectSpread({},newModel),{},{booking:_objectSpread(_objectSpread({},newModel.booking),{},{transTimes:transTimes// 預約轉帳次數。\n}),selectedAccountIdx:selectedAccountIdx});setModel(param);// 進行轉帳確認。\nhistory.push('/D001001',param);case 17:case\"end\":return _context5.stop();}}},_callee5);}));return function onSubmit(_x5){return _ref5.apply(this,arguments);};}();/**\r\n   * 計算預約交易日期區間將會發生的轉帳次數。\r\n   * @returns 預估的轉帳次數。\r\n   */var checkTransDate=function checkTransDate(booking){if(booking.multiTimes==='1')return 1;// transRange: 轉帳日期區間，multiTimes='*'時。\n// cycleMode: 交易頻率: 1.每周, 2.每月\n// cycleTiming: 交易週期: 〔 0~6: 周日~周六 〕或〔 1~28: 每月1~31 〕\nvar cycleMode=booking.cycleMode,cycleTiming=booking.cycleTiming,transRange=booking.transRange;var startDate=new Date(transRange[0]);// 要另建新日期物件，否則原值會被改掉。\nvar endDate=new Date(transRange[1]);// 同上。\nif(cycleMode===1){// 當起(迄)日不是指定的WeekDay時，計算差異天數，將起(迄)日改為第一(最後)個預約轉帳日，再計算次數。\nvar diffDays=(7+(cycleTiming-startDate.getDay()))%7;if(diffDays>=0)startDate.setDate(startDate.getDate()+diffDays);diffDays=(7+(endDate.getDay()-cycleTiming))%7;if(diffDays>=0)endDate.setDate(endDate.getDate()-diffDays);var _times=(endDate-startDate)/(7*24*60*60*1000)+1;return _times;}// 計算按月轉帳的總次數。\nvar times=0;for(var d0=new Date(startDate);;){var d1=new Date(d0);d1.setDate(cycleTiming);if(d1>=d0){if(d1>endDate)break;times++;}// 下個月的起日，要用 1日是因為，要避免次月沒有 29/30/31 時，月份會再進位的問題。\nd0.setDate(1);d0.setMonth(d0.getMonth()+1);}return times;};/**\r\n   * 當切換轉帳類型時，變更 HookForm 的值；並在尚未指定常用/約定轉入對象時，自動開啟選擇常用/約定轉入對象的功能。\r\n   * @param {*} e UIElement event data, 若當 null 表示手動強制執行。\r\n   * @param {*} selectType 0.一般轉帳, 1.常用轉帳, 2.約定轉帳, 3.社群轉帳\r\n   */var onTransTypeChanged=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(e,selectType){var type,_getValues,transIn,funcId,freqAcct,regAcct,selectAccount,params;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:type=parseInt(selectType,10);setValue(idTransType,type);_getValues=getValues(),transIn=_getValues.transIn;// 尚未指定常用/約定轉入對象時，自動開啟選擇常用/約定轉入對象的功能。\nfuncId=null;freqAcct=transIn.freqAcct,regAcct=transIn.regAcct;if(type===1&&(!freqAcct||!e))funcId='D00500';if(type===2&&(!regAcct||!e))funcId='D00600';if(!(funcId!==null)){_context6.next=15;break;}selectAccount=type===1?freqAcct:regAcct;// 指定預設為已選取狀態的帳號\nparams={selectorMode:true,// 隱藏 Home 圖示\ndefaultAccount:selectAccount===null||selectAccount===void 0?void 0:selectAccount.accountNo,bindAccount:model.transOut.account// 提供給 D00600 只列出此帳號設定的約轉帳號清單。\n};model.transIn=transIn;model.selectedAccountIdx=selectedAccountIdx;// 用在返回時將 Swiper 切回目前帳號\ndispatch(setWaittingVisible(true));_context6.next=15;return startFunc(funcId,params,model);case 15:case\"end\":return _context6.stop();}}},_callee6);}));return function onTransTypeChanged(_x6,_x7){return _ref6.apply(this,arguments);};}();/**\r\n   * 切換交易頻率時，將交易週期設為第一項。\r\n   */useEffect(function(){var _getValues2=getValues(),booking=_getValues2.booking;// 交易頻率(cycleMode): 1.每周, 2.每月\n// 交易週期(cycleTiming): 〔 0~6: 周日~周六 〕或〔 1~31: 每月1~31 〕\nsetValue(idCycleTime,booking.cycleMode===1?0:1);},[watch(idCycleMode)]);/**\r\n   * 調整輸出金額顯示格式。\r\n   */useEffect(function(){// 金額加千分號\nvar _getValues3=getValues(),amount=_getValues3.amount;var number=amount?amount.toString().replace(/[^\\d]/g,''):'';// 將所有(g)非數字(^\\d)字元，全部移除。\nvar formater=new Intl.NumberFormat('en-US');var newValue=formater.format(number);if(newValue!=='0'){setValue(idAmount,parseInt(number,10));setAmountText(\"$\".concat(newValue,\" \").concat(numberToChinese(amount)));}else{setValue(idAmount,'');setAmountText(null);}},[watch(idAmount)]);/**\r\n   * 轉入帳戶區(常用/約定/社群轉帳)\r\n   */var TransInAccountSelector=function TransInAccountSelector(){var _getValues4=getValues(idTransIn),freqAcct=_getValues4.freqAcct,regAcct=_getValues4.regAcct;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(FEIBTabPanel,{value:\"1\",children:[/*#__PURE__*/_jsx(FEIBInputLabel,{children:\"\\u8F49\\u5165\\u5E33\\u865F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"memberAccountCardArea\",children:[freqAcct&&/*#__PURE__*/_jsx(MemberAccountCard,{memberId:freqAcct.headshot,name:freqAcct.accountName,bankName:freqAcct.bankName,bankNo:freqAcct.bankId,account:freqAcct.accountNo,noBorder:true}),/*#__PURE__*/_jsx(\"div\",{className:\"changeMemberButton\",onClick:function onClick(){return onTransTypeChanged(null,1);},children:/*#__PURE__*/_jsx(ChangeMemberIcon,{})})]})]}),/*#__PURE__*/_jsxs(FEIBTabPanel,{value:\"2\",children:[/*#__PURE__*/_jsx(FEIBInputLabel,{children:\"\\u8F49\\u5165\\u5E33\\u865F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"memberAccountCardArea\",children:[regAcct&&/*#__PURE__*/_jsx(MemberAccountCard,{memberId:regAcct.headshot,name:regAcct.accountName,bankName:regAcct.bankName,bankNo:regAcct.bankId,account:regAcct.accountNo,noBorder:true}),/*#__PURE__*/_jsx(\"div\",{className:\"changeMemberButton\",onClick:function onClick(){return onTransTypeChanged(null,2);},children:/*#__PURE__*/_jsx(ChangeMemberIcon,{})})]})]}),/*#__PURE__*/_jsx(FEIBTabPanel,{value:\"3\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u793E\\u7FA4\\u8F49\\u5E33\"})})]});};/**\r\n   * 切換帳戶卡，變更 HookForm 轉出帳號相關資料，以及轉帳額度。\r\n   */useEffect(function(){var account=accounts===null||accounts===void 0?void 0:accounts.at(selectedAccountIdx);if(!account)return;// 頁面初始化時，不需要進來。\nmodel.transOut={account:account.accountNo,// 轉出帳號\nalias:account.alias,// 帳戶名稱，若有暱稱則會優先用暱稱; 會用在確認及執行這二頁。\nbalance:account.balance// 帳戶餘額\n};// 若還沒有取得 免費跨轉次數 則立即補上。\nif(!model.transOut.freeTransfer){// 下載 優存(利率/利息)資訊\ngetAccountBonus(account.accountNo,function(info){model.transOut=_objectSpread(_objectSpread({},model.transOut),{},{freeTransfer:account.freeTransfer=info.freeTransfer,freeTransferRemain:account.freeTransferRemain=info.freeTransferRemain});forceUpdate();});}// 單筆轉帳限額 (用於設置至轉出金額驗證規則)\n// dgType = 帳戶類別('  '.非數存帳號, '11'.臨櫃數存昇級一般, '12'.一之二類, ' 2'.二類, '32'.三之二類)\nvar quota=[50000,100000,200000];// 適用：一、二 類\nif(account.dgType==='32')quota=[10000,30000,50000];// else if (account.dgType === ' 2') quota = [50000, 100000, 200000];\n// else if (['11', '12'].indexOf(account.dgType)) quota = [50000, 100000, 200000];\nsetTranferQuota(quota);},[selectedAccountIdx]);/**\r\n   * 單筆轉帳限額 (用於設置至轉出金額驗證規則)\r\n   */var showTranferQuota=function showTranferQuota(){var transIn=getValues.transIn;if((transIn===null||transIn===void 0?void 0:transIn.type)!=='2'){var formater=new Intl.NumberFormat('en-US');var quota=tranferQuota.map(function(q){return formater.format(q);}).join('/');return/*#__PURE__*/_jsx(\"p\",{className:\"notice\",children:\"\\u55AE\\u7B46/\\u7576\\u65E5/\\u7576\\u6708\\u975E\\u7D04\\u5B9A\\u8F49\\u5E33\\u5269\\u9918\\u984D\\u5EA6: \".concat(quota)});}return null;};/**\r\n   * 輸出頁面\r\n   */return/*#__PURE__*/_jsx(Layout,{title:\"\\u53F0\\u5E63\\u8F49\\u5E33\",children:/*#__PURE__*/_jsxs(TransferWrapper,{$insufficient:!(model!==null&&model!==void 0&&(_model$transOut=model.transOut)!==null&&_model$transOut!==void 0&&_model$transOut.balance)||(model===null||model===void 0?void 0:(_model$transOut2=model.transOut)===null||_model$transOut2===void 0?void 0:_model$transOut2.balance)<=0,children:[/*#__PURE__*/_jsx(AccountOverview,{transferMode:true,accounts:accounts,defaultSlide:selectedAccountIdx,onAccountChanged:setSelectedAccountIdx}),/*#__PURE__*/_jsxs(\"div\",{className:\"transferServicesArea\",children:[/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(FEIBTabContext,{value:String(watch(idTransType)),children:[/*#__PURE__*/_jsx(FEIBTabList,{onChange:onTransTypeChanged,$type:\"fixed\",$size:\"small\",className:\"tabList\",children:transTypes.map(function(name,n){var _startFuncParams$tran;return/*#__PURE__*/ (// 當 startFuncParams 有預設轉入帳號時，不允許變更。\n_jsx(FEIBTab,{label:name,value:String(n),disabled:n!==0&&(startFuncParams===null||startFuncParams===void 0?void 0:(_startFuncParams$tran=startFuncParams.transIn)===null||_startFuncParams$tran===void 0?void 0:_startFuncParams$tran.account)||n===3},name));})}),/*#__PURE__*/_jsxs(FEIBTabPanel,{value:\"0\",children:[/*#__PURE__*/_jsx(BankCodeInput,{control:control,name:idTransInBank,value:getValues(idTransInBank),setValue:setValue,trigger:trigger,readonly:(startFuncParams===null||startFuncParams===void 0?void 0:(_startFuncParams$tran2=startFuncParams.transIn)===null||_startFuncParams$tran2===void 0?void 0:_startFuncParams$tran2.bank)||!(accounts!==null&&accounts!==void 0&&(_accounts$at=accounts.at(selectedAccountIdx))!==null&&_accounts$at!==void 0&&_accounts$at.balance),errorMessage:errors===null||errors===void 0?void 0:(_errors$transIn=errors.transIn)===null||_errors$transIn===void 0?void 0:(_errors$transIn$bank=_errors$transIn.bank)===null||_errors$transIn$bank===void 0?void 0:_errors$transIn$bank.message}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FEIBInputLabel,{htmlFor:idTransInAcct,children:\"\\u8F49\\u5165\\u5E33\\u865F\"}),/*#__PURE__*/_jsx(Controller,{control:control,name:idTransInAcct,render:function render(_ref7){var _errors$transIn2,_startFuncParams$tran3;var field=_ref7.field;return/*#__PURE__*/ (// 當 startFuncParams 有預設轉入帳號時，不允許變更\n_jsx(FEIBInput,_objectSpread(_objectSpread({},field),{},{placeholder:\"\\u8ACB\\u8F38\\u5165\",inputMode:\"numeric\",error:!!(errors!==null&&errors!==void 0&&(_errors$transIn2=errors.transIn)!==null&&_errors$transIn2!==void 0&&_errors$transIn2.account),inputProps:{maxLength:14,autoComplete:'off',disabled:startFuncParams===null||startFuncParams===void 0?void 0:(_startFuncParams$tran3=startFuncParams.transIn)===null||_startFuncParams$tran3===void 0?void 0:_startFuncParams$tran3.account}})));}}),/*#__PURE__*/_jsx(FEIBErrorMessage,{children:(_errors$transIn3=errors.transIn)===null||_errors$transIn3===void 0?void 0:(_errors$transIn3$acco=_errors$transIn3.account)===null||_errors$transIn3$acco===void 0?void 0:_errors$transIn3$acco.message})]})]}),TransInAccountSelector()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"customSpace\",children:[/*#__PURE__*/_jsx(FEIBInputLabel,{htmlFor:idAmount,children:\"\\u91D1\\u984D\"}),/*#__PURE__*/_jsx(Controller,{control:control,name:idAmount,render:function render(_ref8){var field=_ref8.field;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FEIBInput,_objectSpread(_objectSpread({},field),{},{placeholder:\"$0\\uFF08\\u96F6\\u5143\\uFF09\",inputMode:\"numeric\",error:!!(errors!==null&&errors!==void 0&&errors.amount),inputProps:{maxLength:9,autoComplete:'off',disabled:startFuncParams===null||startFuncParams===void 0?void 0:startFuncParams.amount}})),/*#__PURE__*/_jsx(\"div\",{className:\"balanceLayout\",children:amountText})]});}}),/*#__PURE__*/_jsx(FEIBErrorMessage,{children:(_errors$amount=errors.amount)===null||_errors$amount===void 0?void 0:_errors$amount.message}),showTranferQuota()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"transferMode\",children:[/*#__PURE__*/_jsx(FEIBInputLabel,{children:\"\\u8F49\\u5E33\\u985E\\u578B\"}),/*#__PURE__*/_jsx(Controller,{control:control,name:idMode,render:function render(_ref9){var field=_ref9.field;return/*#__PURE__*/_jsxs(RadioGroup,_objectSpread(_objectSpread({},field),{},{row:true,\"aria-label\":\"\\u8F49\\u5E33\\u985E\\u578B\",name:idMode,onChange:function onChange(e){return setValue(idMode,parseInt(e.target.value,10));},children:[/*#__PURE__*/_jsx(FEIBRadioLabel,{value:0,control:/*#__PURE__*/_jsx(FEIBRadio,{}),label:\"\\u7ACB\\u5373\",className:\"customWidth\"}),/*#__PURE__*/_jsx(FEIBRadioLabel,{value:1,control:/*#__PURE__*/_jsx(FEIBRadio,{}),label:\"\\u9810\\u7D04\"})]}));}}),watch(idMode)===1?/*#__PURE__*/_jsxs(\"div\",{className:\"reserveOption\",children:[/*#__PURE__*/_jsx(FEIBInputLabel,{htmlFor:idMultiTimes,children:\"\\u8F49\\u5E33\\u6B21\\u6578\"}),/*#__PURE__*/_jsx(Controller,{control:control,name:idMultiTimes,render:function render(_ref10){var field=_ref10.field;return/*#__PURE__*/_jsxs(FEIBSelect,_objectSpread(_objectSpread({},field),{},{name:idMultiTimes,children:[/*#__PURE__*/_jsx(FEIBOption,{value:\"1\",children:\"\\u4E00\\u6B21\"}),/*#__PURE__*/_jsx(FEIBOption,{value:\"*\",children:\"\\u591A\\u6B21\"})]}));}}),watch(idMultiTimes)==='1'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FEIBInputLabel,{className:\"datePickerLabel\",children:\"\\u4EA4\\u6613\\u6642\\u9593\"}),/*#__PURE__*/_jsx(DatePicker,_objectSpread({control:control,name:idTransDate},datePickerLimit)),/*#__PURE__*/_jsx(FEIBErrorMessage,{children:(_errors$booking=errors.booking)===null||_errors$booking===void 0?void 0:(_errors$booking$trans=_errors$booking.transDate)===null||_errors$booking$trans===void 0?void 0:_errors$booking$trans.message})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"dateRangePickerArea\",children:[/*#__PURE__*/_jsx(DateRangePicker,_objectSpread({control:control,name:idTransRange,label:\"\\u4EA4\\u6613\\u6642\\u9593\"},datePickerLimit)),/*#__PURE__*/_jsx(FEIBErrorMessage,{children:(_errors$booking2=errors.booking)===null||_errors$booking2===void 0?void 0:(_errors$booking2$tran=_errors$booking2.transRange)===null||_errors$booking2$tran===void 0?void 0:_errors$booking2$tran.message}),/*#__PURE__*/_jsxs(\"div\",{className:\"reserveMoreOption\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FEIBInputLabel,{htmlFor:idCycleMode,children:\"\\u4EA4\\u6613\\u983B\\u7387\"}),/*#__PURE__*/_jsx(Controller,{control:control,name:idCycleMode,render:function render(_ref11){var field=_ref11.field;return/*#__PURE__*/_jsxs(FEIBSelect,_objectSpread(_objectSpread({},field),{},{name:idCycleMode,children:[/*#__PURE__*/_jsx(FEIBOption,{value:1,children:\"\\u6BCF\\u9031\"}),/*#__PURE__*/_jsx(FEIBOption,{value:2,children:\"\\u6BCF\\u6708\"})]}));}}),/*#__PURE__*/_jsx(FEIBErrorMessage,{children:(_errors$booking3=errors.booking)===null||_errors$booking3===void 0?void 0:(_errors$booking3$cycl=_errors$booking3.cycleMode)===null||_errors$booking3$cycl===void 0?void 0:_errors$booking3$cycl.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FEIBInputLabel,{htmlFor:idCycleTime,children:\"\\u4EA4\\u6613\\u9031\\u671F\"}),/*#__PURE__*/_jsx(Controller,{control:control,name:idCycleTime,render:function render(_ref12){var field=_ref12.field;return/*#__PURE__*/_jsx(FEIBSelect,_objectSpread(_objectSpread({},field),{},{name:idCycleTime,children:[cycleWeekly,cycleMonthly][getValues(idCycleMode)-1].map(function(s,n){// 交易週期: 〔 0~6: 周日~周六 〕或〔 1~28: 每月1~31 〕\nvar value=n+getValues(idCycleMode)-1;return/*#__PURE__*/_jsx(FEIBOption,{value:value,children:s},value);})}));}}),/*#__PURE__*/_jsxs(FEIBErrorMessage,{children:[watch(idCycleTime)>=29?/*#__PURE__*/_jsxs(_Fragment,{children:[\"* \\u53EF\\u80FD\\u9806\\u5EF6\\u81F3\\u6B21\\u6708\\u4E00\\u65E5\",/*#__PURE__*/_jsx(\"br\",{})]}):null,(_errors$booking4=errors.booking)===null||_errors$booking4===void 0?void 0:(_errors$booking4$cycl=_errors$booking4.cycleTiming)===null||_errors$booking4$cycl===void 0?void 0:_errors$booking4$cycl.message]})]})]})]})]}):/*#__PURE__*/ // 為了保持與備註間的間距。\n_jsx(\"p\",{style:{height:'1.8rem'}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FEIBInputLabel,{htmlFor:idMemo,children:\"\\u5099\\u8A3B\"}),/*#__PURE__*/_jsx(Controller,{control:control,name:idMemo,render:function render(_ref13){var field=_ref13.field;return/*#__PURE__*/_jsx(FEIBInput,_objectSpread(_objectSpread({},field),{},{placeholder:\"\\u8ACB\\u8F38\\u5165\",inputProps:{maxLength:20,autoComplete:'off'}}));}}),/*#__PURE__*/_jsx(FEIBErrorMessage,{})]})]}),/*#__PURE__*/_jsx(Accordion,{space:\"both\",children:/*#__PURE__*/_jsx(D00100AccordionContent,{})}),/*#__PURE__*/_jsx(\"p\",{className:\"warningText\",children:\"\\u964C\\u751F\\u96FB\\u8A71\\u5148\\u6C42\\u8B49\\uFF0C\\u8F49\\u5E33\\u4EA4\\u6613\\u9808\\u8B39\\u614E\"}),/*#__PURE__*/_jsx(\"div\",{className:\"transferButtonArea\",children:/*#__PURE__*/_jsx(FEIBButton,{onClick:handleSubmit(onSubmit),children:\"\\u8F49\\u5E33\"})})]})]})});};export default Transfer;","map":{"version":3,"names":["React","useEffect","useReducer","useState","useHistory","useDispatch","useForm","Controller","yup","yupResolver","RadioGroup","Layout","FEIBTabContext","FEIBTabList","FEIBTab","FEIBTabPanel","FEIBInputLabel","FEIBInput","FEIBErrorMessage","FEIBButton","FEIBRadioLabel","FEIBRadio","FEIBSelect","FEIBOption","AccountOverview","DatePicker","DateRangePicker","Accordion","BankCodeInput","MemberAccountCard","setWaittingVisible","showError","showInfo","showPrompt","loadFuncParams","startFunc","closeFunc","numberToChinese","getAccountBonus","getAccountsList","ChangeMemberIcon","TransferWrapper","D00100AccordionContent","Transfer","props","location","state","history","dispatch","x","forceUpdate","model","setModel","accounts","setAccounts","selectedAccountIdx","setSelectedAccountIdx","amountText","setAmountText","tranferQuota","setTranferQuota","transTypes","cycleWeekly","cycleMonthly","datePickerLimit","minDate","Date","setDate","getDate","maxDate","setFullYear","getFullYear","idTransIn","idTransType","idTransInBank","idTransInAcct","idAmount","idMode","idMultiTimes","idTransDate","idTransRange","idCycleMode","idCycleTime","idMemo","schema","object","shape","transIn","type","number","min","max","required","bank","string","when","s","nullable","account","freqAcct","regAcct","amount","booking","mode","multiTimes","length","oneOf","transDate","date","typeError","transRange","array","transform","v","cycleMode","cycleTiming","s1","resolver","defaultValues","transOut","balance","alias","freeTransfer","freeTransferRemain","undefined","transTimes","memo","control","reset","handleSubmit","getValues","setValue","watch","trigger","setFocus","errors","formState","startFuncParams","setStartFuncParams","items","accts","processStartParams","mData","formValues","params","response","convertStartParamsToModel","transOutAccount","constructor","String","index","findIndex","acct","accountNo","initModel","onSubmit","values","newModel","quota","Intl","NumberFormat","format","checkTransDate","param","push","startDate","endDate","diffDays","getDay","times","d0","d1","setMonth","getMonth","onTransTypeChanged","e","selectType","parseInt","funcId","selectAccount","selectorMode","defaultAccount","bindAccount","toString","replace","formater","newValue","TransInAccountSelector","headshot","accountName","bankName","bankId","at","info","dgType","showTranferQuota","map","q","join","name","n","message","field","maxLength","autoComplete","disabled","target","value","height"],"sources":["C:/Users/allen/git/app2-webview/src/pages/D00100_NtdTransfer/D00100v2.js"],"sourcesContent":["/* eslint-disable react/jsx-max-props-per-line */\r\n/* eslint-disable react/jsx-first-prop-new-line */\r\n/* eslint-disable no-use-before-define */\r\nimport React, { useEffect, useReducer, useState } from 'react';\r\nimport { useHistory } from 'react-router';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport * as yup from 'yup';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport { RadioGroup } from '@material-ui/core';\r\n\r\nimport Layout from 'components/Layout/Layout';\r\nimport {\r\n  FEIBTabContext, FEIBTabList, FEIBTab, FEIBTabPanel,\r\n  FEIBInputLabel, FEIBInput, FEIBErrorMessage,\r\n  FEIBButton, FEIBRadioLabel, FEIBRadio, FEIBSelect, FEIBOption,\r\n} from 'components/elements';\r\nimport AccountOverview from 'components/AccountOverview/AccountOverview';\r\nimport DatePicker from 'components/DatePicker';\r\nimport DateRangePicker from 'components/DateRangePicker';\r\nimport Accordion from 'components/Accordion';\r\nimport BankCodeInput from 'components/BankCodeInput';\r\nimport MemberAccountCard from 'components/MemberAccountCard';\r\n\r\nimport { setWaittingVisible } from 'stores/reducers/ModalReducer';\r\nimport { showError, showInfo, showPrompt } from 'utilities/MessageModal';\r\nimport {\r\n  loadFuncParams, startFunc, closeFunc,\r\n} from 'utilities/AppScriptProxy';\r\nimport { numberToChinese } from 'utilities/Generator';\r\nimport { getAccountBonus, getAccountsList } from 'utilities/CacheData';\r\nimport { ChangeMemberIcon } from 'assets/images/icons';\r\nimport TransferWrapper from './D00100.style';\r\nimport D00100AccordionContent from './D00100_AccordionContent';\r\n\r\n/**\r\n * 轉帳首頁\r\n * @param {*} { state } 是由轉帳確認頁(D001001)或轉帳結果頁(D001002)在 goBack 時再傳回來的 Model 資料。\r\n */\r\nconst Transfer = (props) => {\r\n  const { location } = props;\r\n  const { state } = location;\r\n\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const [, forceUpdate] = useReducer((x) => x + 1, 0);\r\n\r\n  const [model, setModel] = useState();\r\n  const [accounts, setAccounts] = useState();\r\n  const [selectedAccountIdx, setSelectedAccountIdx] = useState();\r\n  const [amountText, setAmountText] = useState(); // 轉帳金額的輸出文字。\r\n  const [tranferQuota, setTranferQuota] = useState([10000, 30000, 50000]); // 目前帳戶的轉帳限額。\r\n\r\n  const transTypes = ['一般轉帳', '常用轉帳', '約定轉帳', '社群轉帳'];\r\n  const cycleWeekly = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];\r\n  const cycleMonthly = [\r\n    1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\r\n    21, 22, 23, 24, 25, 26, 27, 28, '29*', '30*', '31*'];\r\n  const datePickerLimit = { // 用來限制設定選擇日期時的範圍。\r\n    minDate: new Date(new Date().setDate(new Date().getDate() + 1)), // 預約轉帳只能從次日開始。\r\n    maxDate: new Date(new Date().setFullYear(new Date().getFullYear() + 2)), // 二年內。\r\n  };\r\n\r\n  // Form 欄位名稱。\r\n  const idTransIn = 'transIn';\r\n  const idTransType = 'transIn.type';\r\n  const idTransInBank = 'transIn.bank';\r\n  const idTransInAcct = 'transIn.account';\r\n  const idAmount = 'amount';\r\n  const idMode = 'booking.mode';\r\n  const idMultiTimes = 'booking.multiTimes';\r\n  const idTransDate = 'booking.transDate';\r\n  const idTransRange = 'booking.transRange';\r\n  const idCycleMode = 'booking.cycleMode';\r\n  const idCycleTime = 'booking.cycleTiming';\r\n  const idMemo = 'memo';\r\n\r\n  /**\r\n   * 表單資料驗證規則\r\n   */\r\n  const schema = yup.object().shape({\r\n    transIn: yup.object().shape({\r\n      type: yup.number().min(0).max(3).required(),\r\n      bank: yup.string().when('type', (type, s) => ((type === 0) ? s.required() : s.nullable())),\r\n      account: yup.string().when('type', (type, s) => ((type === 0) ? s.required().min(10).max(14) : s.nullable())),\r\n      freqAcct: yup.object().when('type', (type, s) => ((type === 1) ? s.required() : s.nullable())),\r\n      regAcct: yup.object().when('type', (type, s) => ((type === 2) ? s.required() : s.nullable())),\r\n    }),\r\n    amount: yup.string().required(),\r\n    booking: yup.object().shape({\r\n      mode: yup.number().min(0).max(1).required(),\r\n      multiTimes: yup.string().required().length(1).oneOf(['1', '*']),\r\n      transDate: yup.date().when(['mode', 'multiTimes'], (mode, multiTimes, s) => ((mode === 1 && multiTimes === '1') ? s.typeError('請指定交易日期') : s.nullable())),\r\n      transRange: yup.array().transform((v) => (v ?? [])).when('multiTimes', (multiTimes, s) => ((multiTimes === '*') ? s.length(2) : s.nullable())),\r\n      cycleMode: yup.number().when('multiTimes', (multiTimes, s) => ((multiTimes === '*') ? s.required().min(1).max(2) : s.nullable())),\r\n      cycleTiming: yup.number().when('multiTimes', (multiTimes, s) => ((multiTimes === '*')\r\n        ? s.when('cycleMode', (cycleMode, s1) => ((cycleMode === 1)\r\n          ? s1.required().min(0).max(6)\r\n          : s1.required().min(1).max(31)))\r\n        : s.nullable())),\r\n    }),\r\n  });\r\n\r\n  /**\r\n   *- 表單資料\r\n   */\r\n  // eslint-disable-next-line object-curly-newline\r\n  const { control, reset, handleSubmit, getValues, setValue, watch, trigger, setFocus, formState: { errors } } = useForm({\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      transOut: {\r\n        account: null, // 轉出帳號\r\n        balance: null, // 帳戶餘額\r\n        alias: null, // TODO 帳戶別名\r\n        freeTransfer: null, // 免費跨轉次數\r\n        freeTransferRemain: null, // 免費跨轉剩餘次數\r\n      },\r\n      transIn: { // 轉入帳戶\r\n        type: 0, // 0.一般轉帳, 1.常用轉帳, 2.約定轉帳, 3.社群轉帳\r\n        bank: undefined, // 轉入帳戶的銀行\r\n        account: '', // 轉入帳戶的帳號\r\n        freqAcct: undefined, // 目前選擇的 常用帳號\r\n        regAcct: undefined, // 目前選擇的 約定帳號\r\n      },\r\n      amount: undefined, // 轉出金額\r\n      booking: { // 「預約轉帳」資訊\r\n        mode: 0, // 0.立即轉帳, 1.預約轉帳\r\n        multiTimes: '1', // 1.單次, *.多次\r\n        transDate: null, // 轉帳日期，multiTimes='1'時。\r\n        transRange: null, // 轉帳日期區間，multiTimes='*'時。\r\n        cycleMode: 1, // 交易頻率: 1.每周, 2.每月\r\n        cycleTiming: 0, // 交易週期: 〔 0~6: 周日~周六 〕或〔 1~31: 每月1~31〕, 月底(29/30/31)會加警示。\r\n        transTimes: 0, // 預約轉帳次數。 【註】在 onSubmit 時計算並寫入。\r\n      },\r\n      memo: '', // 備註\r\n    },\r\n  });\r\n\r\n  // 透過 startFunc 啟動轉帳時，由前一個功能提供的參數。\r\n  // NOTE 只要其中的欄位不是 null，就鎖定不允許變更。\r\n  const [startFuncParams, setStartFuncParams] = useState({\r\n    transOut: null, // 轉出帳號,\r\n    transIn: {\r\n      bank: null, // 轉入銀行,\r\n      account: null, // 轉入帳號\r\n    },\r\n    amount: 0, // 轉帳金額,\r\n    memo: '', // 備註,\r\n  });\r\n\r\n  /**\r\n   * 初始化\r\n   */\r\n  useEffect(async () => {\r\n    dispatch(setWaittingVisible(true));\r\n\r\n    // 取得帳號基本資料，不含跨轉優惠次數，且餘額「非即時」。\r\n    // NOTE 使用非同步方式更新畫面，一開始會先顯示帳戶基本資料，待取得跨轉等資訊時再更新一次畫面。\r\n    getAccountsList('MSC', async (items) => { // M=台幣主帳戶、C=台幣子帳戶\r\n      if (items.length === 0) {\r\n        await showPrompt('您還沒有任何台幣存款帳戶，請在系統關閉此功能後，立即申請。', () => closeFunc());\r\n      } else {\r\n        const accts = items; // TODO .filter((acct) => acct.transable); // 排除 transable = false 的帳戶。\r\n        setAccounts(accts);\r\n        // 從 D00100_1 返回時會以 state 傳回原 model\r\n        const mData = (state || await processStartParams(accts));\r\n        setModel(mData);\r\n        setSelectedAccountIdx(mData.selectedAccountIdx ?? 0); // Swiper 切回原本的 Slide\r\n\r\n        // 將 Model 資料填入 UI Form 的對應欄位。\r\n        // reset(mData);\r\n        // 使用前值 formValues 避免所有 defaultValues 都被 mData 覆蓋掉\r\n        reset((formValues) => ({...formValues, ...mData}));\r\n        dispatch(setWaittingVisible(false));\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  /**\r\n   * 處理 Function Controller 提供的啟動參數。\r\n   * @param {[*]} accts\r\n   * @returns {Promise<*>} 包含 startFunc 提供的參數的 Model 物件。\r\n   */\r\n  const processStartParams = async (accts) => {\r\n    const params = await loadFuncParams();\r\n\r\n    // 未經由 Function Controller 取得資料時，延用原本的 model\r\n    if (!params) return getValues();\r\n\r\n    // 有 response 表示是從 D00500/D00600 返回，response 是傳回值；而 params 就是當時的 model\r\n    if (params.response) {\r\n      if (params.transIn.type === 1) params.transIn.freqAcct = params.response;\r\n      if (params.transIn.type === 2) params.transIn.regAcct = params.response;\r\n      delete params.response;\r\n      return params;\r\n    }\r\n\r\n    return await convertStartParamsToModel(accts, params);\r\n  };\r\n\r\n  /**\r\n   * 將啟動參數轉為 Model 物件，包含只保留指定帳號，以及將預設值資填入畫面。\r\n   * @param {[*]} accts\r\n   * @param {*} params 前一功能提供的參數。\r\n   * @returns {Promise<*>} 包含 startFunc 提供的參數的 Model 物件。\r\n   */\r\n  const convertStartParamsToModel = async (accts, params) => {\r\n    let initModel;\r\n    const transOutAccount = params.transOut ?? '';\r\n    // 若啟動參數有指定預設帳號(transOut)時，則不能切換轉出帳號，只保留此帳號卡。\r\n    // 若未指定時，則維持所有帳號供使用者選擇。\r\n    if (transOutAccount.constructor === String && !!transOutAccount) { // NOTE 用建構式來判斷資料型別！\r\n      const index = accts.findIndex((acct) => acct.accountNo === transOutAccount);\r\n      if (index < 0) {\r\n        // 查無指定的轉帳帳號，立即返回closeFunc。\r\n        await showError(`您的帳戶中並沒有指定的轉出帳號(${transOutAccount})，請洽客服人員。`, () => closeFunc());\r\n        return null;\r\n      }\r\n\r\n      // 從其他功能(C00300)啟動轉帳時提供的參數。\r\n      // { transOut: 預設轉出帳號 }\r\n      setStartFuncParams(params); // 為了鎖住欄位，所以要另外保存下來。\r\n\r\n      initModel = getValues(); // 雖然此時Form並沒有資料，但可以為傳回的 Model 建立屬性，使UI不會出錯\r\n      initModel.selectedAccountIdx = index;\r\n\r\n      // 將只有帳號字串，改為 model 的 transOut 物件。\r\n      initModel.transOut.account = transOutAccount;\r\n    } else {\r\n      // 從 QRCode/D00500/D00600 返回時，才會進這段邏輯。\r\n      const {transIn} = params;\r\n      if (!transIn.freqAcct && !transIn.regAcct) transIn.type = 0;\r\n      initModel = params;\r\n    }\r\n    return initModel;\r\n  };\r\n\r\n  /**\r\n   * 保存資料，進入確認頁。\r\n   */\r\n  const onSubmit = async (values) => {\r\n    const newModel = {\r\n      ...model,\r\n      ...values,\r\n      transOut: model.transOut, // NOTE 因為在切換帳戶卡時，會取得餘額等資訊。\r\n    };\r\n    const { amount, booking } = newModel;\r\n\r\n    // 單筆轉帳限額檢查\r\n    if (amount > tranferQuota[0]) {\r\n      const quota = new Intl.NumberFormat('en-US').format(tranferQuota[0]);\r\n      await showInfo(`您的轉帳金額已超過單筆轉帳限額(${quota})上限；若您需要提高轉帳額度，可透過自然人憑證完成帳戶升級成【一類帳戶】。`);\r\n      setFocus(idAmount);\r\n      return;\r\n    }\r\n\r\n    // idCycleTime 防呆，調整起始日期\r\n    const transTimes = checkTransDate(booking);\r\n    if (booking.mode === 1 && transTimes <= 0) { // 若立即轉帳則不需要檢查。\r\n      await showInfo('您指定的交易時間範圍內，並不會有任何轉帳交易發生！請重新調整交易時間範圍、交易頻率或週期。');\r\n      setFocus(idTransRange);\r\n      return;\r\n    }\r\n\r\n    const param = {\r\n      ...newModel,\r\n      booking: {\r\n        ...newModel.booking,\r\n        transTimes, // 預約轉帳次數。\r\n      },\r\n      selectedAccountIdx,\r\n    };\r\n    setModel(param);\r\n\r\n    // 進行轉帳確認。\r\n    history.push('/D001001', param);\r\n  };\r\n\r\n  /**\r\n   * 計算預約交易日期區間將會發生的轉帳次數。\r\n   * @returns 預估的轉帳次數。\r\n   */\r\n  const checkTransDate = (booking) => {\r\n    if (booking.multiTimes === '1') return 1;\r\n\r\n    // transRange: 轉帳日期區間，multiTimes='*'時。\r\n    // cycleMode: 交易頻率: 1.每周, 2.每月\r\n    // cycleTiming: 交易週期: 〔 0~6: 周日~周六 〕或〔 1~28: 每月1~31 〕\r\n    const { cycleMode, cycleTiming, transRange } = booking;\r\n    const startDate = new Date(transRange[0]); // 要另建新日期物件，否則原值會被改掉。\r\n    const endDate = new Date(transRange[1]); // 同上。\r\n\r\n    if (cycleMode === 1) {\r\n      // 當起(迄)日不是指定的WeekDay時，計算差異天數，將起(迄)日改為第一(最後)個預約轉帳日，再計算次數。\r\n      let diffDays = (7 + (cycleTiming - startDate.getDay())) % 7;\r\n      if (diffDays >= 0) startDate.setDate(startDate.getDate() + diffDays);\r\n\r\n      diffDays = (7 + (endDate.getDay() - cycleTiming)) % 7;\r\n      if (diffDays >= 0) endDate.setDate(endDate.getDate() - diffDays);\r\n\r\n      const times = (endDate - startDate) / (7 * 24 * 60 * 60 * 1000) + 1;\r\n      return times;\r\n    }\r\n\r\n    // 計算按月轉帳的總次數。\r\n    let times = 0;\r\n    for (let d0 = new Date(startDate); ;) {\r\n      const d1 = new Date(d0);\r\n      d1.setDate(cycleTiming);\r\n      if (d1 >= d0) {\r\n        if (d1 > endDate) break;\r\n        times++;\r\n      }\r\n      // 下個月的起日，要用 1日是因為，要避免次月沒有 29/30/31 時，月份會再進位的問題。\r\n      d0.setDate(1);\r\n      d0.setMonth(d0.getMonth() + 1);\r\n    }\r\n    return times;\r\n  };\r\n\r\n  /**\r\n   * 當切換轉帳類型時，變更 HookForm 的值；並在尚未指定常用/約定轉入對象時，自動開啟選擇常用/約定轉入對象的功能。\r\n   * @param {*} e UIElement event data, 若當 null 表示手動強制執行。\r\n   * @param {*} selectType 0.一般轉帳, 1.常用轉帳, 2.約定轉帳, 3.社群轉帳\r\n   */\r\n  const onTransTypeChanged = async (e, selectType) => {\r\n    const type = parseInt(selectType, 10);\r\n    setValue(idTransType, type);\r\n\r\n    const { transIn } = getValues();\r\n    // 尚未指定常用/約定轉入對象時，自動開啟選擇常用/約定轉入對象的功能。\r\n    let funcId = null;\r\n    const { freqAcct, regAcct } = transIn;\r\n    if (type === 1 && (!freqAcct || !e)) funcId = 'D00500';\r\n    if (type === 2 && (!regAcct || !e)) funcId = 'D00600';\r\n    if (funcId !== null) {\r\n      const selectAccount = (type === 1) ? freqAcct : regAcct; // 指定預設為已選取狀態的帳號\r\n      const params = {\r\n        selectorMode: true, // 隱藏 Home 圖示\r\n        defaultAccount: selectAccount?.accountNo,\r\n        bindAccount: model.transOut.account, // 提供給 D00600 只列出此帳號設定的約轉帳號清單。\r\n      };\r\n      model.transIn = transIn;\r\n      model.selectedAccountIdx = selectedAccountIdx; // 用在返回時將 Swiper 切回目前帳號\r\n\r\n      dispatch(setWaittingVisible(true));\r\n      await startFunc(funcId, params, model);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * 切換交易頻率時，將交易週期設為第一項。\r\n   */\r\n  useEffect(() => {\r\n    const { booking } = getValues();\r\n    // 交易頻率(cycleMode): 1.每周, 2.每月\r\n    // 交易週期(cycleTiming): 〔 0~6: 周日~周六 〕或〔 1~31: 每月1~31 〕\r\n    setValue(idCycleTime, (booking.cycleMode === 1) ? 0 : 1);\r\n  }, [watch(idCycleMode)]);\r\n\r\n  /**\r\n   * 調整輸出金額顯示格式。\r\n   */\r\n  useEffect(() => {\r\n    // 金額加千分號\r\n    const { amount } = getValues();\r\n\r\n    const number = amount ? amount.toString().replace(/[^\\d]/g, '') : ''; // 將所有(g)非數字(^\\d)字元，全部移除。\r\n    const formater = new Intl.NumberFormat('en-US');\r\n    const newValue = formater.format(number);\r\n    if (newValue !== '0') {\r\n      setValue(idAmount, parseInt(number, 10));\r\n      setAmountText(`$${newValue} ${numberToChinese(amount)}`);\r\n    } else {\r\n      setValue(idAmount, '');\r\n      setAmountText(null);\r\n    }\r\n  }, [watch(idAmount)]);\r\n\r\n  /**\r\n   * 轉入帳戶區(常用/約定/社群轉帳)\r\n   */\r\n  const TransInAccountSelector = () => {\r\n    const { freqAcct, regAcct } = getValues(idTransIn);\r\n    return (\r\n      <>\r\n        {/* 1.常用轉帳頁籤 */}\r\n        <FEIBTabPanel value=\"1\">\r\n          <FEIBInputLabel>轉入帳號</FEIBInputLabel>\r\n          <div className=\"memberAccountCardArea\">\r\n            {freqAcct && (\r\n              <MemberAccountCard\r\n                memberId={freqAcct.headshot}\r\n                name={freqAcct.accountName}\r\n                bankName={freqAcct.bankName}\r\n                bankNo={freqAcct.bankId}\r\n                account={freqAcct.accountNo}\r\n                noBorder\r\n              />\r\n            )}\r\n            <div className=\"changeMemberButton\" onClick={() => onTransTypeChanged(null, 1)}>\r\n              <ChangeMemberIcon />\r\n            </div>\r\n          </div>\r\n        </FEIBTabPanel>\r\n\r\n        {/* 2.約定轉帳頁籤 */}\r\n        <FEIBTabPanel value=\"2\">\r\n          <FEIBInputLabel>轉入帳號</FEIBInputLabel>\r\n          <div className=\"memberAccountCardArea\">\r\n            {regAcct && (\r\n              <MemberAccountCard\r\n                memberId={regAcct.headshot}\r\n                name={regAcct.accountName}\r\n                bankName={regAcct.bankName}\r\n                bankNo={regAcct.bankId}\r\n                account={regAcct.accountNo}\r\n                noBorder\r\n              />\r\n            )}\r\n            <div className=\"changeMemberButton\" onClick={() => onTransTypeChanged(null, 2)}>\r\n              <ChangeMemberIcon />\r\n            </div>\r\n          </div>\r\n        </FEIBTabPanel>\r\n\r\n        {/* TODO 3.社群轉帳頁籤 */}\r\n        <FEIBTabPanel value=\"3\">\r\n          <p>社群轉帳</p>\r\n        </FEIBTabPanel>\r\n      </>\r\n    );\r\n  };\r\n\r\n  /**\r\n   * 切換帳戶卡，變更 HookForm 轉出帳號相關資料，以及轉帳額度。\r\n   */\r\n  useEffect(() => {\r\n    const account = accounts?.at(selectedAccountIdx);\r\n    if (!account) return; // 頁面初始化時，不需要進來。\r\n\r\n    model.transOut = {\r\n      account: account.accountNo, // 轉出帳號\r\n      alias: account.alias, // 帳戶名稱，若有暱稱則會優先用暱稱; 會用在確認及執行這二頁。\r\n      balance: account.balance, // 帳戶餘額\r\n    };\r\n\r\n    // 若還沒有取得 免費跨轉次數 則立即補上。\r\n    if (!model.transOut.freeTransfer) {\r\n      // 下載 優存(利率/利息)資訊\r\n      getAccountBonus(account.accountNo, (info) => {\r\n        model.transOut = {\r\n          ...model.transOut,\r\n          freeTransfer: account.freeTransfer = info.freeTransfer,\r\n          freeTransferRemain: account.freeTransferRemain = info.freeTransferRemain,\r\n        };\r\n\r\n        forceUpdate();\r\n      });\r\n    }\r\n\r\n    // 單筆轉帳限額 (用於設置至轉出金額驗證規則)\r\n    // dgType = 帳戶類別('  '.非數存帳號, '11'.臨櫃數存昇級一般, '12'.一之二類, ' 2'.二類, '32'.三之二類)\r\n    let quota = [50000, 100000, 200000]; // 適用：一、二 類\r\n    if (account.dgType === '32') quota = [10000, 30000, 50000];\r\n    // else if (account.dgType === ' 2') quota = [50000, 100000, 200000];\r\n    // else if (['11', '12'].indexOf(account.dgType)) quota = [50000, 100000, 200000];\r\n    setTranferQuota(quota);\r\n  }, [selectedAccountIdx]);\r\n\r\n  /**\r\n   * 單筆轉帳限額 (用於設置至轉出金額驗證規則)\r\n   */\r\n  const showTranferQuota = () => {\r\n    const { transIn } = getValues;\r\n    if (transIn?.type !== '2') {\r\n      const formater = new Intl.NumberFormat('en-US');\r\n      const quota = tranferQuota.map((q) => formater.format(q)).join('/');\r\n      return (<p className=\"notice\">{`單筆/當日/當月非約定轉帳剩餘額度: ${quota}`}</p>);\r\n    }\r\n    return null;\r\n  };\r\n\r\n  /**\r\n   * 輸出頁面\r\n   */\r\n\r\n  return (\r\n    <Layout title=\"台幣轉帳\">\r\n      <TransferWrapper $insufficient={!model?.transOut?.balance || model?.transOut?.balance <= 0}>\r\n        <AccountOverview\r\n          transferMode\r\n          accounts={accounts}\r\n          defaultSlide={selectedAccountIdx}\r\n          onAccountChanged={setSelectedAccountIdx}\r\n        />\r\n\r\n        {/* {model?.transOut.balance <= 0 ? (<p className=\"insufficient\">(帳戶餘額不足)</p>) : null} */}\r\n        <div className=\"transferServicesArea\">\r\n          <form>\r\n            <FEIBTabContext value={String(watch(idTransType))}>\r\n              <FEIBTabList onChange={onTransTypeChanged} $type=\"fixed\" $size=\"small\" className=\"tabList\">\r\n                {/* 0.一般轉帳, 1.常用轉帳, 2.約定轉帳, 3.社群轉帳 */}\r\n                {transTypes.map((name, n) => (\r\n                  // 當 startFuncParams 有預設轉入帳號時，不允許變更。\r\n                  <FEIBTab key={name} label={name} value={String(n)} disabled={((n !== 0 && startFuncParams?.transIn?.account) || n === 3)} />\r\n                ))}\r\n              </FEIBTabList>\r\n\r\n              {/* 轉入帳戶區(一般轉帳) */}\r\n              <FEIBTabPanel value=\"0\">\r\n                {/* 當 startFuncParams 有預設轉入帳號 或 帳戶餘額為零時，不允許變更 */}\r\n                <BankCodeInput control={control} name={idTransInBank} value={getValues(idTransInBank)} setValue={setValue} trigger={trigger}\r\n                  readonly={startFuncParams?.transIn?.bank || !accounts?.at(selectedAccountIdx)?.balance}\r\n                  errorMessage={errors?.transIn?.bank?.message}\r\n                />\r\n                <div>\r\n                  <FEIBInputLabel htmlFor={idTransInAcct}>轉入帳號</FEIBInputLabel>\r\n                  <Controller control={control} name={idTransInAcct}\r\n                    render={({ field }) => (\r\n                      // 當 startFuncParams 有預設轉入帳號時，不允許變更\r\n                      <FEIBInput {...field} placeholder=\"請輸入\" inputMode=\"numeric\" error={!!errors?.transIn?.account}\r\n                        inputProps={{ maxLength: 14, autoComplete: 'off', disabled: startFuncParams?.transIn?.account }}\r\n                      />\r\n                    )}\r\n                  />\r\n                  <FEIBErrorMessage>{errors.transIn?.account?.message}</FEIBErrorMessage>\r\n                </div>\r\n              </FEIBTabPanel>\r\n              {/* 轉入帳戶區(常用/約定/社群) */}\r\n              {TransInAccountSelector()}\r\n            </FEIBTabContext>\r\n\r\n            {/* 轉帳金額 */}\r\n            <div className=\"customSpace\">\r\n              <FEIBInputLabel htmlFor={idAmount}>金額</FEIBInputLabel>\r\n              <Controller control={control} name={idAmount}\r\n                render={({ field }) => (\r\n                  <div>\r\n                    {/* 當 startFuncParams 有預設轉帳金額時，不允許變更 */}\r\n                    <FEIBInput {...field} placeholder=\"$0（零元）\" inputMode=\"numeric\" error={!!errors?.amount}\r\n                      inputProps={{ maxLength: 9, autoComplete: 'off', disabled: startFuncParams?.amount }}\r\n                    />\r\n                    <div className=\"balanceLayout\">{amountText}</div>\r\n                  </div>\r\n                )}\r\n              />\r\n              <FEIBErrorMessage>{errors.amount?.message}</FEIBErrorMessage>\r\n              {showTranferQuota()}\r\n            </div>\r\n\r\n            {/* 轉帳類型(0.立即轉帳, 1.預約轉帳) */}\r\n            <div className=\"transferMode\">\r\n              <FEIBInputLabel>轉帳類型</FEIBInputLabel>\r\n              <Controller control={control} name={idMode}\r\n                render={({ field }) => (\r\n                  <RadioGroup {...field} row aria-label=\"轉帳類型\" name={idMode} onChange={(e) => setValue(idMode, parseInt(e.target.value, 10))}>\r\n                    <FEIBRadioLabel value={0} control={<FEIBRadio />} label=\"立即\" className=\"customWidth\" />\r\n                    <FEIBRadioLabel value={1} control={<FEIBRadio />} label=\"預約\" />\r\n                  </RadioGroup>\r\n                )}\r\n              />\r\n              {(watch(idMode) === 1) ? (\r\n                <div className=\"reserveOption\">\r\n                  <FEIBInputLabel htmlFor={idMultiTimes}>轉帳次數</FEIBInputLabel>\r\n                  <Controller control={control} name={idMultiTimes}\r\n                    render={({ field }) => (\r\n                      <FEIBSelect {...field} name={idMultiTimes}>\r\n                        <FEIBOption value=\"1\">一次</FEIBOption>\r\n                        <FEIBOption value=\"*\">多次</FEIBOption>\r\n                      </FEIBSelect>\r\n                    )}\r\n                  />\r\n                  {watch(idMultiTimes) === '1' ? (\r\n                    <>\r\n                      <FEIBInputLabel className=\"datePickerLabel\">交易時間</FEIBInputLabel>\r\n                      <DatePicker control={control} name={idTransDate} {...datePickerLimit} />\r\n                      <FEIBErrorMessage>{errors.booking?.transDate?.message}</FEIBErrorMessage>\r\n                    </>\r\n                  ) : (\r\n                    <div className=\"dateRangePickerArea\">\r\n                      {/* // BUG 確認頁返回後，未顯示值，但 model 有資料。 */}\r\n                      <DateRangePicker control={control} name={idTransRange} label=\"交易時間\" {...datePickerLimit} />\r\n                      <FEIBErrorMessage>{errors.booking?.transRange?.message}</FEIBErrorMessage>\r\n\r\n                      {/* 設定交易頻率(1.每周, 2.每月)及交易週期 */}\r\n                      <div className=\"reserveMoreOption\">\r\n                        <div>\r\n                          <FEIBInputLabel htmlFor={idCycleMode}>交易頻率</FEIBInputLabel>\r\n                          <Controller control={control} name={idCycleMode}\r\n                            render={({ field }) => (\r\n                              <FEIBSelect {...field} name={idCycleMode}>\r\n                                <FEIBOption value={1}>每週</FEIBOption>\r\n                                <FEIBOption value={2}>每月</FEIBOption>\r\n                              </FEIBSelect>\r\n                            )}\r\n                          />\r\n                          <FEIBErrorMessage>{errors.booking?.cycleMode?.message}</FEIBErrorMessage>\r\n                        </div>\r\n                        <div>\r\n                          <FEIBInputLabel htmlFor={idCycleTime}>交易週期</FEIBInputLabel>\r\n                          <Controller control={control} name={idCycleTime}\r\n                            render={({ field }) => (\r\n                              <FEIBSelect {...field} name={idCycleTime}>\r\n                                {[cycleWeekly, cycleMonthly][getValues(idCycleMode) - 1].map((s, n) => {\r\n                                  // 交易週期: 〔 0~6: 周日~周六 〕或〔 1~28: 每月1~31 〕\r\n                                  const value = n + getValues(idCycleMode) - 1;\r\n                                  return (<FEIBOption key={value} value={value}>{s}</FEIBOption>);\r\n                                })}\r\n                              </FEIBSelect>\r\n                            )}\r\n                          />\r\n                          <FEIBErrorMessage>\r\n                            {/* eslint-disable-next-line react/jsx-one-expression-per-line */}\r\n                            {watch(idCycleTime) >= 29 ? (<>* 可能順延至次月一日<br /></>) : null}\r\n                            {errors.booking?.cycleTiming?.message}\r\n                          </FEIBErrorMessage>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ) : (\r\n                // 為了保持與備註間的間距。\r\n                <p style={{ height: '1.8rem'}} />\r\n              )}\r\n            </div>\r\n\r\n            {/* 備註 */}\r\n            <div>\r\n              <FEIBInputLabel htmlFor={idMemo}>備註</FEIBInputLabel>\r\n              <Controller control={control} name={idMemo}\r\n                render={({ field }) => (\r\n                  <FEIBInput {...field} placeholder=\"請輸入\" inputProps={{ maxLength: 20, autoComplete: 'off' }} />\r\n                )}\r\n              />\r\n              <FEIBErrorMessage />\r\n            </div>\r\n          </form>\r\n\r\n          <Accordion space=\"both\">\r\n            <D00100AccordionContent />\r\n          </Accordion>\r\n          <p className=\"warningText\">陌生電話先求證，轉帳交易須謹慎</p>\r\n          <div className=\"transferButtonArea\">\r\n            <FEIBButton onClick={handleSubmit(onSubmit)}>轉帳</FEIBButton>\r\n          </div>\r\n        </div>\r\n      </TransferWrapper>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default Transfer;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}