{"ast":null,"code":"import _toConsumableArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable no-unused-vars */import{useState,useEffect}from'react';import{useDispatch}from'react-redux';import{setWaittingVisible}from'stores/reducers/ModalReducer';import uuid from'react-uuid';import Main from'components/Layout';import Layout from'components/Layout/Layout';import SwiperLayout from'components/SwiperLayout';import PieChart from'components/PieChart';import{getBalanceInfo}from'./api';import AccountCardList from'./components/AccountCardList';/**\r\n * C00100 帳戶總覽頁\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";var AccountOverviewPage=function AccountOverviewPage(){var dispatch=useDispatch();var _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),accounts=_useState2[0],setAccounts=_useState2[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setWaittingVisible(true));_context.next=3;return getBalanceInfo();case 3:response=_context.sent;setAccounts(response);dispatch(setWaittingVisible(false));case 6:case\"end\":return _context.stop();}}},_callee);})),[]);// 檢查正資產陣列中的type，若缺少type即加一新物件至陣列\nvar addTypeObj=function addTypeObj(arr,type){// 檢查陣列中有無該type\nvar found=arr.some(function(item){return item.type===type;});// 若無符合該type的物件則新增一陣列物件\nif(!found){arr.push({balance:0,purpose:type==='C'?2:0,accountNo:null,alias:'',currency:'TWD',type:type,isEmpty:true});}// 回傳新增後的整個陣列\nreturn arr;};var checkAssets=function checkAssets(checkedArr){return['M','F','S','C'].map(function(type){return addTypeObj(checkedArr,type);}).at(-1);};/**\r\n   * 產生上方圓餅圖的 slides\r\n   * 因為第一階段可能沒有負資產的功能，所以預設空陣列，仰賴後端回傳的資料，再將其加入陣列中。\r\n   * 正資產子帳戶只顯示『存錢計畫』\r\n   * TODO: 空陣列時？\r\n   */var renderSlides=function renderSlides(data){var slides=[];if(data!==null&&data!==void 0&&data.assets&&data.assets.length>0){// 正資產陣列移除子帳戶項目\nvar assetList=data.assets.filter(function(account){return account.type!=='C';});// 子帳戶項目篩選只餘『存錢計畫』\nvar subAccounts=data.assets.filter(function(account){return account.type==='C'&&account.purpose===2;});// 篩選後子項目加回正資產陣列\nif(subAccounts.length>0)assetList.push.apply(assetList,_toConsumableArray(subAccounts));slides.push(/*#__PURE__*/_jsx(PieChart,{label:\"\\u6B63\\u8CC7\\u7522\",data:assetList.sort(function(a,b){return b.balance-a.balance;}),isCentered:true},uuid()));}if(data!==null&&data!==void 0&&data.debts&&data.debts.length>0){slides.push(/*#__PURE__*/_jsx(PieChart,{label:\"\\u8CA0\\u8CC7\\u7522\",data:data.debts.sort(function(a,b){return b.balance-a.balance;}),isCentered:true},uuid()));}return slides;};/**\r\n   * 產生下方帳戶資訊的 slides\r\n   * 處理方式同上\r\n   */var renderContents=function renderContents(data){var slides=[];if(data!==null&&data!==void 0&&data.assets&&data.assets.length>0){var fullArr=checkAssets(data.assets);slides.push(/*#__PURE__*/_jsx(AccountCardList,{data:fullArr,isDebt:false},uuid()));}if(data!==null&&data!==void 0&&data.debts&&data.debts.length>0){slides.push(/*#__PURE__*/_jsx(AccountCardList,{data:data.debts,isDebt:true},uuid()));}return slides;};/**\r\n   * 產生頁面\r\n   * 只要提供相同數量的 slides 和 content，SwiperLayout會自動切換對應的內容。\r\n   */return/*#__PURE__*/_jsx(Layout,{title:\"\\u5E33\\u6236\\u7E3D\\u89BD\",children:/*#__PURE__*/_jsx(Main,{children:/*#__PURE__*/_jsx(SwiperLayout,{slides:renderSlides(accounts),hasDivider:false,children:renderContents(accounts)})})});};export default AccountOverviewPage;","map":{"version":3,"names":["useState","useEffect","useDispatch","setWaittingVisible","uuid","Main","Layout","SwiperLayout","PieChart","getBalanceInfo","AccountCardList","AccountOverviewPage","dispatch","undefined","accounts","setAccounts","response","addTypeObj","arr","type","found","some","item","push","balance","purpose","accountNo","alias","currency","isEmpty","checkAssets","checkedArr","map","at","renderSlides","data","slides","assets","length","assetList","filter","account","subAccounts","sort","a","b","debts","renderContents","fullArr"],"sources":["C:/Users/allen/git/app2-webview/src/pages/C00100_AccountOverview/C00100.jsx"],"sourcesContent":["/* eslint-disable no-unused-vars */\r\nimport { useState, useEffect } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { setWaittingVisible } from 'stores/reducers/ModalReducer';\r\nimport uuid from 'react-uuid';\r\n\r\nimport Main from 'components/Layout';\r\nimport Layout from 'components/Layout/Layout';\r\nimport SwiperLayout from 'components/SwiperLayout';\r\nimport PieChart from 'components/PieChart';\r\n\r\nimport { getBalanceInfo } from './api';\r\nimport AccountCardList from './components/AccountCardList';\r\n\r\n/**\r\n * C00100 帳戶總覽頁\r\n */\r\nconst AccountOverviewPage = () => {\r\n  const dispatch = useDispatch();\r\n  const [accounts, setAccounts] = useState(undefined);\r\n\r\n  useEffect(async () => {\r\n    dispatch(setWaittingVisible(true));\r\n    const response = await getBalanceInfo();\r\n    setAccounts(response);\r\n    dispatch(setWaittingVisible(false));\r\n  }, []);\r\n\r\n  // 檢查正資產陣列中的type，若缺少type即加一新物件至陣列\r\n  const addTypeObj = (arr, type) => {\r\n    // 檢查陣列中有無該type\r\n    const found = arr.some((item) => item.type === type);\r\n\r\n    // 若無符合該type的物件則新增一陣列物件\r\n    if (!found) {\r\n      arr.push({\r\n        balance: 0,\r\n        purpose: type === 'C' ? 2 : 0,\r\n        accountNo: null,\r\n        alias: '',\r\n        currency: 'TWD',\r\n        type,\r\n        isEmpty: true,\r\n      });\r\n    }\r\n\r\n    // 回傳新增後的整個陣列\r\n    return arr;\r\n  };\r\n  const checkAssets = (checkedArr) => ['M', 'F', 'S', 'C'].map((type) => addTypeObj(checkedArr, type)).at(-1);\r\n\r\n  /**\r\n   * 產生上方圓餅圖的 slides\r\n   * 因為第一階段可能沒有負資產的功能，所以預設空陣列，仰賴後端回傳的資料，再將其加入陣列中。\r\n   * 正資產子帳戶只顯示『存錢計畫』\r\n   * TODO: 空陣列時？\r\n   */\r\n  const renderSlides = (data) => {\r\n    const slides = [];\r\n\r\n    if (data?.assets && data.assets.length > 0) {\r\n      // 正資產陣列移除子帳戶項目\r\n      const assetList = data.assets.filter((account) => account.type !== 'C');\r\n      // 子帳戶項目篩選只餘『存錢計畫』\r\n      const subAccounts = data.assets.filter((account) => account.type === 'C' && account.purpose === 2);\r\n      // 篩選後子項目加回正資產陣列\r\n      if (subAccounts.length > 0) assetList.push(...subAccounts);\r\n\r\n      slides.push(<PieChart key={uuid()} label=\"正資產\" data={assetList.sort((a, b) => b.balance - a.balance)} isCentered />);\r\n    }\r\n\r\n    if (data?.debts && data.debts.length > 0) {\r\n      slides.push(<PieChart key={uuid()} label=\"負資產\" data={data.debts.sort((a, b) => b.balance - a.balance)} isCentered />);\r\n    }\r\n\r\n    return slides;\r\n  };\r\n\r\n  /**\r\n   * 產生下方帳戶資訊的 slides\r\n   * 處理方式同上\r\n   */\r\n  const renderContents = (data) => {\r\n    const slides = [];\r\n\r\n    if (data?.assets && data.assets.length > 0) {\r\n      const fullArr = checkAssets(data.assets);\r\n      slides.push(<AccountCardList key={uuid()} data={fullArr} isDebt={false} />);\r\n    }\r\n\r\n    if (data?.debts && data.debts.length > 0) {\r\n      slides.push(<AccountCardList key={uuid()} data={data.debts} isDebt />);\r\n    }\r\n\r\n    return slides;\r\n  };\r\n\r\n  /**\r\n   * 產生頁面\r\n   * 只要提供相同數量的 slides 和 content，SwiperLayout會自動切換對應的內容。\r\n   */\r\n  return (\r\n    <Layout title=\"帳戶總覽\">\r\n      <Main>\r\n        <SwiperLayout slides={renderSlides(accounts)} hasDivider={false}>\r\n          { renderContents(accounts) }\r\n        </SwiperLayout>\r\n      </Main>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default AccountOverviewPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}