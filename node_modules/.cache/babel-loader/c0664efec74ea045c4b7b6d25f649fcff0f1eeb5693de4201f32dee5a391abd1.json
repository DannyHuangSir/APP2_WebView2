{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable no-unused-vars */import{useState,useEffect}from'react';import uuid from'react-uuid';import{ArrowNextIcon}from'assets/images/icons';import{FEIBTabContext,FEIBTabList,FEIBTab}from'components/elements';import Loading from'components/Loading';import InformationTape from'components/InformationTape';import EmptyData from'components/EmptyData';import{currencySymbolGenerator}from'utilities/Generator';import{getThisMonth,getMonthList}from'utilities/MonthGenerator';import{getTransactionDetails}from'../utils';import TransactionsWrapper from'./Transactions.style';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var backlogMap=new Map();var Transactions=function Transactions(_ref){var bills=_ref.bills,isExpanded=_ref.isExpanded,onExpandClick=_ref.onExpandClick,handleChangeMonth=_ref.handleChangeMonth;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),displayList=_useState4[0],setDisplayList=_useState4[1];var _useState5=useState(getThisMonth()),_useState6=_slicedToArray(_useState5,2),selectedMonth=_useState6[0],setSelectedMonth=_useState6[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var log,response,list,i,_log$i$currency;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:log=backlogMap.get(selectedMonth);if(log){_context.next=8;break;}setIsLoading(true);_context.next=5;return getTransactionDetails(selectedMonth);case 5:response=_context.sent;backlogMap.set(selectedMonth,response);log=response;case 8:list=[];for(i=0;i<(!isExpanded&&log.length>3?3:log.length);i++){list.push(/*#__PURE__*/_jsx(InformationTape,{topLeft:log[i].description,topRight:currencySymbolGenerator((_log$i$currency=log[i].currency)!==null&&_log$i$currency!==void 0?_log$i$currency:'TWD',log[i].amount),bottomLeft:log[i].targetAcct?\"\".concat(log[i].txnDate,\" | \\u5361-\").concat(log[i].targetAcct.slice(-4)):\"\".concat(log[i].txnDate)},uuid()));}setDisplayList(list);setIsLoading(false);case 12:case\"end\":return _context.stop();}}},_callee);})),[selectedMonth,isExpanded]);var handleOnTabChange=function handleOnTabChange(_,id){setSelectedMonth(id);handleChangeMonth(id);//\n};return/*#__PURE__*/_jsx(TransactionsWrapper,{children:bills?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FEIBTabContext,{value:selectedMonth,children:/*#__PURE__*/_jsx(FEIBTabList,{$size:\"small\",$type:\"fixed\",onChange:handleOnTabChange,children:getMonthList().map(function(m){return/*#__PURE__*/_jsx(FEIBTab,{label:\"\".concat(m.slice(4,6),\"\\u6708\"),value:m},uuid());})})}),(displayList===null||displayList===void 0?void 0:displayList.length)>0?/*#__PURE__*/_jsxs(_Fragment,{children:[isLoading?/*#__PURE__*/_jsx(Loading,{space:\"both\",isCentered:true}):displayList,!isExpanded&&/*#__PURE__*/_jsx(\"div\",{className:\"toolbar\",children:/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn-icon\",onClick:function onClick(){return onExpandClick();},children:[\"\\u66F4\\u591A\\u660E\\u7D30\",/*#__PURE__*/_jsx(ArrowNextIcon,{})]})})]}):/*#__PURE__*/_jsx(\"div\",{style:{height:'20rem',marginTop:'6rem'},children:/*#__PURE__*/_jsx(EmptyData,{})})]}):/*#__PURE__*/_jsx(Loading,{space:\"both\",isCentered:true})});};export default Transactions;","map":{"version":3,"names":["useState","useEffect","uuid","ArrowNextIcon","FEIBTabContext","FEIBTabList","FEIBTab","Loading","InformationTape","EmptyData","currencySymbolGenerator","getThisMonth","getMonthList","getTransactionDetails","TransactionsWrapper","backlogMap","Map","Transactions","bills","isExpanded","onExpandClick","handleChangeMonth","isLoading","setIsLoading","displayList","setDisplayList","selectedMonth","setSelectedMonth","log","get","response","set","list","i","length","push","description","currency","amount","targetAcct","txnDate","slice","handleOnTabChange","_","id","map","m","height","marginTop"],"sources":["C:/Users/allen/git/app2-webview/src/pages/R00300_CCBill/components/Transactions.jsx"],"sourcesContent":["/* eslint-disable no-unused-vars */\r\nimport { useState, useEffect } from 'react';\r\nimport uuid from 'react-uuid';\r\n\r\nimport { ArrowNextIcon } from 'assets/images/icons';\r\nimport { FEIBTabContext, FEIBTabList, FEIBTab } from 'components/elements';\r\nimport Loading from 'components/Loading';\r\nimport InformationTape from 'components/InformationTape';\r\nimport EmptyData from 'components/EmptyData';\r\nimport { currencySymbolGenerator } from 'utilities/Generator';\r\nimport { getThisMonth, getMonthList } from 'utilities/MonthGenerator';\r\n\r\nimport { getTransactionDetails } from '../utils';\r\nimport TransactionsWrapper from './Transactions.style';\r\n\r\nconst backlogMap = new Map();\r\n\r\nconst Transactions = ({\r\n  bills, isExpanded, onExpandClick, handleChangeMonth,\r\n}) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [displayList, setDisplayList] = useState([]);\r\n  const [selectedMonth, setSelectedMonth] = useState(getThisMonth());\r\n\r\n  useEffect(async () => {\r\n    let log = backlogMap.get(selectedMonth);\r\n    if (!log) {\r\n      setIsLoading(true);\r\n      const response = await getTransactionDetails(selectedMonth);\r\n\r\n      backlogMap.set(selectedMonth, response);\r\n      log = response;\r\n    }\r\n\r\n    const list = [];\r\n    for (let i = 0; i < ((!isExpanded && log.length > 3) ? 3 : log.length); i++) {\r\n      list.push((\r\n        <InformationTape\r\n          key={uuid()}\r\n          topLeft={log[i].description}\r\n          topRight={currencySymbolGenerator(log[i].currency ?? 'TWD', log[i].amount)}\r\n          bottomLeft={(log[i].targetAcct) ? (`${log[i].txnDate} | 卡-${log[i].targetAcct.slice(-4)}`) : `${log[i].txnDate}`}\r\n        />\r\n      ));\r\n    }\r\n    setDisplayList(list);\r\n\r\n    setIsLoading(false);\r\n  }, [selectedMonth, isExpanded]);\r\n\r\n  const handleOnTabChange = (_, id) => {\r\n    setSelectedMonth(id);\r\n    handleChangeMonth(id); //\r\n  };\r\n\r\n  return (\r\n    <TransactionsWrapper>\r\n      { bills ? (\r\n        <>\r\n          <FEIBTabContext value={selectedMonth}>\r\n            <FEIBTabList $size=\"small\" $type=\"fixed\" onChange={handleOnTabChange}>\r\n              { getMonthList().map((m) => <FEIBTab key={uuid()} label={`${m.slice(4, 6)}月`} value={m} />)}\r\n            </FEIBTabList>\r\n          </FEIBTabContext>\r\n          { displayList?.length > 0 ? (\r\n            <>\r\n              { isLoading ? <Loading space=\"both\" isCentered /> : displayList }\r\n\r\n              { !isExpanded && (\r\n              <div className=\"toolbar\">\r\n                <button type=\"button\" className=\"btn-icon\" onClick={() => onExpandClick()}>\r\n                  更多明細\r\n                  <ArrowNextIcon />\r\n                </button>\r\n              </div>\r\n              )}\r\n\r\n            </>\r\n          ) : (\r\n            <div style={{ height: '20rem', marginTop: '6rem' }}>\r\n              <EmptyData />\r\n            </div>\r\n          )}\r\n        </>\r\n      ) : <Loading space=\"both\" isCentered /> }\r\n    </TransactionsWrapper>\r\n  );\r\n};\r\n\r\nexport default Transactions;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}