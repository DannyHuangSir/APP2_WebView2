{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useForm}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup';import{CreateRounded,KeyboardArrowRightRounded}from'@material-ui/icons';/* Elements */import Layout from'components/Layout/Layout';import Avatar from'components/Avatar';import{TextInputField}from'components/Fields';import{showCustomPrompt}from'utilities/MessageModal';import{startFunc}from'utilities/AppScriptProxy';import defaultAvatar from'assets/images/avatarImage.png';/* Styles */import SettingList from'./T00100_settingList';import ProfileWrapper from'./T00100.style';import{validationSchema}from'./validationSchema';import{getNickName,updateNickName,uploadAvatar}from'./api';/**\r\n * T00100 個人化首頁\r\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var T00100=function T00100(){var _useForm=useForm({defaultValues:{nickName:''},resolver:yupResolver(validationSchema)}),handleSubmit=_useForm.handleSubmit,control=_useForm.control,reset=_useForm.reset;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),nickName=_useState2[0],setNickName=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),memberId=_useState4[0],setMemberId=_useState4[1];var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return updateNickName(values);case 2:response=_context.sent;if((response===null||response===void 0?void 0:response.constructor)===String)setNickName(values.nickName);case 4:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var showEditNickNameDialog=function showEditNickNameDialog(){showCustomPrompt({title:'編輯名稱',message:/*#__PURE__*/_jsx(TextInputField,{name:\"nickName\",control:control,placeholder:\"\\u8ACB\\u8F38\\u5165\\u60A8\\u7684\\u540D\\u7A31\",labelName:\"\\u60A8\\u7684\\u540D\\u7A31\"}),okContent:'完成',onOk:handleSubmit(onSubmit),onClose:function onClose(){return reset({nickName:nickName});}});};var renderEntryList=function renderEntryList(){return SettingList.map(function(_ref2){var name=_ref2.name,funcID=_ref2.funcID;return/*#__PURE__*/_jsxs(\"div\",{className:\"entryList\",onClick:function onClick(){return startFunc(funcID);},children:[name,/*#__PURE__*/_jsx(KeyboardArrowRightRounded,{})]},name);});};useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getNickName();case 2:data=_context2.sent;setNickName(data.nickName);reset({nickName:data.nickName});setMemberId(data.uuid);case 6:case\"end\":return _context2.stop();}}},_callee2);})),[]);return/*#__PURE__*/_jsx(Layout,{title:\"\\u500B\\u4EBA\\u5316\\u8A2D\\u5B9A\",children:/*#__PURE__*/_jsxs(ProfileWrapper,{children:[/*#__PURE__*/_jsx(Avatar,{memberId:memberId,name:nickName,onNewPhotoLoaded:uploadAvatar,defaultImage:defaultAvatar}),/*#__PURE__*/_jsxs(\"div\",{className:\"nickName\",children:[/*#__PURE__*/_jsx(\"span\",{children:nickName}),/*#__PURE__*/_jsx(CreateRounded,{onClick:showEditNickNameDialog})]}),renderEntryList()]})});};export default T00100;","map":{"version":3,"names":["useState","useEffect","useForm","yupResolver","CreateRounded","KeyboardArrowRightRounded","Layout","Avatar","TextInputField","showCustomPrompt","startFunc","defaultAvatar","SettingList","ProfileWrapper","validationSchema","getNickName","updateNickName","uploadAvatar","T00100","defaultValues","nickName","resolver","handleSubmit","control","reset","setNickName","memberId","setMemberId","onSubmit","values","response","constructor","String","showEditNickNameDialog","title","message","okContent","onOk","onClose","renderEntryList","map","name","funcID","data","uuid"],"sources":["C:/Users/allen/git/app2-webview/src/pages/T00100_Profile/T00100.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport { CreateRounded, KeyboardArrowRightRounded } from '@material-ui/icons';\r\n\r\n/* Elements */\r\nimport Layout from 'components/Layout/Layout';\r\nimport Avatar from 'components/Avatar';\r\nimport { TextInputField } from 'components/Fields';\r\nimport { showCustomPrompt } from 'utilities/MessageModal';\r\nimport { startFunc } from 'utilities/AppScriptProxy';\r\nimport defaultAvatar from 'assets/images/avatarImage.png';\r\n\r\n/* Styles */\r\nimport SettingList from './T00100_settingList';\r\nimport ProfileWrapper from './T00100.style';\r\nimport { validationSchema } from './validationSchema';\r\nimport { getNickName, updateNickName, uploadAvatar } from './api';\r\n\r\n/**\r\n * T00100 個人化首頁\r\n */\r\nconst T00100 = () => {\r\n  const {\r\n    handleSubmit,\r\n    control,\r\n    reset,\r\n  } = useForm({\r\n    defaultValues: {nickName: ''},\r\n    resolver: yupResolver(validationSchema),\r\n  });\r\n\r\n  const [nickName, setNickName] = useState('');\r\n  const [memberId, setMemberId] = useState();\r\n\r\n  const onSubmit = async (values) => {\r\n    const response = await updateNickName(values);\r\n    if (response?.constructor === String) setNickName(values.nickName);\r\n  };\r\n\r\n  const showEditNickNameDialog = () => {\r\n    showCustomPrompt({\r\n      title: '編輯名稱',\r\n      message: (\r\n        <TextInputField\r\n          name=\"nickName\"\r\n          control={control}\r\n          placeholder=\"請輸入您的名稱\"\r\n          labelName=\"您的名稱\"\r\n        />\r\n      ),\r\n      okContent: '完成',\r\n      onOk: handleSubmit(onSubmit),\r\n      onClose: () => reset({ nickName }),\r\n    });\r\n  };\r\n\r\n  const renderEntryList = () => SettingList.map(({ name, funcID }) => (\r\n    <div className=\"entryList\" key={name} onClick={() => startFunc(funcID)}>\r\n      {name}\r\n      <KeyboardArrowRightRounded />\r\n    </div>\r\n  ));\r\n\r\n  useEffect(async () => {\r\n    const data = await getNickName();\r\n    setNickName(data.nickName);\r\n    reset({nickName: data.nickName});\r\n    setMemberId(data.uuid);\r\n  }, []);\r\n\r\n  return (\r\n    <Layout title=\"個人化設定\">\r\n      <ProfileWrapper>\r\n        <Avatar memberId={memberId} name={nickName} onNewPhotoLoaded={uploadAvatar} defaultImage={defaultAvatar} />\r\n        <div className=\"nickName\">\r\n          <span>{nickName}</span>\r\n          <CreateRounded onClick={showEditNickNameDialog} />\r\n        </div>\r\n        {renderEntryList()}\r\n      </ProfileWrapper>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default T00100;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}