{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/allen/git/app2-webview/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import uuid from'react-uuid';import{CalendarIcon}from'assets/images/icons';import{FEIBIconButton}from'components/elements';import{showCustomPrompt}from'utilities/MessageModal';import ReminderWrapper from'./Reminder.style';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Reminder=function Reminder(_ref){var bills=_ref.bills,deductInfo=_ref.deductInfo;var handleHintText=function handleHintText(text){if(text.match('提')){var textChanged=text.split('提');return[textChanged[0],\"\\u63D0\".concat(textChanged[1])];}return[text];};var downloadICS=function downloadICS(){var context=['BEGIN:VCALENDAR','PRODID:-//FEIB//Bankee credit card reminder//TW','VERSION:2.0','BEGIN:VEVENT',\"UID:\".concat(uuid()),\"DTSTAMP:\".concat(new Date().toISOString().replaceAll('-','').replaceAll(':','').split('.')[0],\"Z\"),\"DTSTART;VALUE=DATE:\".concat(parseInt(bills.payDueDate.replaceAll('/',''),10)+19110000),'RRULE:FREQ=MONTHLY','SUMMARY:Bankee信用卡繳款截止日','END:VEVENT','END:VCALENDAR'].join('\\r\\n');var blob=new Blob([context],{type:'text/calendar;charset=utf-8'});var reader=new FileReader();reader.onload=function(){window.open(reader.result,'_blank');};reader.readAsDataUrl(blob);// const link = document.createElement('a');\n// link.href = URL.createObjectURL(blob);\n// link.download = '提醒繳款.ics';\n// link.setAttribute('download', '提醒繳款.ics');\n// link.target = '_blank';\n// document.body.appendChild(link);\n// link.click();\n// document.body.removeChild(link);\n// URL.revokeObjectURL(file);\n};var handleCalendarClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return showCustomPrompt({title:'系統訊息',message:'將帳單繳款提示加入手機行事曆？',okContent:'確認',onOk:function onOk(){return downloadICS();}});case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleCalendarClick(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(ReminderWrapper,{children:deductInfo&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"auto\",children:handleHintText(deductInfo.hintToPay).map(function(text){return/*#__PURE__*/_jsx(\"p\",{children:text},text);})}),/*#__PURE__*/_jsx(FEIBIconButton,{$fontSize:2,className:\"badIcon\",onClick:handleCalendarClick,children:/*#__PURE__*/_jsx(CalendarIcon,{})})]})});};export default Reminder;","map":{"version":3,"names":["uuid","CalendarIcon","FEIBIconButton","showCustomPrompt","ReminderWrapper","Reminder","bills","deductInfo","handleHintText","text","match","textChanged","split","downloadICS","context","Date","toISOString","replaceAll","parseInt","payDueDate","join","blob","Blob","type","reader","FileReader","onload","window","open","result","readAsDataUrl","handleCalendarClick","title","message","okContent","onOk","hintToPay","map"],"sources":["C:/Users/allen/git/app2-webview/src/pages/R00300_CCBill/components/Reminder.jsx"],"sourcesContent":["import uuid from 'react-uuid';\r\nimport { CalendarIcon } from 'assets/images/icons';\r\nimport { FEIBIconButton } from 'components/elements';\r\nimport { showCustomPrompt } from 'utilities/MessageModal';\r\nimport ReminderWrapper from './Reminder.style';\r\n\r\nconst Reminder = ({ bills, deductInfo }) => {\r\n  const handleHintText = (text) => {\r\n    if (text.match('提')) {\r\n      const textChanged = text.split('提');\r\n      return [textChanged[0], `提${textChanged[1]}`];\r\n    }\r\n    return [text];\r\n  };\r\n\r\n  const downloadICS = () => {\r\n    const context = [\r\n      'BEGIN:VCALENDAR',\r\n      'PRODID:-//FEIB//Bankee credit card reminder//TW',\r\n      'VERSION:2.0',\r\n      'BEGIN:VEVENT',\r\n      `UID:${uuid()}`,\r\n      `DTSTAMP:${new Date().toISOString().replaceAll('-', '').replaceAll(':', '')\r\n        .split('.')[0]}Z`,\r\n      `DTSTART;VALUE=DATE:${parseInt(bills.payDueDate.replaceAll('/', ''), 10) + 19110000}`,\r\n      'RRULE:FREQ=MONTHLY',\r\n      'SUMMARY:Bankee信用卡繳款截止日',\r\n      'END:VEVENT',\r\n      'END:VCALENDAR',\r\n    ].join('\\r\\n');\r\n    const blob = new Blob([context], { type: 'text/calendar;charset=utf-8' });\r\n    const reader = new FileReader();\r\n\r\n    reader.onload = () => {\r\n      window.open(reader.result, '_blank');\r\n    };\r\n    reader.readAsDataUrl(blob);\r\n\r\n    // const link = document.createElement('a');\r\n    // link.href = URL.createObjectURL(blob);\r\n    // link.download = '提醒繳款.ics';\r\n    // link.setAttribute('download', '提醒繳款.ics');\r\n    // link.target = '_blank';\r\n    // document.body.appendChild(link);\r\n    // link.click();\r\n    // document.body.removeChild(link);\r\n\r\n    // URL.revokeObjectURL(file);\r\n  };\r\n\r\n  const handleCalendarClick = async () => {\r\n    await showCustomPrompt({\r\n      title: '系統訊息', message: '將帳單繳款提示加入手機行事曆？', okContent: '確認', onOk: () => downloadICS(),\r\n    });\r\n  };\r\n\r\n  return (\r\n    <ReminderWrapper>\r\n      { deductInfo && (\r\n      <>\r\n        <div className=\"auto\">{handleHintText(deductInfo.hintToPay).map((text) => (<p key={text}>{text}</p>))}</div>\r\n        <FEIBIconButton $fontSize={2} className=\"badIcon\" onClick={handleCalendarClick}>\r\n          <CalendarIcon />\r\n        </FEIBIconButton>\r\n      </>\r\n      )}\r\n    </ReminderWrapper>\r\n  );\r\n};\r\n\r\nexport default Reminder;\r\n"],"mappings":"0PAAA,MAAOA,KAAI,KAAM,YAAY,CAC7B,OAASC,YAAY,KAAQ,qBAAqB,CAClD,OAASC,cAAc,KAAQ,qBAAqB,CACpD,OAASC,gBAAgB,KAAQ,wBAAwB,CACzD,MAAOC,gBAAe,KAAM,kBAAkB,CAAC,6IAE/C,GAAMC,SAAQ,CAAG,QAAXA,SAAQ,MAA8B,IAAxBC,MAAK,MAALA,KAAK,CAAEC,UAAU,MAAVA,UAAU,CACnC,GAAMC,eAAc,CAAG,QAAjBA,eAAc,CAAIC,IAAI,CAAK,CAC/B,GAAIA,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAAE,CACnB,GAAMC,YAAW,CAAGF,IAAI,CAACG,KAAK,CAAC,GAAG,CAAC,CACnC,MAAO,CAACD,WAAW,CAAC,CAAC,CAAC,iBAAMA,WAAW,CAAC,CAAC,CAAC,EAAG,CAC/C,CACA,MAAO,CAACF,IAAI,CAAC,CACf,CAAC,CAED,GAAMI,YAAW,CAAG,QAAdA,YAAW,EAAS,CACxB,GAAMC,QAAO,CAAG,CACd,iBAAiB,CACjB,iDAAiD,CACjD,aAAa,CACb,cAAc,eACPd,IAAI,EAAE,oBACF,GAAIe,KAAI,EAAE,CAACC,WAAW,EAAE,CAACC,UAAU,CAAC,GAAG,CAAE,EAAE,CAAC,CAACA,UAAU,CAAC,GAAG,CAAE,EAAE,CAAC,CACxEL,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,mCACMM,QAAQ,CAACZ,KAAK,CAACa,UAAU,CAACF,UAAU,CAAC,GAAG,CAAE,EAAE,CAAC,CAAE,EAAE,CAAC,CAAG,QAAQ,EACnF,oBAAoB,CACpB,wBAAwB,CACxB,YAAY,CACZ,eAAe,CAChB,CAACG,IAAI,CAAC,MAAM,CAAC,CACd,GAAMC,KAAI,CAAG,GAAIC,KAAI,CAAC,CAACR,OAAO,CAAC,CAAE,CAAES,IAAI,CAAE,6BAA8B,CAAC,CAAC,CACzE,GAAMC,OAAM,CAAG,GAAIC,WAAU,EAAE,CAE/BD,MAAM,CAACE,MAAM,CAAG,UAAM,CACpBC,MAAM,CAACC,IAAI,CAACJ,MAAM,CAACK,MAAM,CAAE,QAAQ,CAAC,CACtC,CAAC,CACDL,MAAM,CAACM,aAAa,CAACT,IAAI,CAAC,CAE1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACF,CAAC,CAED,GAAMU,oBAAmB,6FAAG,2JACpB5B,iBAAgB,CAAC,CACrB6B,KAAK,CAAE,MAAM,CAAEC,OAAO,CAAE,iBAAiB,CAAEC,SAAS,CAAE,IAAI,CAAEC,IAAI,CAAE,sBAAMtB,YAAW,EAAE,EACvF,CAAC,CAAC,uDACH,kBAJKkB,oBAAmB,2CAIxB,CAED,mBACE,KAAC,eAAe,WACZxB,UAAU,eACZ,wCACE,YAAK,SAAS,CAAC,MAAM,UAAEC,cAAc,CAACD,UAAU,CAAC6B,SAAS,CAAC,CAACC,GAAG,CAAC,SAAC5B,IAAI,qBAAM,mBAAeA,IAAI,EAAXA,IAAI,CAAY,EAAC,CAAC,EAAO,cAC5G,KAAC,cAAc,EAAC,SAAS,CAAE,CAAE,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAEsB,mBAAoB,uBAC7E,KAAC,YAAY,IAAG,EACD,GAElB,EACe,CAEtB,CAAC,CAED,cAAe1B,SAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}